(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{28171:(e,t,a)=>{"use strict";a.d(t,{oR:()=>c}),a(12115);let n=0,s=new Map,l=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),i({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},r=[],o={toasts:[]};function i(e){o=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(o,e),r.forEach(e=>{e(o)})}function c(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>i({type:"DISMISS_TOAST",toastId:a});return i({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>i({type:"UPDATE_TOAST",toast:{...e,id:a}})}}},41290:()=>{},78217:(e,t,a)=>{"use strict";a.d(t,{default:()=>w});var n=a(95155),s=a(12115),l=a(20063);let r=e=>{let t,{timeoutInMinutes:a=120}=e;(0,l.useRouter)();let n=(0,s.useCallback)(()=>{window.location.href="/"},[]),r=(0,s.useCallback)(()=>{clearTimeout(t),t=setTimeout(n,60*a*1e3)},[n,a]);return(0,s.useEffect)(()=>{let e=["mousemove","keydown","click","scroll"],a=()=>r();return e.forEach(e=>window.addEventListener(e,a)),r(),()=>{clearTimeout(t),e.forEach(e=>window.removeEventListener(e,a))}},[r]),null};var o=a(28171);function i(){let[e,t]=(0,s.useState)(!0),[a,l]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=()=>{t(!0),a&&(0,o.oR)({title:"You are back online!",description:"All features are now available.",variant:"default"})},n=()=>{t(!1),a&&(0,o.oR)({title:"You are currently offline.",description:"Some features may not be available.",variant:"destructive"})};return window.addEventListener("online",e),window.addEventListener("offline",n),void 0!==navigator.onLine&&t(navigator.onLine),l(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[a]),e)?null:(0,n.jsx)("div",{className:"bg-yellow-500 text-white text-center p-2",children:"You are currently offline. Some features may not be available."})}function c(e){let{children:t}=e,[l,r]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e;return(async()=>{if(window.__TAURI__){let{listen:t}=await a.e(3380).then(a.bind(a,13380)),n=t("server-error",e=>{r(e.payload)});e=await n}})(),()=>{null==e||e()}},[]),l)?(0,n.jsxs)("div",{style:{color:"red",display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:["Error: ",l]}):(0,n.jsx)(n.Fragment,{children:t})}var d=a(2950),u=a(58029),f=a(66638);function h(){let e=(0,s.useRef)(null),[t,a]=(0,s.useState)(!1),[l,r]=(0,s.useState)(!1),[o,i]=(0,s.useState)(0),[c,h]=(0,s.useState)(null);async function m(){if(t&&e.current)try{await (0,u.kA)("A new version ".concat(null==c?void 0:c.version," is available!\n\nRelease notes:\n").concat(null==c?void 0:c.notes,"\n\nWould you like to install it now? (App will restart after update)"),{title:"Update Available!",kind:"info",okLabel:"Install Update",cancelLabel:"Later"})&&!l?await x():a(!1)}catch(e){console.error("Prompt failed:",e)}}async function x(){if(e.current)try{r(!0),i(0),await e.current.downloadAndInstall(e=>{switch(e.event){case"Started":console.log("Download started"),i(0);break;case"Progress":let t=e.data;if(t.contentLength){let e=Math.round(t.chunkLength/t.contentLength*100);i(e),console.log("Download progress: ".concat(e,"%"))}break;case"Finished":console.log("Download finished, installing..."),i(100)}}),await (0,u.iU)("Update installed successfully! The app will now restart.",{title:"Update Complete",kind:"info",okLabel:"Restart Now"}),await new Promise(e=>setTimeout(e,500)),await (0,f.b)()}catch(e){console.error("Update installation failed:",e),await (0,u.iU)("Update download failed. Please try again later.",{kind:"error",title:"Update Failed"}),r(!1),i(0)}}return((0,s.useEffect)(()=>{(async()=>{if("__TAURI__"in window)try{let t=await (0,d.z)();if(!t||!t.available)return void console.log("No updates available.");e.current=t,a(!0),h({version:t.version,notes:t.body||"No release notes available."}),m()}catch(e){console.error("Failed to check for updates:",e)}else console.log("Not running in Tauri environment, skipping update check")})()},[]),l)?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Downloading Update..."}),(0,n.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-4",children:(0,n.jsx)("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:"".concat(o,"%")}})}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o,"% complete"]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2",children:"Please don't close the application"})]})})}):t&&c?(0,n.jsx)("div",{className:"fixed bottom-4 right-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 rounded-lg shadow-2xl max-w-sm z-50 animate-slide-in",children:(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-6 h-6 text-yellow-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,n.jsx)("p",{className:"font-semibold text-lg",children:"Update Available!"})]}),(0,n.jsx)("button",{onClick:()=>a(!1),className:"text-white hover:text-gray-200 transition-colors","aria-label":"Close",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm font-medium",children:["Version ",c.version]}),(0,n.jsx)("p",{className:"text-xs text-blue-100 mt-1 line-clamp-2",children:c.notes})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:x,disabled:l,className:"bg-white text-blue-600 px-4 py-2 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed flex-1 font-medium transition-colors text-sm",children:"Install Now"}),(0,n.jsx)("button",{onClick:()=>a(!1),className:"bg-transparent border border-white px-4 py-2 rounded-md hover:bg-blue-800 transition-colors text-sm font-medium",children:"Later"})]})]})}):null}let m={rE:"0.1.55"};var x=a(68267);function w(e){let{children:t}=e;return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://127.0.0.1:8080","/api/sync/status"));if(e.ok){let t=await e.json();console.log("Heartbeat successful:",t)}else console.error("Heartbeat failed: ".concat(e.status," ").concat(e.statusText))}catch(e){console.error("Error sending heartbeat:",e)}},t=async()=>{if("__TAURI__"in window)try{let e=await (0,x.lA)("ensure_backend_running");console.log("Backend check:",e)}catch(e){console.error("Failed to ensure backend is running:",e)}};e(),t();let a=setInterval(e,5e3);return()=>clearInterval(a)},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h,{}),(0,n.jsx)(i,{}),(0,n.jsx)(r,{}),(0,n.jsx)(c,{children:t}),(0,n.jsxs)("div",{className:"fixed bottom-2 left-2 text-xs text-gray-400 pointer-events-none z-50",children:["v",m.rE]})]})}},90385:(e,t,a)=>{Promise.resolve().then(a.bind(a,78217)),Promise.resolve().then(a.t.bind(a,95003,23)),Promise.resolve().then(a.t.bind(a,41290,23))}},e=>{e.O(0,[8761,2360,8441,1255,7358],()=>e(e.s=90385)),_N_E=e.O()}]);