(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{4122:(e,t,n)=>{Promise.resolve().then(n.bind(n,35191)),Promise.resolve().then(n.t.bind(n,95003,23)),Promise.resolve().then(n.t.bind(n,41290,23))},20063:(e,t,n)=>{"use strict";var a=n(47260);n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}})},35191:(e,t,n)=>{"use strict";n.d(t,{default:()=>b});var a=n(95155),s=n(12115),r=n(20063);let i=e=>{let t,{timeoutInMinutes:n=120}=e;(0,r.useRouter)();let a=(0,s.useCallback)(()=>{window.location.href="/"},[]),i=(0,s.useCallback)(()=>{clearTimeout(t),t=setTimeout(a,60*n*1e3)},[a,n]);return(0,s.useEffect)(()=>{let e=["mousemove","keydown","click","scroll"],n=()=>i();return e.forEach(e=>window.addEventListener(e,n)),i(),()=>{clearTimeout(t),e.forEach(e=>window.removeEventListener(e,n))}},[i]),null};function l(){let[e,t]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{let e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e),window.addEventListener("offline",n),void 0!==navigator.onLine&&t(navigator.onLine),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[]),e)?null:(0,a.jsx)("div",{className:"bg-yellow-500 text-white text-center p-2",children:"You are currently offline. Some features may not be available."})}function o(e){let{children:t}=e,[r,i]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e;return(async()=>{if(window.__TAURI__){let{listen:t}=await n.e(380).then(n.bind(n,13380)),a=t("server-error",e=>{i(e.payload)});e=await a}})(),()=>{null==e||e()}},[]),r)?(0,a.jsxs)("div",{style:{color:"red",display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:["Error: ",r]}):(0,a.jsx)(a.Fragment,{children:t})}var d=n(68267);class c extends d.FW{constructor(e){super(e.rid),this.available=!0,this.currentVersion=e.currentVersion,this.version=e.version,this.date=e.date,this.body=e.body,this.rawJson=e.rawJson}async download(e,t){h(t);let n=new d.c3;e&&(n.onmessage=e);let a=await (0,d.lA)("plugin:updater|download",{onEvent:n,rid:this.rid,...t});this.downloadedBytes=new d.FW(a)}async install(){if(!this.downloadedBytes)throw Error("Update.install called before Update.download");await (0,d.lA)("plugin:updater|install",{updateRid:this.rid,bytesRid:this.downloadedBytes.rid}),this.downloadedBytes=void 0}async downloadAndInstall(e,t){h(t);let n=new d.c3;e&&(n.onmessage=e),await (0,d.lA)("plugin:updater|download_and_install",{onEvent:n,rid:this.rid,...t})}async close(){await this.downloadedBytes?.close(),await super.close()}}async function u(e){h(e);let t=await (0,d.lA)("plugin:updater|check",{...e});return t?new c(t):null}function h(e){e?.headers&&(e.headers=Array.from(new Headers(e.headers).entries()))}async function f(e,t){let n="string"==typeof t?{title:t}:t;return(0,d.lA)("plugin:dialog|message",{message:e.toString(),title:n?.title?.toString(),kind:n?.kind,okButtonLabel:n?.okLabel?.toString(),buttons:function(e){if(void 0!==e){if("string"==typeof e)return e;else if("ok"in e&&"cancel"in e)return{OkCancelCustom:[e.ok,e.cancel]};else if("yes"in e&&"no"in e&&"cancel"in e)return{YesNoCancelCustom:[e.yes,e.no,e.cancel]};else if("ok"in e)return{OkCustom:e.ok}}}(n?.buttons)})}async function w(e,t){let n="string"==typeof t?{title:t}:t;return await (0,d.lA)("plugin:dialog|ask",{message:e.toString(),title:n?.title?.toString(),kind:n?.kind,yesButtonLabel:n?.okLabel?.toString(),noButtonLabel:n?.cancelLabel?.toString()})}async function m(){await (0,d.lA)("plugin:process|restart")}function p(){let e=(0,s.useRef)(null),[t,n]=(0,s.useState)(!1),[r,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(0),[d,c]=(0,s.useState)(null);async function h(){try{let t=await u();if(!t||!t.available)return void console.log("No updates available.");e.current=t,n(!0),c({version:t.version,notes:t.body||"No release notes available."}),p()}catch(e){console.error("Failed to check for updates:",e)}}async function p(){if(t&&e.current)try{await w("A new version ".concat(null==d?void 0:d.version," is available!\n\nRelease notes:\n").concat(null==d?void 0:d.notes,"\n\nWould you like to install it now? (App will restart after update)"),{title:"Update Available!",kind:"info",okLabel:"Install Update",cancelLabel:"Later"})&&!r?await g():n(!1)}catch(e){console.error("Prompt failed:",e)}}async function g(){if(e.current)try{i(!0),o(0),await e.current.downloadAndInstall(e=>{switch(e.event){case"Started":console.log("Download started"),o(0);break;case"Progress":let t=e.data;if(t.contentLength){let e=Math.round(t.chunkLength/t.contentLength*100);o(e),console.log("Download progress: ".concat(e,"%"))}break;case"Finished":console.log("Download finished, installing..."),o(100)}}),await f("Update installed successfully! The app will now restart.",{title:"Update Complete",kind:"info",okLabel:"Restart Now"}),await m()}catch(e){console.error("Update installation failed:",e),await f("Update download failed. Please try again later.",{kind:"error",title:"Update Failed"}),i(!1),o(0)}}return((0,s.useEffect)(()=>{h()},[]),r)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Downloading Update..."}),(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-4",children:(0,a.jsx)("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:"".concat(l,"%")}})}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l,"% complete"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2",children:"Please don't close the application"})]})})}):t&&d?(0,a.jsx)("div",{className:"fixed bottom-4 right-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 rounded-lg shadow-2xl max-w-sm z-50 animate-slide-in",children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,a.jsx)("p",{className:"font-semibold text-lg",children:"Update Available!"})]}),(0,a.jsx)("button",{onClick:()=>n(!1),className:"text-white hover:text-gray-200 transition-colors","aria-label":"Close",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Version ",d.version]}),(0,a.jsx)("p",{className:"text-xs text-blue-100 mt-1 line-clamp-2",children:d.notes})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:g,disabled:r,className:"bg-white text-blue-600 px-4 py-2 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed flex-1 font-medium transition-colors text-sm",children:"Install Now"}),(0,a.jsx)("button",{onClick:()=>n(!1),className:"bg-transparent border border-white px-4 py-2 rounded-md hover:bg-blue-800 transition-colors text-sm font-medium",children:"Later"})]})]})}):null}let g={rE:"0.1.41"};function b(e){let{children:t}=e;return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://127.0.0.1:8080","/api/sync/status"));if(e.ok){let t=await e.json();console.log("Heartbeat successful:",t)}else console.error("Heartbeat failed: ".concat(e.status," ").concat(e.statusText))}catch(e){console.error("Error sending heartbeat:",e)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{}),(0,a.jsx)(l,{}),(0,a.jsx)(i,{}),(0,a.jsx)(o,{children:t}),(0,a.jsxs)("div",{className:"fixed bottom-2 left-2 text-xs text-gray-400 pointer-events-none z-50",children:["v",g.rE]})]})}},41290:()=>{},68267:(e,t,n)=>{"use strict";var a,s,r,i,l;function o(e,t,n,a){if("a"===n&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)}function d(e,t,n,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,n):s?s.value=n:t.set(e,n),n}n.d(t,{c3:()=>h,FW:()=>w,lA:()=>f,yw:()=>u}),"function"==typeof SuppressedError&&SuppressedError;let c="__TAURI_TO_IPC_KEY__";function u(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}class h{constructor(e){a.set(this,void 0),s.set(this,0),r.set(this,[]),i.set(this,void 0),d(this,a,e||(()=>{}),"f"),this.id=u(e=>{let t=e.index;if("end"in e)return void(t==o(this,s,"f")?this.cleanupCallback():d(this,i,t,"f"));let n=e.message;if(t==o(this,s,"f")){for(o(this,a,"f").call(this,n),d(this,s,o(this,s,"f")+1,"f");o(this,s,"f")in o(this,r,"f");){let e=o(this,r,"f")[o(this,s,"f")];o(this,a,"f").call(this,e),delete o(this,r,"f")[o(this,s,"f")],d(this,s,o(this,s,"f")+1,"f")}o(this,s,"f")===o(this,i,"f")&&this.cleanupCallback()}else o(this,r,"f")[t]=n})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){d(this,a,e,"f")}get onmessage(){return o(this,a,"f")}[(a=new WeakMap,s=new WeakMap,r=new WeakMap,i=new WeakMap,c)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[c]()}}async function f(e,t={},n){return window.__TAURI_INTERNALS__.invoke(e,t,n)}class w{get rid(){return o(this,l,"f")}constructor(e){l.set(this,void 0),d(this,l,e,"f")}async close(){return f("plugin:resources|close",{rid:this.rid})}}l=new WeakMap},95003:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_f367f3"}}},e=>{e.O(0,[761,441,255,358],()=>e(e.s=4122)),_N_E=e.O()}]);