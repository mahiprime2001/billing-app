(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[754],{47507:(e,t,s)=>{"use strict";s.d(t,{bq:()=>x,eb:()=>p,gC:()=>j,l6:()=>c,yv:()=>u});var a=s(95155),l=s(12115),r=s(47887),n=s(24033),d=s(12108),i=s(5917),o=s(25016);let c=r.bL;r.YJ;let u=r.WT,x=l.forwardRef((e,t)=>{let{className:s,children:l,...d}=e;return(0,a.jsxs)(r.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...d,children:[l,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=r.l9.displayName;let m=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});m.displayName=r.PP.displayName;let h=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let j=l.forwardRef((e,t)=>{let{className:s,children:l,position:n="popper",...d}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...d,children:[(0,a.jsx)(m,{}),(0,a.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,a.jsx)(h,{})]})})});j.displayName=r.UC.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})}).displayName=r.JU.displayName;let p=l.forwardRef((e,t)=>{let{className:s,children:l,...n}=e;return(0,a.jsxs)(r.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsx)(r.p4,{children:l})]})});p.displayName=r.q7.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=r.wv.displayName},63290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Q});var a=s(95155),l=s(12115),r=s(20063),n=s(10832),d=s(83209),i=s(67812),o=s(97003),c=s(90235),u=s(47507),x=s(96633),m=s(90923),h=s(26991),j=s(80019),p=s(68425),f=s(47734),y=s(73697),g=s(10232),v=s(57095),N=s(12723),b=s(4035),w=s(69386),S=s(73850),A=s(94621),R=s(98128),T=s(58155),D=s(89559),F=s(39867),B=s(52056),P=s(63581),_=s(91761),k=s(1524),I=s(26921),Z=s(10512),M=s(26617),C=s(91169),E=s(55136),W=s(81577),L=s(78674),V=s(88901),G=s(71163),K=s(79956),q=s(53317),O=s(99152);let U=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF7C7C"];function Q(){var e,t,Q,z,H,J,X,Y,$,ee,et,es,ea,el;let er=(0,r.useRouter)(),[en,ed]=(0,l.useState)([]),[ei,eo]=(0,l.useState)([]),[ec,eu]=(0,l.useState)([]),[ex,em]=(0,l.useState)([]),[eh,ej]=(0,l.useState)([]),[ep,ef]=(0,l.useState)([]),[ey,eg]=(0,l.useState)([]),[ev,eN]=(0,l.useState)([]),[eb,ew]=(0,l.useState)(null),[eS,eA]=(0,l.useState)(null),[eR,eT]=(0,l.useState)(null),[eD,eF]=(0,l.useState)([]),[eB,eP]=(0,l.useState)([]),[e_,ek]=(0,l.useState)(null),[eI,eZ]=(0,l.useState)([]),[eM,eC]=(0,l.useState)([]),[eE,eW]=(0,l.useState)([]),[eL,eV]=(0,l.useState)(!0),[eG,eK]=(0,l.useState)(!1),[eq,eO]=(0,l.useState)("all"),[eU,eQ]=(0,l.useState)("all"),[ez,eH]=(0,l.useState)("30"),[eJ,eX]=(0,l.useState)("daily"),[eY,e$]=(0,l.useState)({from:(0,L.w)(new Date),to:(0,V.p)(new Date)}),e0="http://127.0.0.1:8080",e1=async()=>{await fetch("/api/sync/pull",{method:"POST"});let e=await fetch("/api/analytics/users/online?windowMinutes=5").then(e=>e.json()),t=new Date().toISOString().slice(0,10),s=await fetch("/api/analytics/users/sessions?from=".concat(t,"&to=").concat(t)).then(e=>e.json());ew(e),eA(s),eV(!0);try{console.log("Fetching data from API endpoints...");let[e,t,s,a]=await Promise.all([fetch("/api/bills"),fetch("/api/stores"),fetch("/api/products"),fetch("/api/users")]);if(!e.ok)throw Error("Failed to fetch bills");if(!t.ok)throw Error("Failed to fetch stores");if(!s.ok)throw Error("Failed to fetch products");if(!a.ok)throw Error("Failed to fetch users");let[l,r,n,d]=await Promise.all([e.json(),t.json(),s.json(),a.json()]);console.log("Fetched data:",{bills:l.length,stores:r.length,products:n.length,users:d.length}),ed(l),eo(r),eu(n),em(d),await e2(ez,eJ)}catch(e){console.error("Error loading data:",e),alert("Failed to load analytics data. Please try again.")}finally{eV(!1)}},e2=async(e,t)=>{try{let[s,a,l,r,n,d,i]=await Promise.all([fetch("".concat(e0,"/api/analytics/dashboard?days=").concat(e)),fetch("".concat(e0,"/api/analytics/revenue/trends?period=").concat(t,"&days=").concat(e)),fetch("".concat(e0,"/api/analytics/products/top?limit=10&days=").concat(e,"&sortBy=revenue")),fetch("".concat(e0,"/api/analytics/inventory/health?days=").concat(e)),fetch("".concat(e0,"/api/analytics/stores/performance?days=").concat(e)),fetch("".concat(e0,"/api/analytics/category/breakdown?days=").concat(e)),fetch("".concat(e0,"/api/analytics/alerts"))]),[o,c,u,x,m,h,j]=await Promise.all([s.json(),a.json(),l.json(),r.json(),n.json(),d.json(),i.json()]);eT(o),eF(c.data||[]),eP(u.data||[]),ek(x),eZ(m.data||[]),eC(h.data||[]),eW(j.alerts||[])}catch(e){console.error("Error loading enhanced analytics:",e)}};(0,l.useEffect)(()=>{let e=localStorage.getItem("adminLoggedIn"),t=localStorage.getItem("adminUser");if("true"!==e||!t)return void er.push("/");if("super_admin"!==JSON.parse(t).role)return void er.push("/dashboard");e1();let s=setInterval(e1,6e4);return()=>clearInterval(s)},[er]),(0,l.useEffect)(()=>{en.length>0&&(e6(),e4()),ex.length>0&&e3()},[en,ex,eY]),(0,l.useEffect)(()=>{eL||e2(ez,eJ)},[ez,eJ]);let e5=e=>(null==eY?void 0:eY.from)&&(null==eY?void 0:eY.to)?e.filter(e=>{let t=new Date(e.timestamp||e.createdAt);return t>=eY.from&&t<=eY.to}):e,e8=e=>"store_1"===e?"STR-1722255700000":e.startsWith("STR-")?e:e.startsWith("store_")?"STR-".concat(e.replace("store_",""),"000000"):e,e3=()=>{let e=ex.filter(e=>{if(!(null==eY?void 0:eY.from)||!(null==eY?void 0:eY.to))return!0;let t=new Date(e.lastLogged);return t>=eY.from&&t<=eY.to}),t={};e.forEach(e=>{let s=new Date(e.lastLogged),a=new Date(e.lastLogout);if(isNaN(s.getTime())||isNaN(a.getTime())||a<s)return;let l=a.getTime()-s.getTime(),r=(0,G.GP)(s,"yyyy-MM-dd");t[r]||(t[r]={totalSessions:0,totalDuration:0,count:0}),t[r].totalSessions+=1,t[r].totalDuration+=l/6e4,t[r].count+=1}),eg(Object.entries(t).map(e=>{let[t,s]=e;return{date:t,totalSessions:s.totalSessions,averageSessionDuration:s.count>0?Number((s.totalDuration/s.count).toFixed(2)):0}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},e4=()=>{let e=new Map;en.forEach(t=>{let s=new Date(t.timestamp||t.createdAt);t.items.forEach(t=>{(!e.has(t.productId)||s<e.get(t.productId))&&e.set(t.productId,s)})});let t={};e.forEach((e,s)=>{if((null==eY?void 0:eY.from)&&(null==eY?void 0:eY.to)&&e>=eY.from&&e<=eY.to){let a=(0,G.GP)(e,"yyyy-MM-dd");t[a]||(t[a]={productsAdded:new Set,totalValueAdded:0}),t[a].productsAdded.add(s),en.filter(e=>(0,G.GP)(new Date(e.timestamp||e.createdAt),"yyyy-MM-dd")===a&&e.items.some(e=>e.productId===s)).forEach(e=>{e.items.filter(e=>e.productId===s).forEach(e=>{t[a].totalValueAdded+=e.total})})}}),eN(Object.entries(t).map(e=>{let[t,s]=e;return{date:t,productsAdded:s.productsAdded.size,totalValueAdded:Number(s.totalValueAdded.toFixed(2))}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},e6=()=>{let e=e5(en),t={};ei.forEach(s=>{let a=e8(s.id),l=e.filter(e=>e8(e.storeId)===a),r=l.reduce((e,t)=>e+t.total,0),n=l.length,d=l.reduce((e,t)=>e+t.items.reduce((e,t)=>e+t.quantity,0),0),i={};l.forEach(e=>{e.items.forEach(e=>{i[e.productId]||(i[e.productId]={quantity:0,revenue:0,name:e.productName}),i[e.productId].quantity+=e.quantity,i[e.productId].revenue+=e.total})});let o=[...Object.entries(i).map(e=>{let[t,s]=e;return{productId:t,productName:s.name,quantity:s.quantity,revenue:s.revenue}}).sort((e,t)=>t.revenue-e.revenue)].slice(0,5),c={};l.forEach(e=>{let t=(0,G.GP)(new Date(e.timestamp||e.createdAt),"MMM yyyy");c[t]||(c[t]={revenue:0,bills:0}),c[t].revenue+=e.total,c[t].bills+=1});let u=Object.entries(c).map(e=>{let[t,s]=e;return{month:t,...s}}).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime()),x=new Date((null==eY?void 0:eY.from)||new Date);x.setMonth(x.getMonth()-1);let m=new Date((null==eY?void 0:eY.to)||new Date);m.setMonth(m.getMonth()-1);let h=en.filter(e=>{let t=new Date(e.timestamp||e.createdAt);return e.storeId===s.id&&t>=x&&t<=m}),j=h.reduce((e,t)=>e+t.total,0),p=h.length>0?(n-h.length)/h.length*100:0;t[s.id]={storeId:s.id,storeName:s.name,totalRevenue:r,totalBills:n,totalItems:d,averageBillValue:n>0?r/n:0,topProducts:o,monthlyTrend:u,revenueGrowth:j>0?(r-j)/j*100:0,billsGrowth:p}}),ej(Object.values(t));let s={};ec.forEach(t=>{let a=e.filter(e=>e.items.some(e=>e.productId===t.id)),l=0,r=0,n=a.length,d=0,i=0,o={};a.forEach(e=>{e.items.filter(e=>e.productId===t.id).forEach(t=>{l+=t.quantity,r+=t.total,d+=t.price,i+=1,o[e.storeId]||(o[e.storeId]={quantity:0,revenue:0,name:e.storeName||"Unknown Store"}),o[e.storeId].quantity+=t.quantity,o[e.storeId].revenue+=t.total})});let c=i>0?d/i:t.price,u=Object.entries(o).map(e=>{let[t,s]=e;return{storeId:t,storeName:s.name,quantity:s.quantity,revenue:s.revenue}}).sort((e,t)=>t.revenue-e.revenue).slice(0,5),x={};a.forEach(e=>{let s=(0,G.GP)(new Date(e.timestamp||e.createdAt),"MMM yyyy"),a=e.items.filter(e=>e.productId===t.id);x[s]||(x[s]={quantity:0,revenue:0}),a.forEach(e=>{x[s].quantity+=e.quantity,x[s].revenue+=e.total})});let m=Object.entries(x).map(e=>{let[t,s]=e;return{month:t,...s}}).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime()),h=l,j=r,p=new Date((null==eY?void 0:eY.from)||new Date);p.setMonth(p.getMonth()-1);let f=new Date((null==eY?void 0:eY.to)||new Date);f.setMonth(f.getMonth()-1);let y=en.filter(e=>{let s=new Date(e.timestamp||e.createdAt);return s>=p&&s<=f&&e.items.some(e=>e.productId===t.id)}),g=0,v=0;y.forEach(e=>{e.items.filter(e=>e.productId===t.id).forEach(e=>{g+=e.quantity,v+=e.total})});let N=g>0?(h-g)/g*100:0,b=v>0?(j-v)/v*100:0;s[t.id]={productId:t.id,productName:t.name,totalQuantitySold:l,totalRevenue:r,averagePrice:c,totalBills:n,topStores:u,monthlyTrend:m,quantityGrowth:N,revenueGrowth:b}}),ef(Object.values(s).filter(e=>e.totalQuantitySold>0))},e9=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};eK(!0);try{var t,a,l,r;let n=await Promise.all([s.e(524),s.e(436)]).then(s.bind(s,4246)),d=null!=(a=n.default)?a:n;if(!eh.length&&!ep.length)throw Error("No analytics data available to export");let i=Number(eh.reduce((e,t)=>e+t.totalRevenue,0).toFixed(2)),o=eh.reduce((e,t)=>e+t.totalBills,0),c=eh.reduce((e,t)=>e+t.totalItems,0),u=o>0?Number((i/o).toFixed(2)):0,x={summary:!0,storeAnalytics:!0,productAnalytics:!0,topProducts:!0,monthlyTrends:!0,billDetails:!0},m=e.sheets?Object.fromEntries(Object.entries(x).filter(t=>{let[s]=t;return e.sheets.includes(s)})):x,h=(e,t)=>{for(let s=t.s.c;s<=t.e.c;++s){let a=d.utils.encode_cell({r:t.s.r,c:s});e[a]&&(e[a].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4B0082"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}},j=(e,t)=>{let s=t.reduce((e,t)=>(Object.keys(t).forEach((s,a)=>{let l=t[s]?t[s].toString():"";e[a]=Math.max(e[a]||10,l.length+2)}),e),[]);e["!cols"]=s.map(e=>({wch:Math.min(e,40)}))},p=(e,t,s,a)=>{for(let l=t.s.r+1;l<=t.e.r;++l){for(let t of s){let s=d.utils.encode_cell({r:l,c:t-1});e[s]&&(e[s].z='"₹"#,##0.00')}for(let t of a){let s=d.utils.encode_cell({r:l,c:t-1});e[s]&&(e[s].z="0.00%")}}},f=d.utils.book_new();if(m.summary){let e=[{Key:"Analytics Report",Value:"Store and Product Performance"},{Key:"",Value:""},{Key:"Report Generated",Value:(0,G.GP)(new Date,"yyyy-MM-dd HH:mm:ss")},{Key:"Date Range",Value:(null==eY?void 0:eY.from)&&(null==eY?void 0:eY.to)?"".concat((0,G.GP)(eY.from,"yyyy-MM-dd")," to ").concat((0,G.GP)(eY.to,"yyyy-MM-dd")):"Current Month"},{Key:"Selected Store",Value:"all"===eq?"All Stores":(null==(l=ei.find(e=>e.id===eq))?void 0:l.name)||"All Stores"},{Key:"Selected Product",Value:"all"===eU?"All Products":(null==(r=ec.find(e=>e.id===eU))?void 0:r.name)||"All Products"},{Key:"Total Stores",Value:eh.length},{Key:"Total Products",Value:ep.length},{Key:"Total Revenue",Value:i},{Key:"Total Bills",Value:o},{Key:"Total Items Sold",Value:c},{Key:"Average Bill Value",Value:u},{Key:"",Value:""},{Key:"Data Source",Value:"Generated from store billing system"}],t=d.utils.json_to_sheet(e);t["!rows"]=[{hpt:30},...Array(e.length-1).fill({hpt:20})],j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:B1")),p(t,d.utils.decode_range(t["!ref"]||"A1:B1"),[5,8],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Summary")}if(m.storeAnalytics){let e=eh.map(e=>({"Store Name":e.storeName,"Total Revenue":Number(e.totalRevenue.toFixed(2)),"Total Bills":e.totalBills,"Total Items Sold":e.totalItems,"Average Bill Value":Number(e.averageBillValue.toFixed(2)),"Revenue Growth %":e.revenueGrowth/100,"Bills Growth %":e.billsGrowth/100,Status:0===e.totalBills?"No Activity":"Active"})),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:H1")),p(t,d.utils.decode_range(t["!ref"]||"A1:H1"),[2,5],[6,7]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Store Analytics")}if(m.productAnalytics){let e=ep.map(e=>{var t;return{"Product Name":e.productName,"Total Quantity Sold":e.totalQuantitySold,"Total Revenue":Number(e.totalRevenue.toFixed(2)),"Average Price":Number(e.averagePrice.toFixed(2)),"Total Bills":e.totalBills,"Quantity Growth %":e.quantityGrowth/100,"Revenue Growth %":e.revenueGrowth/100,"Top Store":(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"}}),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:H1")),p(t,d.utils.decode_range(t["!ref"]||"A1:H1"),[3,4],[6,7]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Product Analytics")}if(m.topProducts){let e=[];eh.forEach(t=>{t.topProducts.forEach((s,a)=>{e.push({"Store Name":t.storeName,Rank:a+1,"Product Name":s.productName,"Quantity Sold":s.quantity,Revenue:Number(s.revenue.toFixed(2))})})});let t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:E1")),p(t,d.utils.decode_range(t["!ref"]||"A1:E1"),[5],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Top Products by Store")}if(m.monthlyTrends){let e=[];eh.forEach(t=>{t.monthlyTrend.forEach(s=>{e.push({"Store Name":t.storeName,Month:s.month,Revenue:Number(s.revenue.toFixed(2)),Bills:s.bills})})});let t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:D1")),p(t,d.utils.decode_range(t["!ref"]||"A1:D1"),[3],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Monthly Trends")}if(m.billDetails){let e=e5(en).map(e=>({"Bill ID":e.id,"Store Name":e.storeName,"Customer Name":e.customerName||"N/A",Date:(0,G.GP)(new Date(e.timestamp||e.createdAt),"yyyy-MM-dd HH:mm:ss"),Items:e.items.map(e=>"".concat(e.productName," (Qty: ").concat(e.quantity,")")).join(", "),Subtotal:Number((e.subtotal||0).toFixed(2)),Tax:Number((e.taxAmount||0).toFixed(2)),Discount:Number((e.discountAmount||0).toFixed(2)),Total:Number((e.total||0).toFixed(2)),"Created By":e.createdBy})),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:J1")),p(t,d.utils.decode_range(t["!ref"]||"A1:J1"),[6,7,8,9],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Bill Details")}let y=(null==eY?void 0:eY.from)&&(null==eY?void 0:eY.to)?"".concat((0,G.GP)(eY.from,"yyyy-MM-dd"),"_to_").concat((0,G.GP)(eY.to,"yyyy-MM-dd")):(0,G.GP)(new Date,"yyyy-MM-dd"),g="all"===eq?"":"-".concat((null==(t=ei.find(e=>e.id===eq))?void 0:t.name.replace(/\s+/g,"-"))||"store"),v="Analytics-Report".concat(g,"-").concat(y,".xlsx"),N=d.write(f,{bookType:"xlsx",type:"array"}),b=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=URL.createObjectURL(b),S=document.createElement("a");S.href=w,S.download=v,document.body.appendChild(S),S.click(),S.remove(),URL.revokeObjectURL(w),alert("Analytics report exported successfully!")}catch(t){console.error("Error exporting analytics:",t);let e="Failed to export analytics. Please try again.";t.message.includes("No analytics data")?e="No data available to export. Please ensure data is loaded.":t.message.includes("SheetJS")&&(e="Failed to load export library. Please check your connection."),alert(e)}finally{eK(!1)}},e7="all"===eq?eh:eh.filter(e=>e.storeId===eq),te="all"===eU?ep:ep.filter(e=>e.productId===eU),tt=eh.reduce((e,t)=>e+t.totalRevenue,0),ts=eh.reduce((e,t)=>e+t.totalBills,0),ta=eh.reduce((e,t)=>e+t.totalItems,0),tl=ts>0?tt/ts:0;return eL?(0,a.jsx)(n.default,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(D.A,{className:"h-8 w-8 animate-spin"})})}):(0,a.jsx)(n.default,{children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Comprehensive insights into store and product performance"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)(o.$,{onClick:()=>e9(),variant:"outline",className:"bg-green-50 hover:bg-green-100",disabled:eG,children:[(0,a.jsx)(F.A,{className:"h-4 w-4 mr-2"}),eG?"Exporting...":"Export Report"]}),(0,a.jsxs)(o.$,{onClick:e1,variant:"outline",disabled:eG,children:[(0,a.jsx)(D.A,{className:"h-4 w-4 mr-2"}),"Refresh Data"]})]})]}),eE.length>0&&(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(B.A,{className:"h-5 w-5 text-orange-500"}),"Business Alerts"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:eE.map((e,t)=>(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat("error"===e.type?"bg-red-50 border-red-200":"warning"===e.type?"bg-orange-50 border-orange-200":"bg-blue-50 border-blue-200"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.message})]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:e.priority})]})},t))})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center",children:[(0,a.jsx)(P.A,{className:"h-5 w-5 mr-2"}),"Filters & Date Range"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{children:"Date Range"}),(0,a.jsx)(W.S,{date:eY,setDate:e$})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{children:"Quick Ranges"}),(0,a.jsxs)(u.l6,{onValueChange:e=>{let t,s=new Date,a=s;switch(e){case"today":t=s;break;case"yesterday":t=(0,K.e)(s,1),a=(0,K.e)(s,1);break;case"last7days":t=(0,K.e)(s,7);break;case"last30days":t=(0,K.e)(s,30);break;case"thisMonth":t=(0,L.w)(s),a=(0,V.p)(s);break;case"lastMonth":t=(0,L.w)((0,K.e)(s,30)),a=(0,V.p)((0,K.e)(s,30));break;case"thisYear":t=(0,q.D)(s),a=(0,O.Q)(s);break;default:return}e$({from:t,to:a})},children:[(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{placeholder:"Select range"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"today",children:"Today"}),(0,a.jsx)(u.eb,{value:"yesterday",children:"Yesterday"}),(0,a.jsx)(u.eb,{value:"last7days",children:"Last 7 Days"}),(0,a.jsx)(u.eb,{value:"last30days",children:"Last 30 Days"}),(0,a.jsx)(u.eb,{value:"thisMonth",children:"This Month"}),(0,a.jsx)(u.eb,{value:"lastMonth",children:"Last Month"}),(0,a.jsx)(u.eb,{value:"thisYear",children:"This Year"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{children:"Analysis Period"}),(0,a.jsxs)(u.l6,{value:ez,onValueChange:eH,children:[(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"7",children:"Last 7 Days"}),(0,a.jsx)(u.eb,{value:"30",children:"Last 30 Days"}),(0,a.jsx)(u.eb,{value:"60",children:"Last 60 Days"}),(0,a.jsx)(u.eb,{value:"90",children:"Last 90 Days"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{children:"Filter by Store"}),(0,a.jsxs)(u.l6,{value:eq,onValueChange:eO,children:[(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"all",children:"All Stores"}),ei.map(e=>(0,a.jsx)(u.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{children:"Filter by Product"}),(0,a.jsxs)(u.l6,{value:eU,onValueChange:eQ,children:[(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"all",children:"All Products"}),ec.map(e=>(0,a.jsx)(u.eb,{value:e.id,children:e.name},e.id))]})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(_.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",(null==eR||null==(t=eR.revenue)||null==(e=t.current)?void 0:e.toFixed(2))||tt.toFixed(2)]}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[((null==eR||null==(Q=eR.revenue)?void 0:Q.growth)||0)>=0?(0,a.jsx)(k.A,{className:"w-4 h-4 text-green-600 mr-1"}):(0,a.jsx)(I.A,{className:"w-4 h-4 text-red-600 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat(((null==eR||null==(z=eR.revenue)?void 0:z.growth)||0)>=0?"text-green-600":"text-red-600"),children:[Math.abs((null==eR||null==(H=eR.revenue)?void 0:H.growth)||0).toFixed(1),"%"]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"vs previous"})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Bills"}),(0,a.jsx)(Z.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==eR||null==(J=eR.bills)?void 0:J.total)||ts}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Avg: ₹",((null==eR||null==(X=eR.bills)?void 0:X.averageValue)||tl).toFixed(2)]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Items Sold"}),(0,a.jsx)(M.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==eR||null==(Y=eR.items)?void 0:Y.totalSold)||ta}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[((null==eR||null==($=eR.items)?void 0:$.perTransaction)||ta/ts).toFixed(1)," per transaction"]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Unique Customers"}),(0,a.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==eR||null==(ee=eR.customers)?void 0:ee.unique)||0}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Active users: ",null!=(es=null==eb?void 0:eb.onlineCount)?es:0]})]})]})]}),eD.length>0&&(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(d.ZB,{children:"Revenue Trends"}),(0,a.jsxs)(u.l6,{value:eJ,onValueChange:eX,children:[(0,a.jsx)(u.bq,{className:"w-32",children:(0,a.jsx)(u.yv,{})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"daily",children:"Daily"}),(0,a.jsx)(u.eb,{value:"weekly",children:"Weekly"}),(0,a.jsx)(u.eb,{value:"monthly",children:"Monthly"})]})]})]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:300,children:(0,a.jsxs)(j.b,{data:eD,children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"period"}),(0,a.jsx)(y.h,{}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),(0,a.jsx)(v.N,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",strokeWidth:2})]})})})]}),eB.length>0&&(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{children:["Top Selling Products (Last ",ez," Days)"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nd,{children:"Product"}),(0,a.jsx)(x.nd,{children:"Category"}),(0,a.jsx)(x.nd,{className:"text-right",children:"Revenue"}),(0,a.jsx)(x.nd,{className:"text-right",children:"Qty Sold"}),(0,a.jsx)(x.nd,{className:"text-right",children:"Stock"})]})}),(0,a.jsx)(x.BF,{children:eB.map(e=>(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nA,{className:"font-medium",children:e.productName}),(0,a.jsx)(x.nA,{children:e.category}),(0,a.jsxs)(x.nA,{className:"text-right font-semibold",children:["₹",e.revenue.toFixed(2)]}),(0,a.jsx)(x.nA,{className:"text-right",children:e.quantitySold}),(0,a.jsx)(x.nA,{className:"text-right",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.currentStock<10?"bg-red-100 text-red-800":e.currentStock<50?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.currentStock})})]},e.productId))})]})})]}),e_&&(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Total Inventory Value"})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",e_.summary.totalInventoryValue.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e_.summary.totalProducts," products"]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Slow Moving Items"})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:e_.summary.slowMovingCount}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Low turnover ratio"})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"Out of Stock"})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:e_.summary.outOfStockCount}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Needs restocking"})]})]})]}),eM.length>0&&(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Sales by Category"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:300,children:(0,a.jsxs)(N.r,{children:[(0,a.jsx)(b.F,{data:eM,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{payload:t}=e;return"".concat(t.category," ").concat(t.revenuePercentage.toFixed(1),"%")},outerRadius:100,fill:"#8884d8",dataKey:"revenue",children:eM.map((e,t)=>(0,a.jsx)(w.f,{fill:U[t%U.length]},"cell-".concat(t)))}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})})]}),(0,a.jsxs)(m.tU,{defaultValue:"stores",className:"space-y-4",children:[(0,a.jsxs)(m.j7,{children:[(0,a.jsx)(m.Xi,{value:"stores",children:"Store Analytics"}),(0,a.jsx)(m.Xi,{value:"products",children:"Product Analytics"}),(0,a.jsx)(m.Xi,{value:"trends",children:"Trends & Insights"}),(0,a.jsx)(m.Xi,{value:"userSessions",children:"User Sessions"})]}),(0,a.jsxs)(m.av,{value:"stores",className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e7.map(e=>(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(E.A,{className:"h-5 w-5 mr-2"}),e.storeName]}),(0,a.jsx)("div",{className:"flex space-x-2",children:e.revenueGrowth>0?(0,a.jsxs)(i.E,{className:"bg-green-100 text-green-800",children:[(0,a.jsx)(k.A,{className:"h-3 w-3 mr-1"}),"+",e.revenueGrowth.toFixed(1),"%"]}):(0,a.jsxs)(i.E,{variant:"secondary",children:[(0,a.jsx)(I.A,{className:"h-3 w-3 mr-1"}),e.revenueGrowth.toFixed(1),"%"]})})]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold",children:["₹",e.totalRevenue.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Bills"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:e.totalBills})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Items Sold"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:e.totalItems})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Avg Bill"}),(0,a.jsxs)("p",{className:"text-xl font-bold",children:["₹",e.averageBillValue.toFixed(2)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Top Products"}),(0,a.jsx)("div",{className:"space-y-1",children:e.topProducts.slice(0,3).map((t,s)=>(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"truncate",children:[s+1,". ",t.productName]}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",t.revenue.toFixed(2)]})]},"".concat(e.storeId,"-").concat(t.productId)))})]}),e.monthlyTrend.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Revenue Trend"}),(0,a.jsx)(h.u,{width:"100%",height:100,children:(0,a.jsxs)(S.Q,{data:e.monthlyTrend,children:[(0,a.jsx)(A.Gk,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3}),(0,a.jsx)(f.W,{dataKey:"month",hide:!0}),(0,a.jsx)(y.h,{hide:!0}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})]})]})})]},e.storeId))}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Store Revenue Comparison"}),(0,a.jsx)(d.BT,{children:"Revenue performance across all stores"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:400,children:(0,a.jsxs)(R.E,{data:e7,children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"storeName"}),(0,a.jsx)(y.h,{}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),(0,a.jsx)(T.y,{dataKey:"totalRevenue",fill:"#8884d8"})]})})})]})]}),(0,a.jsxs)(m.av,{value:"products",className:"space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Product Performance"}),(0,a.jsx)(d.BT,{children:"Detailed analytics for each product"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{className:"bg-gray-50",children:[(0,a.jsx)(x.nd,{children:"Product Name"}),(0,a.jsx)(x.nd,{children:"Qty Sold"}),(0,a.jsx)(x.nd,{children:"Revenue"}),(0,a.jsx)(x.nd,{children:"Avg Price"}),(0,a.jsx)(x.nd,{children:"Bills"}),(0,a.jsx)(x.nd,{children:"Growth"}),(0,a.jsx)(x.nd,{children:"Top Store"})]})}),(0,a.jsx)(x.BF,{children:te.sort((e,t)=>t.totalRevenue-e.totalRevenue).map(e=>{var t;return(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nA,{className:"font-medium",children:e.productName}),(0,a.jsx)(x.nA,{children:e.totalQuantitySold}),(0,a.jsxs)(x.nA,{className:"font-medium",children:["₹",e.totalRevenue.toFixed(2)]}),(0,a.jsxs)(x.nA,{children:["₹",e.averagePrice.toFixed(2)]}),(0,a.jsx)(x.nA,{children:e.totalBills}),(0,a.jsx)(x.nA,{children:e.revenueGrowth>0?(0,a.jsxs)(i.E,{className:"bg-green-100 text-green-800",children:[(0,a.jsx)(k.A,{className:"h-3 w-3 mr-1"}),"+",e.revenueGrowth.toFixed(1),"%"]}):(0,a.jsxs)(i.E,{variant:"secondary",children:[(0,a.jsx)(I.A,{className:"h-3 w-3 mr-1"}),e.revenueGrowth.toFixed(1),"%"]})}),(0,a.jsx)(x.nA,{children:(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"})]},e.productId)})})]})})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Products Added & Value Over Time"}),(0,a.jsx)(d.BT,{children:"Number of unique products first sold and their total revenue per day"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:400,children:(0,a.jsxs)(j.b,{data:ev,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"date"}),(0,a.jsx)(y.h,{yAxisId:"left",label:{value:"Products Added",angle:-90,position:"insideLeft"}}),(0,a.jsx)(y.h,{yAxisId:"right",orientation:"right",label:{value:"Total Value (₹)",angle:90,position:"insideRight"}}),(0,a.jsx)(g.m,{formatter:(e,t)=>"productsAdded"===t?["".concat(e," products"),"Products Added"]:"totalValueAdded"===t?["₹".concat(Number(e).toFixed(2)),"Total Value Added"]:e}),(0,a.jsx)(v.N,{yAxisId:"left",type:"monotone",dataKey:"productsAdded",stroke:"#8884d8",activeDot:{r:8},name:"productsAdded"}),(0,a.jsx)(v.N,{yAxisId:"right",type:"monotone",dataKey:"totalValueAdded",stroke:"#82ca9d",activeDot:{r:8},name:"totalValueAdded"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Top Products by Revenue"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:300,children:(0,a.jsxs)(N.r,{children:[(0,a.jsx)(b.F,{data:te.slice(0,8).map(e=>({name:e.productName,value:e.totalRevenue,...e})),cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:s}=e;return"".concat(t||""," ").concat(s?(100*s).toFixed(0):0,"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:te.slice(0,8).map((e,t)=>(0,a.jsx)(w.f,{fill:U[t%U.length]},e.productName))}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Top Products by Quantity"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:300,children:(0,a.jsxs)(R.E,{data:te.slice(0,10),children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"productName",angle:-45,textAnchor:"end",height:100}),(0,a.jsx)(y.h,{}),(0,a.jsx)(g.m,{}),(0,a.jsx)(T.y,{dataKey:"totalQuantitySold",fill:"#82ca9d"})]})})})]})]})]}),(0,a.jsxs)(m.av,{value:"trends",className:"space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Revenue Trend Over Time"}),(0,a.jsx)(d.BT,{children:"Monthly revenue comparison across all stores"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:400,children:(0,a.jsxs)(j.b,{data:(null==(et=eh[0])?void 0:et.monthlyTrend)||[],children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"month"}),(0,a.jsx)(y.h,{}),(0,a.jsx)(g.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),eh.map((e,t)=>(0,a.jsx)(v.N,{type:"monotone",dataKey:"revenue",stroke:U[t%U.length],strokeWidth:2,data:e.monthlyTrend},e.storeId))]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Top Performing Store"})}),(0,a.jsx)(d.Wu,{children:eh.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:[...eh].sort((e,t)=>t.totalRevenue-e.totalRevenue).slice(0,1).map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:e.storeName}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["₹",e.totalRevenue.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Growth"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:["+",e.revenueGrowth.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Best Selling Product"}),(0,a.jsx)("p",{className:"font-medium",children:(null==(t=e.topProducts[0])?void 0:t.productName)||"N/A"})]})]},e.storeId)})})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Best Selling Product"})}),(0,a.jsx)(d.Wu,{children:ep.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:ep.sort((e,t)=>t.totalQuantitySold-e.totalQuantitySold).slice(0,1).map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:e.productName}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Quantity Sold"}),(0,a.jsx)("p",{className:"text-xl font-bold text-green-600",children:e.totalQuantitySold})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:["₹",e.totalRevenue.toFixed(2)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Top Store"}),(0,a.jsx)("p",{className:"font-medium",children:(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"})]})]},e.productId)})})})]})]})]}),(0,a.jsxs)(m.av,{value:"userSessions",className:"space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"User Session Duration Trend"}),(0,a.jsx)(d.BT,{children:"Average session duration over time"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:400,children:(0,a.jsxs)(j.b,{data:ey,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"date"}),(0,a.jsx)(y.h,{label:{value:"Avg Duration (minutes)",angle:-90,position:"insideLeft"}}),(0,a.jsx)(g.m,{formatter:e=>["".concat(Number(e).toFixed(2)," minutes"),"Average Session Duration"]}),(0,a.jsx)(v.N,{type:"monotone",dataKey:"averageSessionDuration",stroke:"#8884d8",activeDot:{r:8}})]})})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Total User Sessions Over Time"}),(0,a.jsx)(d.BT,{children:"Number of user sessions per day"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(h.u,{width:"100%",height:400,children:(0,a.jsxs)(R.E,{data:ey,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(p.d,{strokeDasharray:"3 3"}),(0,a.jsx)(f.W,{dataKey:"date"}),(0,a.jsx)(y.h,{label:{value:"Total Sessions",angle:-90,position:"insideLeft"}}),(0,a.jsx)(g.m,{formatter:e=>["".concat(e," sessions"),"Total Sessions"]}),(0,a.jsx)(T.y,{dataKey:"totalSessions",fill:"#82ca9d"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm",children:"Active Users (5 min)"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:null!=(ea=null==eb?void 0:eb.onlineCount)?ea:0})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm",children:"Sessions Today"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:null!=(el=null==eS?void 0:eS.totalSessions)?el:0})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-sm",children:"Avg Session Today"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[eS?Math.round((eS.avgSessionSec||0)/60):0," min"]})})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Online Users Now"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:(null==eb?void 0:eb.online)&&eb.online.length>0?eb.online.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[(0,a.jsx)("span",{className:"font-medium",children:e.userId}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Last seen: ",new Date(e.lastSeen).toLocaleTimeString()]})]},e.userId)):(0,a.jsx)("p",{className:"text-gray-500",children:"No users currently online"})})})]})]})]})]})})}},68020:(e,t,s)=>{Promise.resolve().then(s.bind(s,63290))},81577:(e,t,s)=>{"use strict";s.d(t,{S:()=>f});var a=s(95155),l=s(71163),r=s(16485),n=s(25016),d=s(97003),i=s(12115),o=s(90368),c=s(27937),u=s(31531);function x(e){let{className:t,classNames:s,showOutsideDays:l=!0,onDayClick:r,...i}=e;return(0,a.jsx)(u.h,{showOutsideDays:l,className:(0,n.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>(0,a.jsx)(o.A,{className:"h-4 w-4",...e}),IconRight:e=>(0,a.jsx)(c.A,{className:"h-4 w-4",...e})},...i,onDayClick:r})}x.displayName="Calendar";var m=s(82286);let h=m.bL,j=m.l9,p=i.forwardRef((e,t)=>{let{className:s,align:l="center",sideOffset:r=4,...d}=e;return(0,a.jsx)(m.ZL,{children:(0,a.jsx)(m.UC,{ref:t,align:l,sideOffset:r,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...d})})});function f(e){let{className:t,date:s,setDate:i}=e;return(0,a.jsx)("div",{className:(0,n.cn)("grid gap-2",t),children:(0,a.jsxs)(h,{children:[(0,a.jsx)(j,{asChild:!0,children:(0,a.jsxs)(d.$,{id:"date",variant:"outline",className:(0,n.cn)("w-[300px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[(0,a.jsx)(r.A,{className:"mr-2 h-4 w-4"}),(null==s?void 0:s.from)?s.to?(0,a.jsxs)(a.Fragment,{children:[(0,l.GP)(s.from,"LLL dd, y")," - ",(0,l.GP)(s.to,"LLL dd, y")]}):(0,l.GP)(s.from,"LLL dd, y"):(0,a.jsx)("span",{children:"Pick a date range"})]})}),(0,a.jsx)(p,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(x,{initialFocus:!0,mode:"range",defaultMonth:null==s?void 0:s.from,selected:s,onSelect:i,numberOfMonths:2})})]})})}p.displayName=m.UC.displayName},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>n,aR:()=>d});var a=s(95155),l=s(12115),r=s(25016);let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...l})});n.displayName="Card";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});d.displayName="CardHeader";let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...l})});i.displayName="CardTitle";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});o.displayName="CardDescription";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...l})});c.displayName="CardContent",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})}).displayName="CardFooter"},90235:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(95155),l=s(12115),r=s(10489),n=s(83101),d=s(25016);let i=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.b,{ref:t,className:(0,d.cn)(i(),s),...l})});o.displayName=r.b.displayName},90923:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>o,av:()=>c,j7:()=>i,tU:()=>d});var a=s(95155),l=s(12115),r=s(25667),n=s(25016);let d=r.bL,i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.B8,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...l})});i.displayName=r.B8.displayName;let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...l})});o.displayName=r.l9.displayName;let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...l})});c.displayName=r.UC.displayName},96633:(e,t,s)=>{"use strict";s.d(t,{A0:()=>d,BF:()=>i,Gg:()=>o,Hj:()=>c,XI:()=>n,nA:()=>x,nd:()=>u});var a=s(95155),l=s(12115),r=s(25016);let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",s),...l})})});n.displayName="Table";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",s),...l})});d.displayName="TableHeader";let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",s),...l})});i.displayName="TableBody";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...l})});o.displayName="TableFooter";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...l})});c.displayName="TableRow";let u=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...l})});u.displayName="TableHead";let x=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...l})});x.displayName="TableCell",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",s),...l})}).displayName="TableCaption"}},e=>{e.O(0,[666,530,150,143,619,667,832,441,255,358],()=>e(e.s=68020)),_N_E=e.O()}]);