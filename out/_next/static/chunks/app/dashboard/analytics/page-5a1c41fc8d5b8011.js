(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[754],{12140:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(12115);let l=(e,t)=>{let{interval:s=5e3,enabled:l=!0}=t||{},[r,n]=(0,a.useState)(void 0),[d,i]=(0,a.useState)(!0),[o,c]=(0,a.useState)(void 0),u=(0,a.useRef)(e);return(0,a.useEffect)(()=>{u.current=e},[e]),(0,a.useEffect)(()=>{if(!l)return void i(!1);let e=async()=>{i(!0);try{let e=await u.current();n(e),c(void 0)}catch(e){c(e),n(void 0)}finally{i(!1)}};e();let t=setInterval(()=>{e()},s);return()=>clearInterval(t)},[s,l]),{data:r,loading:d,error:o}}},47507:(e,t,s)=>{"use strict";s.d(t,{bq:()=>x,eb:()=>p,gC:()=>j,l6:()=>c,yv:()=>u});var a=s(95155),l=s(12115),r=s(47887),n=s(24033),d=s(12108),i=s(5917),o=s(25016);let c=r.bL;r.YJ;let u=r.WT,x=l.forwardRef((e,t)=>{let{className:s,children:l,...d}=e;return(0,a.jsxs)(r.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...d,children:[l,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=r.l9.displayName;let m=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});m.displayName=r.PP.displayName;let h=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let j=l.forwardRef((e,t)=>{let{className:s,children:l,position:n="popper",...d}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...d,children:[(0,a.jsx)(m,{}),(0,a.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,a.jsx)(h,{})]})})});j.displayName=r.UC.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})}).displayName=r.JU.displayName;let p=l.forwardRef((e,t)=>{let{className:s,children:l,...n}=e;return(0,a.jsxs)(r.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsx)(r.p4,{children:l})]})});p.displayName=r.q7.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=r.wv.displayName},52179:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let a=s(95125).A.create({baseURL:"http://127.0.0.1:8080",withCredentials:!0});a.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(console.log("401 Unauthorized: Redirecting to login page."),localStorage.removeItem("adminLoggedIn"),localStorage.removeItem("adminUser"),window.location.href="/"),Promise.reject(e)));let l=a},63290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>U});var a=s(95155),l=s(12115),r=s(20063),n=s(10832),d=s(12140),i=s(52179),o=s(83209),c=s(67812),u=s(97003),x=s(90235),m=s(47507),h=s(96633),j=s(90923),p=s(26991),f=s(80019),y=s(68425),g=s(47734),v=s(73697),N=s(10232),b=s(57095),w=s(12723),A=s(4035),S=s(69386),R=s(73850),D=s(94621),T=s(98128),B=s(58155),F=s(89559),k=s(39867),C=s(52056),I=s(63581),P=s(91761),Z=s(1524),_=s(26921),E=s(10512),M=s(26617),W=s(91169),V=s(55136),G=s(71163),K=s(79956),q=s(78674),L=s(16485);let O=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF7C7C"];function U(){var e,t,U,z,H,Q,J,Y,X,$,ee,et,es,ea;let el=(0,r.useRouter)(),[er,en]=(0,l.useState)([]),[ed,ei]=(0,l.useState)([]),[eo,ec]=(0,l.useState)([]),[eu,ex]=(0,l.useState)([]),[em,eh]=(0,l.useState)(!1),[ej,ep]=(0,l.useState)("all"),[ef,ey]=(0,l.useState)("all"),[eg,ev]=(0,l.useState)("30"),[eN,eb]=(0,l.useState)("daily"),[ew,eA]=(0,l.useState)(void 0),[eS,eR]=(0,l.useState)(!1),[eD,eT]=(0,l.useState)(new Date),eB="http://127.0.0.1:8080",eF=(0,l.useCallback)(async()=>(await i.A.get("/api/bills")).data,[]),ek=(0,l.useCallback)(async()=>(await i.A.get("/api/stores")).data,[]),eC=(0,l.useCallback)(async()=>(await i.A.get("/api/products")).data,[]),eI=(0,l.useCallback)(async()=>(await i.A.get("/api/users")).data,[]),eP=(0,l.useCallback)(async()=>(await i.A.get("/api/analytics/users/online?windowMinutes=5")).data,[]),eZ=(0,l.useCallback)(async()=>{let e=new Date().toISOString().slice(0,10);return(await i.A.get("/api/analytics/users/sessions?from=".concat(e,"&to=").concat(e))).data},[]),e_=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/dashboard?days=").concat(eg))).data,[eg,eB]),eE=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/revenue/trends?period=").concat(eN,"&days=").concat(eg))).data.data||[],[eN,eg,eB]),eM=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/products/top?limit=10&days=").concat(eg,"&sortBy=revenue"))).data.data||[],[eg,eB]),eW=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/inventory/health?days=").concat(eg))).data,[eg,eB]),eV=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/stores/performance?days=").concat(eg))).data.data||[],[eg,eB]),eG=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/category/breakdown?days=").concat(eg))).data.data||[],[eg,eB]),eK=(0,l.useCallback)(async()=>(await i.A.get("".concat(eB,"/api/analytics/alerts"))).data.alerts||[],[eB]),eq=(0,l.useCallback)(async()=>{let[e,t,s,a,l,r,n,d,i,o,c,u,x]=await Promise.all([eF(),ek(),eC(),eI(),eP(),eZ(),e_(),eE(),eM(),eW(),eV(),eG(),eK()]);return{bills:e,stores:t,products:s,users:a,onlineUsers:l,sessions:r,dashboardMetrics:n,revenueTrends:d,topProducts:i,inventoryHealth:o,storePerformance:c,categoryBreakdown:u,businessAlerts:x}},[eF,ek,eC,eI,eP,eZ,e_,eE,eM,eW,eV,eG,eK]),{data:eL,loading:eO,error:eU}=(0,d.A)(eq,{interval:3e4}),[ez,eH]=(0,l.useState)([]),[eQ,eJ]=(0,l.useState)([]),[eY,eX]=(0,l.useState)([]),[e$,e0]=(0,l.useState)([]),[e1,e2]=(0,l.useState)(null),[e5,e8]=(0,l.useState)(null),[e3,e4]=(0,l.useState)(null),[e6,e9]=(0,l.useState)([]),[e7,te]=(0,l.useState)([]),[tt,ts]=(0,l.useState)(null),[ta,tl]=(0,l.useState)([]),[tr,tn]=(0,l.useState)([]),[td,ti]=(0,l.useState)([]);(0,l.useEffect)(()=>{eL&&(eH(eL.bills),eJ(eL.stores),eX(eL.products),e0(eL.users),e2(eL.onlineUsers),e8(eL.sessions),e4(eL.dashboardMetrics),e9(eL.revenueTrends),te(eL.topProducts),ts(eL.inventoryHealth),tl(eL.storePerformance),tn(eL.categoryBreakdown),ti(eL.businessAlerts))},[eL]),(0,l.useEffect)(()=>{eU&&console.error("Error fetching analytics data:",eU)},[eU]),(0,l.useEffect)(()=>{let e=localStorage.getItem("adminLoggedIn"),t=localStorage.getItem("adminUser");return"true"===e&&t?"super_admin"!==JSON.parse(t).role?void el.push("/dashboard"):void 0:void el.push("/")},[el]);let to=(0,l.useCallback)(()=>{ez.length>0&&eQ.length>0&&eY.length>0&&(ty(),tm()),e$.length>0&&tx()},[ez,eQ,eY,e$,ew]);(0,l.useEffect)(()=>{to()},[eg,ej,ef,ew,ez,eQ,eY,e$]);let tc=e=>{if(console.log("filterBillsByDate: selectedDate",ew),console.log("filterBillsByDate: input bills count",e.length),!ew)return console.log("filterBillsByDate: No selectedDate, returning all bills."),e;let t=th(ew),s=tj(ew),a=e.filter(e=>{let a=new Date(e.timestamp||e.createdAt);return a>=t&&a<=s});return console.log("filterBillsByDate: filtered bills count",a.length),a},tu=e=>"store_1"===e?"STR-1722255700000":e.startsWith("STR-")?e:e.startsWith("store_")?"STR-".concat(e.replace("store_",""),"000000"):e,tx=()=>{let e=e$.filter(e=>{if(!ew)return!0;let t=new Date(e.lastLogged),s=th(ew),a=tj(ew);return t>=s&&t<=a}),t={};e.forEach(e=>{let s=new Date(e.lastLogged),a=new Date(e.lastLogout);if(isNaN(s.getTime())||isNaN(a.getTime())||a<s)return;let l=a.getTime()-s.getTime(),r=(0,G.GP)(s,"yyyy-MM-dd");t[r]||(t[r]={totalSessions:0,totalDuration:0,count:0}),t[r].totalSessions+=1,t[r].totalDuration+=l/6e4,t[r].count+=1}),ec(Object.entries(t).map(e=>{let[t,s]=e;return{date:t,totalSessions:s.totalSessions,averageSessionDuration:s.count>0?Number((s.totalDuration/s.count).toFixed(2)):0}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},tm=()=>{let e=new Map;ez.forEach(t=>{let s=new Date(t.timestamp||t.createdAt);t.items.forEach(t=>{(!e.has(t.productId)||s<e.get(t.productId))&&e.set(t.productId,s)})});let t={};e.forEach((e,s)=>{if(ew){let a=th(ew),l=tj(ew),r=(0,G.GP)(e,"yyyy-MM-dd");e>=a&&e<=l&&(t[r]||(t[r]={productsAdded:new Set,totalValueAdded:0}),t[r].productsAdded.add(s),ez.filter(e=>(0,G.GP)(new Date(e.timestamp||e.createdAt),"yyyy-MM-dd")===r&&e.items.some(e=>e.productId===s)).forEach(e=>{e.items.filter(e=>e.productId===s).forEach(e=>{t[r].totalValueAdded+=e.total})}))}}),ex(Object.entries(t).map(e=>{let[t,s]=e;return{date:t,productsAdded:s.productsAdded.size,totalValueAdded:Number(s.totalValueAdded.toFixed(2))}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()))},th=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0),tj=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59),tp=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),tf=e=>{let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a)},ty=()=>{let e=tc(ez),t={};eQ.forEach(s=>{let a=tu(s.id),l=e.filter(e=>tu(e.storeId)===a),r=l.reduce((e,t)=>e+t.total,0),n=l.length,d=l.reduce((e,t)=>e+t.items.reduce((e,t)=>e+t.quantity,0),0),i={};l.forEach(e=>{e.items.forEach(e=>{i[e.productId]||(i[e.productId]={quantity:0,revenue:0,name:e.productName}),i[e.productId].quantity+=e.quantity,i[e.productId].revenue+=e.total})});let o=[...Object.entries(i).map(e=>{let[t,s]=e;return{productId:t,productName:s.name,quantity:s.quantity,revenue:s.revenue}}).sort((e,t)=>t.revenue-e.revenue)].slice(0,5),c={};l.forEach(e=>{let t=(0,G.GP)(new Date(e.timestamp||e.createdAt),"MMM yyyy");c[t]||(c[t]={revenue:0,bills:0}),c[t].revenue+=e.total,c[t].bills+=1});let u=Object.entries(c).map(e=>{let[t,s]=e;return{month:t,...s}}).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime()),x=ew?(0,K.e)(ew,30):(0,K.e)(new Date,30),m=ew?(0,K.e)(ew,1):(0,K.e)(new Date,1),h=ez.filter(e=>{let t=new Date(e.timestamp||e.createdAt);return e.storeId===s.id&&t>=x&&t<=m}),j=h.reduce((e,t)=>e+t.total,0),p=h.length>0?(n-h.length)/h.length*100:0;t[s.id]={storeId:s.id,storeName:s.name,totalRevenue:r,totalBills:n,totalItems:d,averageBillValue:n>0?r/n:0,topProducts:o,monthlyTrend:u,revenueGrowth:j>0?(r-j)/j*100:0,billsGrowth:p}}),en(Object.values(t));let s={};eY.forEach(t=>{let a=e.filter(e=>e.items.some(e=>e.productId===t.id)),l=0,r=0,n=a.length,d=0,i=0,o={};a.forEach(e=>{e.items.filter(e=>e.productId===t.id).forEach(t=>{l+=t.quantity,r+=t.total,d+=t.price,i+=1,o[e.storeId]||(o[e.storeId]={quantity:0,revenue:0,name:e.storeName||"Unknown Store"}),o[e.storeId].quantity+=t.quantity,o[e.storeId].revenue+=t.total})});let c=i>0?d/i:t.price,u=Object.entries(o).map(e=>{let[t,s]=e;return{storeId:t,storeName:s.name,quantity:s.quantity,revenue:s.revenue}}).sort((e,t)=>t.revenue-e.revenue).slice(0,5),x={};a.forEach(e=>{let s=(0,G.GP)(new Date(e.timestamp||e.createdAt),"MMM yyyy"),a=e.items.filter(e=>e.productId===t.id);x[s]||(x[s]={quantity:0,revenue:0}),a.forEach(e=>{x[s].quantity+=e.quantity,x[s].revenue+=e.total})});let m=Object.entries(x).map(e=>{let[t,s]=e;return{month:t,...s}}).sort((e,t)=>new Date(e.month).getTime()-new Date(t.month).getTime()),h=l,j=r,p=ew?(0,K.e)(ew,30):(0,K.e)(new Date,30),f=ew?(0,K.e)(ew,1):(0,K.e)(new Date,1),y=ez.filter(e=>{let s=new Date(e.timestamp||e.createdAt);return s>=p&&s<=f&&e.items.some(e=>e.productId===t.id)}),g=0,v=0;y.forEach(e=>{e.items.filter(e=>e.productId===t.id).forEach(e=>{g+=e.quantity,v+=e.total})});let N=g>0?(h-g)/g*100:0,b=v>0?(j-v)/v*100:0;s[t.id]={productId:t.id,productName:t.name,totalQuantitySold:l,totalRevenue:r,averagePrice:c,totalBills:n,topStores:u,monthlyTrend:m,quantityGrowth:N,revenueGrowth:b}}),ei(Object.values(s).filter(e=>e.totalQuantitySold>0))},tg=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};eh(!0);try{var t,a,l,r;let n=await Promise.all([s.e(524),s.e(436)]).then(s.bind(s,4246)),d=null!=(a=n.default)?a:n;if(!er.length&&!ed.length)throw Error("No analytics data available to export");let i=Number(er.reduce((e,t)=>e+t.totalRevenue,0).toFixed(2)),o=er.reduce((e,t)=>e+t.totalBills,0),c=er.reduce((e,t)=>e+t.totalItems,0),u=o>0?Number((i/o).toFixed(2)):0,x={summary:!0,storeAnalytics:!0,productAnalytics:!0,topProducts:!0,monthlyTrends:!0,billDetails:!0},m=e.sheets?Object.fromEntries(Object.entries(x).filter(t=>{let[s]=t;return e.sheets.includes(s)})):x,h=(e,t)=>{for(let s=t.s.c;s<=t.e.c;++s){let a=d.utils.encode_cell({r:t.s.r,c:s});e[a]&&(e[a].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4B0082"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}},j=(e,t)=>{let s=t.reduce((e,t)=>(Object.keys(t).forEach((s,a)=>{let l=t[s]?t[s].toString():"";e[a]=Math.max(e[a]||10,l.length+2)}),e),[]);e["!cols"]=s.map(e=>({wch:Math.min(e,40)}))},p=(e,t,s,a)=>{for(let l=t.s.r+1;l<=t.e.r;++l){for(let t of s){let s=d.utils.encode_cell({r:l,c:t-1});e[s]&&(e[s].z='"₹"#,##0.00')}for(let t of a){let s=d.utils.encode_cell({r:l,c:t-1});e[s]&&(e[s].z="0.00%")}}},f=d.utils.book_new();if(m.summary){let e=[{Key:"Analytics Report",Value:"Store and Product Performance"},{Key:"",Value:""},{Key:"Report Generated",Value:(0,G.GP)(new Date,"yyyy-MM-dd HH:mm:ss")},{Key:"Date",Value:ew?(0,G.GP)(ew,"yyyy-MM-dd"):"N/A"},{Key:"Selected Store",Value:"all"===ej?"All Stores":(null==(l=eQ.find(e=>e.id===ej))?void 0:l.name)||"All Stores"},{Key:"Selected Product",Value:"all"===ef?"All Products":(null==(r=eY.find(e=>e.id===ef))?void 0:r.name)||"All Products"},{Key:"Total Stores",Value:er.length},{Key:"Total Products",Value:ed.length},{Key:"Total Revenue",Value:i},{Key:"Total Bills",Value:o},{Key:"Total Items Sold",Value:c},{Key:"Average Bill Value",Value:u},{Key:"",Value:""},{Key:"Data Source",Value:"Generated from store billing system"}],t=d.utils.json_to_sheet(e);t["!rows"]=[{hpt:30},...Array(e.length-1).fill({hpt:20})],j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:B1")),p(t,d.utils.decode_range(t["!ref"]||"A1:B1"),[5,8],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Summary")}if(m.storeAnalytics){let e=er.map(e=>({"Store Name":e.storeName,"Total Revenue":Number(e.totalRevenue.toFixed(2)),"Total Bills":e.totalBills,"Total Items Sold":e.totalItems,"Average Bill Value":Number(e.averageBillValue.toFixed(2)),"Revenue Growth %":e.revenueGrowth/100,"Bills Growth %":e.billsGrowth/100,Status:0===e.totalBills?"No Activity":"Active"})),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:H1")),p(t,d.utils.decode_range(t["!ref"]||"A1:H1"),[2,5],[6,7]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Store Analytics")}if(m.productAnalytics){let e=ed.map(e=>{var t;return{"Product Name":e.productName,"Total Quantity Sold":e.totalQuantitySold,"Total Revenue":Number(e.totalRevenue.toFixed(2)),"Average Price":Number(e.averagePrice.toFixed(2)),"Total Bills":e.totalBills,"Quantity Growth %":e.quantityGrowth/100,"Revenue Growth %":e.revenueGrowth/100,"Top Store":(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"}}),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:H1")),p(t,d.utils.decode_range(t["!ref"]||"A1:H1"),[3,4],[6,7]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Product Analytics")}if(m.topProducts){let e=[];er.forEach(t=>{t.topProducts.forEach((s,a)=>{e.push({"Store Name":t.storeName,Rank:a+1,"Product Name":s.productName,"Quantity Sold":s.quantity,Revenue:Number(s.revenue.toFixed(2))})})});let t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:E1")),p(t,d.utils.decode_range(t["!ref"]||"A1:E1"),[5],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Top Products by Store")}if(m.monthlyTrends){let e=[];er.forEach(t=>{t.monthlyTrend.forEach(s=>{e.push({"Store Name":t.storeName,Month:s.month,Revenue:Number(s.revenue.toFixed(2)),Bills:s.bills})})});let t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:D1")),p(t,d.utils.decode_range(t["!ref"]||"A1:D1"),[3],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Monthly Trends")}if(m.billDetails){let e=tc(ez).map(e=>({"Bill ID":e.id,"Store Name":e.storeName,"Customer Name":e.customerName||"N/A",Date:(0,G.GP)(new Date(e.timestamp||e.createdAt),"yyyy-MM-dd HH:mm:ss"),Items:e.items.map(e=>"".concat(e.productName," (Qty: ").concat(e.quantity,")")).join(", "),Subtotal:Number((e.subtotal||0).toFixed(2)),Tax:Number((e.taxAmount||0).toFixed(2)),Discount:Number((e.discountAmount||0).toFixed(2)),Total:Number((e.total||0).toFixed(2)),"Created By":e.createdBy})),t=d.utils.json_to_sheet(e);j(t,e),h(t,d.utils.decode_range(t["!ref"]||"A1:J1")),p(t,d.utils.decode_range(t["!ref"]||"A1:J1"),[6,7,8,9],[]),t["!freeze"]={xSplit:0,ySplit:1},d.utils.book_append_sheet(f,t,"Bill Details")}let y=ew?(0,G.GP)(ew,"yyyy-MM-dd"):(0,G.GP)(new Date,"yyyy-MM-dd"),g="all"===ej?"":"-".concat((null==(t=eQ.find(e=>e.id===ej))?void 0:t.name.replace(/\s+/g,"-"))||"store"),v="Analytics-Report".concat(g,"-").concat(y,".xlsx"),N=d.write(f,{bookType:"xlsx",type:"array"}),b=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=URL.createObjectURL(b),A=document.createElement("a");A.href=w,A.download=v,document.body.appendChild(A),A.click(),A.remove(),URL.revokeObjectURL(w),alert("Analytics report exported successfully!")}catch(t){console.error("Error exporting analytics:",t);let e="Failed to export analytics. Please try again.";t.message.includes("No analytics data")?e="No data available to export. Please ensure data is loaded.":t.message.includes("SheetJS")&&(e="Failed to load export library. Please check your connection."),alert(e)}finally{eh(!1)}},tv="all"===ej?er:er.filter(e=>e.storeId===ej),tN="all"===ef?ed:ed.filter(e=>e.productId===ef),tb=er.reduce((e,t)=>e+t.totalRevenue,0),tw=er.reduce((e,t)=>e+t.totalBills,0),tA=er.reduce((e,t)=>e+t.totalItems,0),tS=tw>0?tb/tw:0;return eO?(0,a.jsx)(n.default,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(F.A,{className:"h-8 w-8 animate-spin"})})}):(0,a.jsx)(n.default,{children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Comprehensive insights into store and product performance"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)(u.$,{onClick:()=>tg(),variant:"outline",className:"bg-green-50 hover:bg-green-100",disabled:em,children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),em?"Exporting...":"Export Report"]}),(0,a.jsxs)(u.$,{onClick:to,variant:"outline",className:"bg-blue-50 hover:bg-blue-100",disabled:eO,children:[(0,a.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Refresh Analytics"]})]})]}),td.length>0&&(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 text-orange-500"}),"Business Alerts"]})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:td.map((e,t)=>(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat("error"===e.type?"bg-red-50 border-red-200":"warning"===e.type?"bg-orange-50 border-orange-200":"bg-blue-50 border-blue-200"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.message})]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:e.priority})]})},t))})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.ZB,{className:"flex items-center",children:[(0,a.jsx)(I.A,{className:"h-5 w-5 mr-2"}),"Filters & Date Selection"]})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Selected Date"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(u.$,{variant:"outline",className:"w-full justify-start text-left font-normal",onClick:()=>eR(e=>!e),children:[(0,a.jsx)(L.A,{className:"mr-2 h-4 w-4"}),ew?(0,G.GP)(ew,"LLL dd, y"):(0,a.jsx)("span",{children:"Pick a date"})]}),eS&&(0,a.jsxs)("div",{className:"absolute left-0 z-50 mt-2 bg-white border rounded shadow-lg p-3 w-80",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>eT(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),children:"◀"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:eD.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,a.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>eT(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),children:"▶"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-7 text-[11px] text-gray-500 mb-1",children:[(0,a.jsx)("div",{className:"text-center",children:"Su"}),(0,a.jsx)("div",{className:"text-center",children:"Mo"}),(0,a.jsx)("div",{className:"text-center",children:"Tu"}),(0,a.jsx)("div",{className:"text-center",children:"We"}),(0,a.jsx)("div",{className:"text-center",children:"Th"}),(0,a.jsx)("div",{className:"text-center",children:"Fr"}),(0,a.jsx)("div",{className:"text-center",children:"Sa"})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1",children:(()=>{let e=(0,q.w)(eD).getDay(),t=new Date(eD.getFullYear(),eD.getMonth()+1,0).getDate(),s=[];for(let t=0;t<e;t++)s.push((0,a.jsx)("div",{className:"h-8"},"b-".concat(t)));for(let e=1;e<=t;e++){let t=new Date(eD.getFullYear(),eD.getMonth(),e),l=tp(t,new Date),r=ew&&tp(t,ew),n="h-8 w-8 mx-auto flex items-center justify-center rounded-full cursor-pointer select-none ";l&&(n+="border-2 border-red-500 text-red-600 "),r?n+="bg-blue-600 text-white ":n+="text-gray-700 hover:bg-gray-100 ",s.push((0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:n,onClick:()=>{eA(t),eR(!1)},children:e})},tf(t)))}return s})()}),(0,a.jsx)("div",{className:"mt-3 border-t pt-3 text-right",children:(0,a.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>eR(!1),children:"Close"})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Quick Dates"}),(0,a.jsxs)(m.l6,{onValueChange:e=>{let t,s=new Date;switch(e){case"today":t=s;break;case"yesterday":t=(0,K.e)(s,1);break;case"all":t=void 0;break;default:return}eA(t)},children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{placeholder:"Select date"})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"all",children:"All Dates"}),(0,a.jsx)(m.eb,{value:"today",children:"Today"}),(0,a.jsx)(m.eb,{value:"yesterday",children:"Yesterday"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Analysis Period"}),(0,a.jsxs)(m.l6,{value:eg,onValueChange:ev,children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"7",children:"Last 7 Days"}),(0,a.jsx)(m.eb,{value:"30",children:"Last 30 Days"}),(0,a.jsx)(m.eb,{value:"60",children:"Last 60 Days"}),(0,a.jsx)(m.eb,{value:"90",children:"Last 90 Days"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Filter by Store"}),(0,a.jsxs)(m.l6,{value:ej,onValueChange:ep,children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"all",children:"All Stores"}),eQ.map(e=>(0,a.jsx)(m.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.J,{children:"Filter by Product"}),(0,a.jsxs)(m.l6,{value:ef,onValueChange:ey,children:[(0,a.jsx)(m.bq,{children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"all",children:"All Products"}),eY.map(e=>(0,a.jsx)(m.eb,{value:e.id,children:e.name},e.id))]})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(P.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",(null==e3||null==(t=e3.revenue)||null==(e=t.current)?void 0:e.toFixed(2))||tb.toFixed(2)]}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[((null==e3||null==(U=e3.revenue)?void 0:U.growth)||0)>=0?(0,a.jsx)(Z.A,{className:"w-4 h-4 text-green-600 mr-1"}):(0,a.jsx)(_.A,{className:"w-4 h-4 text-red-600 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat(((null==e3||null==(z=e3.revenue)?void 0:z.growth)||0)>=0?"text-green-600":"text-red-600"),children:[Math.abs((null==e3||null==(H=e3.revenue)?void 0:H.growth)||0).toFixed(1),"%"]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"vs previous"})]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Bills"}),(0,a.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==e3||null==(Q=e3.bills)?void 0:Q.total)||tw}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Avg: ₹",((null==e3||null==(J=e3.bills)?void 0:J.averageValue)||tS).toFixed(2)]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Items Sold"}),(0,a.jsx)(M.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==e3||null==(Y=e3.items)?void 0:Y.totalSold)||tA}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[((null==e3||null==(X=e3.items)?void 0:X.perTransaction)||tA/tw).toFixed(1)," per transaction"]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Unique Customers"}),(0,a.jsx)(W.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==e3||null==($=e3.customers)?void 0:$.unique)||0}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Active users: ",null!=(et=null==e1?void 0:e1.onlineCount)?et:0]})]})]})]}),e6.length>0&&(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(o.ZB,{children:"Revenue Trends"}),(0,a.jsxs)(m.l6,{value:eN,onValueChange:eb,children:[(0,a.jsx)(m.bq,{className:"w-32",children:(0,a.jsx)(m.yv,{})}),(0,a.jsxs)(m.gC,{children:[(0,a.jsx)(m.eb,{value:"daily",children:"Daily"}),(0,a.jsx)(m.eb,{value:"weekly",children:"Weekly"}),(0,a.jsx)(m.eb,{value:"monthly",children:"Monthly"})]})]})]})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(f.b,{data:e6,children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"period"}),(0,a.jsx)(v.h,{}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),(0,a.jsx)(b.N,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",strokeWidth:2})]})})})]}),e7.length>0&&(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.ZB,{children:["Top Selling Products (Last ",eg," Days)"]})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)(h.XI,{children:[(0,a.jsx)(h.A0,{children:(0,a.jsxs)(h.Hj,{children:[(0,a.jsx)(h.nd,{children:"Product"}),(0,a.jsx)(h.nd,{children:"Category"}),(0,a.jsx)(h.nd,{className:"text-right",children:"Revenue"}),(0,a.jsx)(h.nd,{className:"text-right",children:"Qty Sold"}),(0,a.jsx)(h.nd,{className:"text-right",children:"Stock"})]})}),(0,a.jsx)(h.BF,{children:e7.map(e=>(0,a.jsxs)(h.Hj,{children:[(0,a.jsx)(h.nA,{className:"font-medium",children:e.productName}),(0,a.jsx)(h.nA,{children:e.category}),(0,a.jsxs)(h.nA,{className:"text-right font-semibold",children:["₹",e.revenue.toFixed(2)]}),(0,a.jsx)(h.nA,{className:"text-right",children:e.quantitySold}),(0,a.jsx)(h.nA,{className:"text-right",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.currentStock<10?"bg-red-100 text-red-800":e.currentStock<50?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.currentStock})})]},e.productId))})]})})]}),tt&&(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Inventory Value"})}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",tt.summary.totalInventoryValue.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[tt.summary.totalProducts," products"]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Slow Moving Items"})}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:tt.summary.slowMovingCount}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Low turnover ratio"})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Out of Stock"})}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:tt.summary.outOfStockCount}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Needs restocking"})]})]})]}),tr.length>0&&(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Sales by Category"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(w.r,{children:[(0,a.jsx)(A.F,{data:tr,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{payload:t}=e;return"".concat(t.category," ").concat(t.revenuePercentage.toFixed(1),"%")},outerRadius:100,fill:"#8884d8",dataKey:"revenue",children:tr.map((e,t)=>(0,a.jsx)(S.f,{fill:O[t%O.length]},"cell-".concat(t)))}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})})]}),(0,a.jsxs)(j.tU,{defaultValue:"stores",className:"space-y-4",children:[(0,a.jsxs)(j.j7,{children:[(0,a.jsx)(j.Xi,{value:"stores",children:"Store Analytics"}),(0,a.jsx)(j.Xi,{value:"products",children:"Product Analytics"}),(0,a.jsx)(j.Xi,{value:"trends",children:"Trends & Insights"}),(0,a.jsx)(j.Xi,{value:"userSessions",children:"User Sessions"})]}),(0,a.jsxs)(j.av,{value:"stores",className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:tv.map(e=>(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)(o.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(V.A,{className:"h-5 w-5 mr-2"}),e.storeName]}),(0,a.jsx)("div",{className:"flex space-x-2",children:e.revenueGrowth>0?(0,a.jsxs)(c.E,{className:"bg-green-100 text-green-800",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),"+",e.revenueGrowth.toFixed(1),"%"]}):(0,a.jsxs)(c.E,{variant:"secondary",children:[(0,a.jsx)(_.A,{className:"h-3 w-3 mr-1"}),e.revenueGrowth.toFixed(1),"%"]})})]})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold",children:["₹",e.totalRevenue.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Bills"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:e.totalBills})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Items Sold"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:e.totalItems})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Avg Bill"}),(0,a.jsxs)("p",{className:"text-xl font-bold",children:["₹",e.averageBillValue.toFixed(2)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Top Products"}),(0,a.jsx)("div",{className:"space-y-1",children:e.topProducts.slice(0,3).map((t,s)=>(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"truncate",children:[s+1,". ",t.productName]}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",t.revenue.toFixed(2)]})]},"".concat(e.storeId,"-").concat(t.productId)))})]}),e.monthlyTrend.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:"Revenue Trend"}),(0,a.jsx)(p.u,{width:"100%",height:100,children:(0,a.jsxs)(R.Q,{data:e.monthlyTrend,children:[(0,a.jsx)(D.Gk,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3}),(0,a.jsx)(g.W,{dataKey:"month",hide:!0}),(0,a.jsx)(v.h,{hide:!0}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})]})]})})]},e.storeId))}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Store Revenue Comparison"}),(0,a.jsx)(o.BT,{children:"Revenue performance across all stores"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:400,children:(0,a.jsxs)(T.E,{data:tv,children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"storeName"}),(0,a.jsx)(v.h,{}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),(0,a.jsx)(B.y,{dataKey:"totalRevenue",fill:"#8884d8"})]})})})]})]}),(0,a.jsxs)(j.av,{value:"products",className:"space-y-6",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Product Performance"}),(0,a.jsx)(o.BT,{children:"Detailed analytics for each product"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(h.XI,{children:[(0,a.jsx)(h.A0,{children:(0,a.jsxs)(h.Hj,{className:"bg-gray-50",children:[(0,a.jsx)(h.nd,{children:"Product Name"}),(0,a.jsx)(h.nd,{children:"Qty Sold"}),(0,a.jsx)(h.nd,{children:"Revenue"}),(0,a.jsx)(h.nd,{children:"Avg Price"}),(0,a.jsx)(h.nd,{children:"Bills"}),(0,a.jsx)(h.nd,{children:"Growth"}),(0,a.jsx)(h.nd,{children:"Top Store"})]})}),(0,a.jsx)(h.BF,{children:tN.sort((e,t)=>t.totalRevenue-e.totalRevenue).map(e=>{var t;return(0,a.jsxs)(h.Hj,{children:[(0,a.jsx)(h.nA,{className:"font-medium",children:e.productName}),(0,a.jsx)(h.nA,{children:e.totalQuantitySold}),(0,a.jsxs)(h.nA,{className:"font-medium",children:["₹",e.totalRevenue.toFixed(2)]}),(0,a.jsxs)(h.nA,{children:["₹",e.averagePrice.toFixed(2)]}),(0,a.jsx)(h.nA,{children:e.totalBills}),(0,a.jsx)(h.nA,{children:e.revenueGrowth>0?(0,a.jsxs)(c.E,{className:"bg-green-100 text-green-800",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),"+",e.revenueGrowth.toFixed(1),"%"]}):(0,a.jsxs)(c.E,{variant:"secondary",children:[(0,a.jsx)(_.A,{className:"h-3 w-3 mr-1"}),e.revenueGrowth.toFixed(1),"%"]})}),(0,a.jsx)(h.nA,{children:(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"})]},e.productId)})})]})})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Products Added & Value Over Time"}),(0,a.jsx)(o.BT,{children:"Number of unique products first sold and their total revenue per day"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:400,children:(0,a.jsxs)(f.b,{data:eu,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"date"}),(0,a.jsx)(v.h,{yAxisId:"left",label:{value:"Products Added",angle:-90,position:"insideLeft"}}),(0,a.jsx)(v.h,{yAxisId:"right",orientation:"right",label:{value:"Total Value (₹)",angle:90,position:"insideRight"}}),(0,a.jsx)(N.m,{formatter:(e,t)=>"productsAdded"===t?["".concat(e," products"),"Products Added"]:"totalValueAdded"===t?["₹".concat(Number(e).toFixed(2)),"Total Value Added"]:e}),(0,a.jsx)(b.N,{yAxisId:"left",type:"monotone",dataKey:"productsAdded",stroke:"#8884d8",activeDot:{r:8},name:"productsAdded"}),(0,a.jsx)(b.N,{yAxisId:"right",type:"monotone",dataKey:"totalValueAdded",stroke:"#82ca9d",activeDot:{r:8},name:"totalValueAdded"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Top Products by Revenue"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(w.r,{children:[(0,a.jsx)(A.F,{data:tN.slice(0,8).map(e=>({name:e.productName,value:e.totalRevenue,...e})),cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:s}=e;return"".concat(t||""," ").concat(s?(100*s).toFixed(0):0,"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:tN.slice(0,8).map((e,t)=>(0,a.jsx)(S.f,{fill:O[t%O.length]},e.productName))}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]})]})})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Top Products by Quantity"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:300,children:(0,a.jsxs)(T.E,{data:tN.slice(0,10),children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"productName",angle:-45,textAnchor:"end",height:100}),(0,a.jsx)(v.h,{}),(0,a.jsx)(N.m,{}),(0,a.jsx)(B.y,{dataKey:"totalQuantitySold",fill:"#82ca9d"})]})})})]})]})]}),(0,a.jsxs)(j.av,{value:"trends",className:"space-y-6",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Revenue Trend Over Time"}),(0,a.jsx)(o.BT,{children:"Monthly revenue comparison across all stores"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:400,children:(0,a.jsxs)(f.b,{data:(null==(ee=er[0])?void 0:ee.monthlyTrend)||[],children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"month"}),(0,a.jsx)(v.h,{}),(0,a.jsx)(N.m,{formatter:e=>["₹".concat(Number(e).toFixed(2)),"Revenue"]}),er.map((e,t)=>(0,a.jsx)(b.N,{type:"monotone",dataKey:"revenue",stroke:O[t%O.length],strokeWidth:2,data:e.monthlyTrend},e.storeId))]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Top Performing Store"})}),(0,a.jsx)(o.Wu,{children:er.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:[...er].sort((e,t)=>t.totalRevenue-e.totalRevenue).slice(0,1).map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:e.storeName}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["₹",e.totalRevenue.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Growth"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:["+",e.revenueGrowth.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Best Selling Product"}),(0,a.jsx)("p",{className:"font-medium",children:(null==(t=e.topProducts[0])?void 0:t.productName)||"N/A"})]})]},e.storeId)})})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Best Selling Product"})}),(0,a.jsx)(o.Wu,{children:ed.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:ed.sort((e,t)=>t.totalQuantitySold-e.totalQuantitySold).slice(0,1).map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:e.productName}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Quantity Sold"}),(0,a.jsx)("p",{className:"text-xl font-bold text-green-600",children:e.totalQuantitySold})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Revenue"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:["₹",e.totalRevenue.toFixed(2)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Top Store"}),(0,a.jsx)("p",{className:"font-medium",children:(null==(t=e.topStores[0])?void 0:t.storeName)||"N/A"})]})]},e.productId)})})})]})]})]}),(0,a.jsxs)(j.av,{value:"userSessions",className:"space-y-6",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"User Session Duration Trend"}),(0,a.jsx)(o.BT,{children:"Average session duration over time"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:400,children:(0,a.jsxs)(f.b,{data:eo,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"date"}),(0,a.jsx)(v.h,{label:{value:"Avg Duration (minutes)",angle:-90,position:"insideLeft"}}),(0,a.jsx)(N.m,{formatter:e=>["".concat(Number(e).toFixed(2)," minutes"),"Average Session Duration"]}),(0,a.jsx)(b.N,{type:"monotone",dataKey:"averageSessionDuration",stroke:"#8884d8",activeDot:{r:8}})]})})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Total User Sessions Over Time"}),(0,a.jsx)(o.BT,{children:"Number of user sessions per day"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(p.u,{width:"100%",height:400,children:(0,a.jsxs)(T.E,{data:eo,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(y.d,{strokeDasharray:"3 3"}),(0,a.jsx)(g.W,{dataKey:"date"}),(0,a.jsx)(v.h,{label:{value:"Total Sessions",angle:-90,position:"insideLeft"}}),(0,a.jsx)(N.m,{formatter:e=>["".concat(e," sessions"),"Total Sessions"]}),(0,a.jsx)(B.y,{dataKey:"totalSessions",fill:"#82ca9d"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm",children:"Active Users (5 min)"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:null!=(es=null==e1?void 0:e1.onlineCount)?es:0})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm",children:"Sessions Today"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:null!=(ea=null==e5?void 0:e5.totalSessions)?ea:0})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-sm",children:"Avg Session Today"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[e5?Math.round((e5.avgSessionSec||0)/60):0," min"]})})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Online Users Now"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:(null==e1?void 0:e1.online)&&e1.online.length>0?e1.online.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[(0,a.jsx)("span",{className:"font-medium",children:e.userId}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Last seen: ",new Date(e.lastSeen).toLocaleTimeString()]})]},e.userId)):(0,a.jsx)("p",{className:"text-gray-500",children:"No users currently online"})})})]})]})]})]})})}},68020:(e,t,s)=>{Promise.resolve().then(s.bind(s,63290))},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>n,aR:()=>d});var a=s(95155),l=s(12115),r=s(25016);let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...l})});n.displayName="Card";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});d.displayName="CardHeader";let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...l})});i.displayName="CardTitle";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});o.displayName="CardDescription";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...l})});c.displayName="CardContent",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})}).displayName="CardFooter"},90235:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(95155),l=s(12115),r=s(10489),n=s(83101),d=s(25016);let i=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.b,{ref:t,className:(0,d.cn)(i(),s),...l})});o.displayName=r.b.displayName},90923:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>o,av:()=>c,j7:()=>i,tU:()=>d});var a=s(95155),l=s(12115),r=s(25667),n=s(25016);let d=r.bL,i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.B8,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...l})});i.displayName=r.B8.displayName;let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...l})});o.displayName=r.l9.displayName;let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...l})});c.displayName=r.UC.displayName},96633:(e,t,s)=>{"use strict";s.d(t,{A0:()=>d,BF:()=>i,Gg:()=>o,Hj:()=>c,XI:()=>n,nA:()=>x,nd:()=>u});var a=s(95155),l=s(12115),r=s(25016);let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",s),...l})})});n.displayName="Table";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",s),...l})});d.displayName="TableHeader";let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",s),...l})});i.displayName="TableBody";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...l})});o.displayName="TableFooter";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...l})});c.displayName="TableRow";let u=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...l})});u.displayName="TableHead";let x=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...l})});x.displayName="TableCell",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",s),...l})}).displayName="TableCaption"}},e=>{e.O(0,[666,530,150,143,125,230,667,832,441,255,358],()=>e(e.s=68020)),_N_E=e.O()}]);