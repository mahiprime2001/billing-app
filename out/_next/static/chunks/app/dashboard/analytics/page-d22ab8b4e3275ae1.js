(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[754],{47507:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>p,gC:()=>j,l6:()=>o,yv:()=>u});var r=s(95155),a=s(12115),l=s(4729),n=s(24033),i=s(12108),c=s(5917),d=s(25016);let o=l.bL;l.YJ;let u=l.WT,m=a.forwardRef((e,t)=>{let{className:s,children:a,...i}=e;return(0,r.jsxs)(l.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[a,(0,r.jsx)(l.In,{asChild:!0,children:(0,r.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=l.PP.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=l.wn.displayName;let j=a.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...i}=e;return(0,r.jsx)(l.ZL,{children:(0,r.jsxs)(l.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,r.jsx)(x,{}),(0,r.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(h,{})]})})});j.displayName=l.UC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=l.JU.displayName;let p=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(l.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.VF,{children:(0,r.jsx)(c.A,{className:"h-4 w-4"})})}),(0,r.jsx)(l.p4,{children:a})]})});p.displayName=l.q7.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=l.wv.displayName},63290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Y});var r=s(95155),a=s(12115),l=s(20063),n=s(79956),i=s(6180),c=s(71163),d=s(1524),o=s(26921),u=s(89559),m=s(39867),x=s(91761),h=s(10512),j=s(26617),p=s(91169),g=s(16485),f=s(52056),y=s(80534),N=s(86651),v=s(26265),b=s(73850),w=s(68425),A=s(47734),S=s(73697),P=s(33420),I=s(94621),k=s(98128),R=s(37665),M=s(55556),C=s(80019),B=s(57095),_=s(12723),Z=s(4035),E=s(69386),W=s(10832),D=s(67812),q=s(97003),K=s(83209),T=s(33789),U=s(47507),V=s(96633),H=s(90923);let F=["#2563eb","#16a34a","#f59e0b","#f97316","#dc2626","#7c3aed"],L="border-slate-200/80 shadow-sm bg-white/90 backdrop-blur",X=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e||0),G=e=>{if(!e)return null;let t=new Date(e);return Number.isNaN(t.getTime())?null:t},O=(e,t)=>0===t?0===e?0:null:Number(((e-t)/t*100).toFixed(1)),z=e=>{let t=e.reduce((e,t)=>e+t.total,0),s=e.length;return{revenue:t,bills:s,items:e.reduce((e,t)=>e+t.items.reduce((e,t)=>e+t.quantity,0),0),customers:new Set(e.map(e=>e.customerId).filter(Boolean)).size,avgBill:s>0?t/s:0}},Q=e=>{let t=String(null!=e?e:"");return t.includes(",")||t.includes('"')||t.includes("\n")?'"'.concat(t.replace(/"/g,'""'),'"'):t},J=(e,t,s)=>{let r=new Blob([[t.map(Q).join(","),...s.map(e=>e.map(Q).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.setAttribute("download",e),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},$=e=>{let{title:t,value:s,icon:a,change:l}=e;return(0,r.jsxs)(K.Zp,{className:"relative overflow-hidden border-slate-200/80 shadow-sm bg-gradient-to-br from-white to-slate-50",children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 h-full w-1 bg-gradient-to-b from-blue-500 via-emerald-500 to-amber-500"}),(0,r.jsxs)(K.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(K.ZB,{className:"text-sm font-medium",children:t}),(0,r.jsx)("div",{className:"rounded-md bg-slate-100 p-1.5 text-slate-700",children:a})]}),(0,r.jsxs)(K.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold tracking-tight",children:s}),void 0!==l&&(0,r.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:[null===l&&"No previous period data",null!==l&&0===l&&"No change vs previous period",null!==l&&l>0&&(0,r.jsxs)("span",{className:"text-green-600",children:[(0,r.jsx)(d.A,{className:"mr-1 inline h-3 w-3"}),"+",l,"% vs previous period"]}),null!==l&&l<0&&(0,r.jsxs)("span",{className:"text-red-600",children:[(0,r.jsx)(o.A,{className:"mr-1 inline h-3 w-3"}),l,"% vs previous period"]})]})]})]})};function Y(){var e;let t=(0,l.useRouter)(),s="http://127.0.0.1:8080",[o,Q]=(0,a.useState)([]),[Y,ee]=(0,a.useState)([]),[et,es]=(0,a.useState)([]),[er,ea]=(0,a.useState)([]),[el,en]=(0,a.useState)("all"),[ei,ec]=(0,a.useState)(30),[ed,eo]=(0,a.useState)("overview"),[eu,em]=(0,a.useState)(!0),[ex,eh]=(0,a.useState)(!1),[ej,ep]=(0,a.useState)(null),[eg,ef]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=localStorage.getItem("adminLoggedIn"),s=localStorage.getItem("adminUser");if("true"!==e||!s)return void t.push("/login");eh(!0)},[t]);let ey=(0,a.useCallback)(async()=>{em(!0);try{let[e,t,r,a]=await Promise.all([fetch("".concat(s,"/api/bills")).then(e=>e.json()),fetch("".concat(s,"/api/stores")).then(e=>e.json()),fetch("".concat(s,"/api/products")).then(e=>e.json()),fetch("".concat(s,"/api/returns")).then(e=>e.json())]);Q((Array.isArray(e)?e:[]).map(e=>({id:String(e.id||e.billId||e.bill_id||""),storeId:String(e.storeId||e.store_id||e.storeid||""),storeName:e.storeName||e.store_name,customerId:e.customerId||e.customer_id||e.customerid,total:Number(e.total||0),createdAt:e.createdAt||e.created_at||e.timestamp||"",timestamp:e.timestamp||e.createdAt||e.created_at||"",items:Array.isArray(e.items)?e.items.map(e=>({productId:String(e.productId||e.product_id||e.productid||""),productName:e.productName||e.product_name||e.productname||"Unknown Product",quantity:Number(e.quantity||0),price:Number(e.price||0),total:Number(e.total||Number(e.price||0)*Number(e.quantity||0))})):[]}))),ee((Array.isArray(t)?t:[]).map(e=>({id:String(e.id||""),name:e.name||"Unknown Store",status:String(e.status||"active").toLowerCase()}))),es((Array.isArray(r)?r:[]).map(e=>{var t,s,r;let a=Number(e.price||0),l=Number(null!=(r=null!=(s=null!=(t=e.sellingPrice)?t:e.selling_price)?s:e.price)?r:0);return{id:String(e.id||""),name:e.name||"Unknown Product",category:String(e.category||"Uncategorized").trim()||"Uncategorized",costPrice:a,sellingPrice:l,stock:Number(e.stock||0),createdAt:e.createdAt||e.created_at||e.createdat}})),ea((Array.isArray(a)?a:[]).map((e,t)=>({returnId:String(e.returnId||e.return_id||e.id||"return-".concat(t)),productId:String(e.productId||e.product_id||e.productid||""),returnAmount:Number(e.returnAmount||e.return_amount||e.amount||0),status:String(e.status||"pending").toLowerCase(),createdAt:e.createdAt||e.created_at||e.timestamp||""}))),ep(new Date)}catch(e){console.error("Failed to load analytics data",e)}finally{em(!1)}},[s]);(0,a.useEffect)(()=>{ex&&ey()},[ex,ey]);let eN=(0,a.useMemo)(()=>{let e=new Date,t=(0,n.e)(e,Math.max(ei-1,0)),s=(0,n.e)(t,ei),r=(0,n.e)(e,90);return{now:e,currentStart:t,previousStart:s,staleNinetyStart:r}},[ei]),ev=(0,a.useMemo)(()=>o.filter(e=>"all"===el||e.storeId===el),[o,el]),eb=(0,a.useMemo)(()=>ev.filter(e=>{let t=G(e.createdAt||e.timestamp);return!!t&&t>=eN.currentStart&&t<=eN.now}),[ev,eN]),ew=(0,a.useMemo)(()=>ev.filter(e=>{let t=G(e.createdAt||e.timestamp);return!!t&&t>=eN.previousStart&&t<eN.currentStart}),[ev,eN]),eA=(0,a.useMemo)(()=>ev.filter(e=>{let t=G(e.createdAt||e.timestamp);return!!t&&t>=eN.staleNinetyStart&&t<=eN.now}),[ev,eN]),eS=(0,a.useMemo)(()=>{let e=new Map;return et.forEach(t=>{e.set(t.id,t.category||"Uncategorized")}),e},[et]),eP=(0,a.useMemo)(()=>{let e=new Map;return(0,i.k)({start:eN.currentStart,end:eN.now}).forEach(t=>{let s=(0,c.GP)(t,"yyyy-MM-dd");e.set(s,{date:s,revenue:0,bills:0,items:0,avgBill:0})}),eb.forEach(t=>{let s=G(t.createdAt||t.timestamp);if(!s)return;let r=(0,c.GP)(s,"yyyy-MM-dd"),a=e.get(r);a&&(a.revenue+=t.total,a.bills+=1,a.items+=t.items.reduce((e,t)=>e+t.quantity,0))}),e.forEach(e=>{e.avgBill=e.bills>0?e.revenue/e.bills:0}),Array.from(e.values())},[eb,eN]),eI=(0,a.useMemo)(()=>{let e=new Map;return Y.forEach(t=>{e.set(t.id,{storeId:t.id,storeName:t.name,revenue:0,bills:0,items:0,avgBill:0})}),eb.forEach(t=>{if(!t.storeId)return;e.has(t.storeId)||e.set(t.storeId,{storeId:t.storeId,storeName:t.storeName||"Unknown Store",revenue:0,bills:0,items:0,avgBill:0});let s=e.get(t.storeId);s&&(s.revenue+=t.total,s.bills+=1,s.items+=t.items.reduce((e,t)=>e+t.quantity,0),s.avgBill=s.bills>0?s.revenue/s.bills:0)}),Array.from(e.values()).sort((e,t)=>t.revenue-e.revenue)},[Y,eb]),ek=(0,a.useMemo)(()=>{let e=new Map;return eb.forEach(t=>{let s=G(t.createdAt||t.timestamp),r=s?s.toISOString():void 0;t.items.forEach(t=>{if(!t.productId)return;e.has(t.productId)||e.set(t.productId,{productId:t.productId,productName:t.productName||"Unknown Product",category:eS.get(t.productId)||"Uncategorized",quantity:0,revenue:0,bills:0,avgSellingPrice:0,lastSoldAt:r});let s=e.get(t.productId);s&&(s.quantity+=t.quantity,s.revenue+=t.total,s.bills+=1,r&&(!s.lastSoldAt||r>s.lastSoldAt)&&(s.lastSoldAt=r))})}),e.forEach(e=>{e.avgSellingPrice=e.quantity>0?e.revenue/e.quantity:0}),e},[eb,eS]),eR=(0,a.useMemo)(()=>{let e=new Map;return ew.forEach(t=>{t.items.forEach(t=>{t.productId&&e.set(t.productId,(e.get(t.productId)||0)+t.quantity)})}),e},[ew]),eM=(0,a.useMemo)(()=>{let e=new Map;return eA.forEach(t=>{t.items.forEach(t=>{t.productId&&e.set(t.productId,(e.get(t.productId)||0)+t.quantity)})}),e},[eA]),eC=(0,a.useMemo)(()=>Array.from(ek.values()).sort((e,t)=>t.revenue-e.revenue),[ek]),eB=(0,a.useMemo)(()=>{let e=[];return ek.forEach((t,s)=>{let r=eR.get(s)||0,a=t.quantity-r,l=O(t.quantity,r);e.push({productId:s,productName:t.productName,currentQty:t.quantity,previousQty:r,momentum:a,growthPct:l})}),e.sort((e,t)=>t.momentum-e.momentum)},[ek,eR]),e_=(0,a.useMemo)(()=>{let e=new Map;eb.forEach(t=>{t.items.forEach(s=>{let r=eS.get(s.productId)||"Uncategorized";e.has(r)||e.set(r,{revenue:0,quantity:0,billIds:new Set,soldProductIds:new Set});let a=e.get(r);a&&(a.revenue+=s.total,a.quantity+=s.quantity,a.billIds.add(t.id),s.productId&&a.soldProductIds.add(s.productId))})});let t=new Map;return et.forEach(e=>{let s=e.category||"Uncategorized";t.set(s,(t.get(s)||0)+1)}),Array.from(e.entries()).map(e=>{let[s,r]=e;return{category:s,revenue:r.revenue,quantity:r.quantity,bills:r.billIds.size,productCount:t.get(s)||0}}).sort((e,t)=>t.revenue-e.revenue)},[eb,eS,et]),eZ=(0,a.useMemo)(()=>et.filter(e=>0===(eM.get(e.id)||0)).map(e=>{let t=G(e.createdAt);return{productId:e.id,productName:e.name,category:e.category,stock:e.stock,costPrice:e.costPrice,sellingPrice:e.sellingPrice,blockedValue:e.stock*e.sellingPrice,createdAt:t?(0,c.GP)(t,"dd MMM yyyy"):"N/A"}}).sort((e,t)=>t.blockedValue-e.blockedValue),[et,eM]),eE=(0,a.useMemo)(()=>{let e="all"===el?Y:Y.filter(e=>e.id===el),t=new Map;return e.forEach(e=>t.set(e.id,new Set)),o.forEach(e=>{let s=G(e.createdAt||e.timestamp);if(!s||s<eN.staleNinetyStart||s>eN.now||"all"!==el&&e.storeId!==el)return;t.has(e.storeId)||t.set(e.storeId,new Set);let r=t.get(e.storeId);r&&e.items.forEach(e=>{e.productId&&r.add(e.productId)})}),e.map(e=>{let s=t.get(e.id)||new Set,r=et.filter(e=>e.stock>0&&!s.has(e.id)).map(e=>({productId:e.id,productName:e.name,stock:e.stock,blockedValue:e.stock*e.sellingPrice})).sort((e,t)=>t.blockedValue-e.blockedValue);return{storeId:e.id,storeName:e.name,nonSellingCount:r.length,topNonSelling:r.slice(0,8)}}).sort((e,t)=>t.nonSellingCount-e.nonSellingCount)},[Y,el,o,eN,et]),eW=(0,a.useMemo)(()=>et.map(e=>{let t=e.sellingPrice-e.costPrice,s=e.costPrice>0?t/e.costPrice*100:null,r=e.costPrice*e.stock,a=e.sellingPrice*e.stock,l=t*e.stock;return{productId:e.id,productName:e.name,category:e.category,stock:e.stock,costPrice:e.costPrice,sellingPrice:e.sellingPrice,marginPerUnit:t,marginPct:s,costValue:r,potentialSalesValue:a,potentialProfit:l}}).sort((e,t)=>t.potentialProfit-e.potentialProfit),[et]),eD=(0,a.useMemo)(()=>{let e=eW.reduce((e,t)=>e+t.costValue,0);return{totalCostValue:e,totalPotentialSalesValue:eW.reduce((e,t)=>e+t.potentialSalesValue,0),totalPotentialProfit:eW.reduce((e,t)=>e+t.potentialProfit,0),lowStockCount:et.filter(e=>e.stock>0&&e.stock<10).length,outOfStockCount:et.filter(e=>0===e.stock).length}},[eW,et]),eq=(0,a.useMemo)(()=>er.filter(e=>{let t=G(e.createdAt);return!!t&&t>=eN.currentStart&&t<=eN.now}),[er,eN]),eK=(0,a.useMemo)(()=>{let e=new Map;return eq.forEach(t=>{let s=t.status||"unknown";e.set(s,(e.get(s)||0)+1)}),Array.from(e.entries()).map(e=>{let[t,s]=e;return{name:t,value:s}})},[eq]),eT=(0,a.useMemo)(()=>{let e=[];eD.outOfStockCount>0&&e.push({type:"error",title:"Out of stock products",message:"".concat(eD.outOfStockCount," products are at zero stock.")}),eD.lowStockCount>0&&e.push({type:"warning",title:"Low stock products",message:"".concat(eD.lowStockCount," products are below ").concat(10," units.")});let t=er.filter(e=>"pending"===e.status).length;t>0&&e.push({type:"info",title:"Pending returns",message:"".concat(t," returns are pending approval.")});let s=eZ.length;s>0&&e.push({type:"info",title:"Products not sold in 90 days",message:"".concat(s," products had zero sales in the last 90 days.")});let r=Y.filter(e=>"inactive"===e.status).length;return r>0&&e.push({type:"warning",title:"Inactive stores",message:"".concat(r," stores are inactive.")}),e},[eD,er,eZ,Y]),eU=(0,a.useMemo)(()=>z(eb),[eb]),eV=(0,a.useMemo)(()=>z(ew),[ew]),eH=(0,a.useMemo)(()=>O(eU.revenue,eV.revenue),[eU.revenue,eV.revenue]),eF=(0,a.useMemo)(()=>O(eU.bills,eV.bills),[eU.bills,eV.bills]),eL=(0,a.useMemo)(()=>O(eU.items,eV.items),[eU.items,eV.items]),eX=(0,a.useMemo)(()=>O(eU.customers,eV.customers),[eU.customers,eV.customers]),eG="all"===el?"All Stores":(null==(e=Y.find(e=>e.id===el))?void 0:e.name)||"Unknown Store",eO=(0,a.useMemo)(()=>{let e=eg.trim().toLowerCase();return e?eC.filter(t=>t.productName.toLowerCase().includes(e)||t.category.toLowerCase().includes(e)||t.productId.toLowerCase().includes(e)):eC},[eC,eg]),ez=eI.slice(0,10),eQ=eO.slice(0,15),eJ=eB.slice(0,15),e$=eW.slice(0,15),eY=e_.slice(0,10),e0=e$.map(e=>({productName:e.productName,costPrice:Number(e.costPrice.toFixed(2)),sellingPrice:Number(e.sellingPrice.toFixed(2))})),e1=eE.map(e=>({storeName:e.storeName,nonSellingCount:e.nonSellingCount})),e5=(0,a.useCallback)(()=>{let e=(0,c.GP)(new Date,"yyyyMMdd_HHmmss");if("overview"===ed||"revenue"===ed)return void J("analytics_".concat(ed,"_").concat(e,".csv"),["date","revenue","bills","items","avg_bill"],eP.map(e=>[e.date,e.revenue,e.bills,e.items,e.avgBill]));if("stores"===ed)return void J("analytics_stores_".concat(e,".csv"),["store_id","store_name","revenue","bills","items","avg_bill"],eI.map(e=>[e.storeId,e.storeName,e.revenue,e.bills,e.items,e.avgBill]));if("products"===ed)return void J("analytics_products_".concat(e,".csv"),["product_id","product_name","category","quantity","revenue","bills","avg_selling_price","last_sold"],eO.map(e=>[e.productId,e.productName,e.category,e.quantity,e.revenue,e.bills,e.avgSellingPrice,e.lastSoldAt||""]));if("categories"===ed)return void J("analytics_categories_".concat(e,".csv"),["category","revenue","quantity","bills","product_count"],e_.map(e=>[e.category,e.revenue,e.quantity,e.bills,e.productCount]));if("inventory"===ed)return void J("analytics_inventory_".concat(e,".csv"),["product_id","product_name","category","stock","cost_price","selling_price","margin_per_unit","margin_pct","cost_value","potential_sales_value","potential_profit"],eW.map(e=>[e.productId,e.productName,e.category,e.stock,e.costPrice,e.sellingPrice,e.marginPerUnit,null===e.marginPct?"":e.marginPct,e.costValue,e.potentialSalesValue,e.potentialProfit]));if("nonselling"===ed){let t=[];eE.forEach(e=>{if(0===e.topNonSelling.length)return void t.push([e.storeId,e.storeName,"","","",""]);e.topNonSelling.forEach(s=>{t.push([e.storeId,e.storeName,s.productId,s.productName,s.stock,s.blockedValue])})}),J("analytics_nonselling_".concat(e,".csv"),["store_id","store_name","product_id","product_name","stock","blocked_value"],t);return}"returns"===ed&&J("analytics_returns_".concat(e,".csv"),["return_id","product_id","status","return_amount","created_at"],eq.map(e=>[e.returnId,e.productId,e.status,e.returnAmount,e.createdAt]))},[ed,eP,eI,eO,e_,eW,eE,eq]);return!ex||eu?(0,r.jsx)(W.default,{children:(0,r.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,r.jsx)(u.A,{className:"h-8 w-8 animate-spin"})})}):(0,r.jsx)(W.default,{children:(0,r.jsxs)("div",{className:"space-y-6 p-6 max-w-full overflow-x-auto bg-gradient-to-b from-slate-50/70 to-white",children:[(0,r.jsx)(K.Zp,{className:"border-slate-200/80 bg-gradient-to-r from-sky-50 to-emerald-50 shadow-md",children:(0,r.jsx)(K.Wu,{className:"p-5",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 xl:flex-row xl:items-end xl:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold tracking-tight text-slate-900",children:"Advanced Analytics"}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Deep reporting with tab-level exports, category analysis, and non-selling detection."}),(0,r.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Showing ".concat(ei," day window (").concat((0,c.GP)(eN.currentStart,"dd MMM yyyy")," - ").concat((0,c.GP)(eN.now,"dd MMM yyyy"),") | Store: ").concat(eG)})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(U.l6,{value:ei.toString(),onValueChange:e=>ec(Number(e)),children:[(0,r.jsx)(U.bq,{className:"w-[150px] border-slate-300 bg-white text-slate-800",children:(0,r.jsx)(U.yv,{})}),(0,r.jsxs)(U.gC,{children:[(0,r.jsx)(U.eb,{value:"7",children:"Last 7 Days"}),(0,r.jsx)(U.eb,{value:"30",children:"Last 30 Days"}),(0,r.jsx)(U.eb,{value:"90",children:"Last 90 Days"}),(0,r.jsx)(U.eb,{value:"180",children:"Last 180 Days"}),(0,r.jsx)(U.eb,{value:"365",children:"Last 365 Days"})]})]}),(0,r.jsxs)(U.l6,{value:el,onValueChange:en,children:[(0,r.jsx)(U.bq,{className:"w-[190px] border-slate-300 bg-white text-slate-800",children:(0,r.jsx)(U.yv,{})}),(0,r.jsxs)(U.gC,{children:[(0,r.jsx)(U.eb,{value:"all",children:"All Stores"}),Y.map(e=>(0,r.jsx)(U.eb,{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)(q.$,{variant:"outline",onClick:ey,className:"border-slate-300 bg-white text-slate-800 hover:bg-slate-100",children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Refresh"]}),(0,r.jsxs)(q.$,{onClick:e5,className:"bg-emerald-500 text-slate-900 hover:bg-emerald-400",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Export ",ed," CSV"]})]})]})})}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-5",children:[(0,r.jsx)($,{title:"Revenue",value:X(eU.revenue),icon:(0,r.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"}),change:eH}),(0,r.jsx)($,{title:"Bills",value:eU.bills.toString(),icon:(0,r.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"}),change:eF}),(0,r.jsx)($,{title:"Items Sold",value:eU.items.toString(),icon:(0,r.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"}),change:eL}),(0,r.jsx)($,{title:"Customers",value:eU.customers.toString(),icon:(0,r.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),change:eX}),(0,r.jsx)($,{title:"Average Bill",value:X(eU.avgBill),icon:(0,r.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"})})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{className:"pb-2",children:(0,r.jsx)(K.ZB,{className:"text-sm",children:"Data Coverage"})}),(0,r.jsxs)(K.Wu,{className:"space-y-1 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"Bills in selected period: ".concat(eb.length)}),(0,r.jsx)("p",{children:"Bills in previous period: ".concat(ew.length)}),(0,r.jsx)("p",{children:"Products available: ".concat(et.length)}),(0,r.jsx)("p",{children:"Stores available: ".concat(Y.length)})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{className:"pb-2",children:(0,r.jsx)(K.ZB,{className:"text-sm",children:"Inventory Snapshot"})}),(0,r.jsxs)(K.Wu,{className:"space-y-1 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"Total cost value: ".concat(X(eD.totalCostValue))}),(0,r.jsx)("p",{children:"Total potential sales: ".concat(X(eD.totalPotentialSalesValue))}),(0,r.jsx)("p",{children:"Potential profit: ".concat(X(eD.totalPotentialProfit))}),(0,r.jsx)("p",{children:"Non-selling (90 days): ".concat(eZ.length)})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{className:"pb-2",children:(0,r.jsx)(K.ZB,{className:"text-sm",children:"System Snapshot"})}),(0,r.jsxs)(K.Wu,{className:"space-y-1 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"Selected store: ".concat(eG)}),(0,r.jsx)("p",{children:"Inactive stores: ".concat(Y.filter(e=>"inactive"===e.status).length)}),(0,r.jsx)("p",{children:"Pending returns: ".concat(er.filter(e=>"pending"===e.status).length)}),(0,r.jsx)("p",{children:"Last updated: ".concat(ej?(0,c.GP)(ej,"dd MMM yyyy, hh:mm a"):"N/A")})]})]})]}),eT.length>0&&(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Alerts"})}),(0,r.jsx)(K.Wu,{className:"space-y-2",children:eT.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start justify-between rounded-md border border-slate-200 bg-slate-50 p-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(f.A,{className:"mt-0.5 h-4 w-4 ".concat("error"===e.type?"text-red-500":"warning"===e.type?"text-amber-500":"text-blue-500")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.message})]})]}),(0,r.jsx)(D.E,{variant:"outline",children:e.type})]},"".concat(e.title,"-").concat(t)))})]}),(0,r.jsxs)(H.tU,{value:ed,onValueChange:e=>eo(e),children:[(0,r.jsxs)(H.j7,{className:"h-auto w-full justify-start overflow-x-auto rounded-xl border border-slate-200 bg-white p-1 shadow-sm",children:[(0,r.jsx)(H.Xi,{value:"overview",className:"rounded-lg",children:"Overview"}),(0,r.jsx)(H.Xi,{value:"revenue",className:"rounded-lg",children:"Revenue"}),(0,r.jsx)(H.Xi,{value:"stores",className:"rounded-lg",children:"Stores"}),(0,r.jsx)(H.Xi,{value:"products",className:"rounded-lg",children:"Products"}),(0,r.jsx)(H.Xi,{value:"categories",className:"rounded-lg",children:"Categories"}),(0,r.jsx)(H.Xi,{value:"inventory",className:"rounded-lg",children:"Inventory"}),(0,r.jsx)(H.Xi,{value:"nonselling",className:"rounded-lg",children:"Non-Selling"}),(0,r.jsx)(H.Xi,{value:"returns",className:"rounded-lg",children:"Returns"})]}),(0,r.jsx)(H.av,{value:"overview",className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsxs)(K.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(y.A,{className:"h-4 w-4"})," Daily Revenue Trend"]})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(b.Q,{data:eP,children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"revenueFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:"#2563eb",stopOpacity:.7}),(0,r.jsx)("stop",{offset:"95%",stopColor:"#2563eb",stopOpacity:.05})]})}),(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"date",tickFormatter:e=>(0,c.GP)(new Date(e),"dd MMM")}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(I.Gk,{type:"monotone",dataKey:"revenue",stroke:"#2563eb",fill:"url(#revenueFill)"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Top Trending Products"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:eJ.slice(0,8),children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"productName"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{}),(0,r.jsx)(R.s,{}),(0,r.jsx)(M.y,{dataKey:"currentQty",fill:"#16a34a",name:"Current Qty"}),(0,r.jsx)(M.y,{dataKey:"previousQty",fill:"#94a3b8",name:"Previous Qty"})]})})})]})]})}),(0,r.jsxs)(H.av,{value:"revenue",className:"space-y-4",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Revenue, Bills and Items by Day"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:360,children:(0,r.jsxs)(C.b,{data:eP,children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"date",tickFormatter:e=>(0,c.GP)(new Date(e),"dd MMM")}),(0,r.jsx)(S.h,{yAxisId:"left"}),(0,r.jsx)(S.h,{yAxisId:"right",orientation:"right"}),(0,r.jsx)(P.m,{}),(0,r.jsx)(R.s,{}),(0,r.jsx)(B.N,{yAxisId:"left",type:"monotone",dataKey:"revenue",stroke:"#2563eb",name:"Revenue"}),(0,r.jsx)(B.N,{yAxisId:"right",type:"monotone",dataKey:"bills",stroke:"#16a34a",name:"Bills"}),(0,r.jsx)(B.N,{yAxisId:"right",type:"monotone",dataKey:"items",stroke:"#f59e0b",name:"Items"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Daily Revenue Table"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Date"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Revenue"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Bills"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Items"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Avg Bill"})]})}),(0,r.jsx)(V.BF,{children:eP.map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{children:(0,c.GP)(new Date(e.date),"dd MMM yyyy")}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.revenue)}),(0,r.jsx)(V.nA,{className:"text-right",children:e.bills}),(0,r.jsx)(V.nA,{className:"text-right",children:e.items}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.avgBill)})]},e.date))})]})})]})]}),(0,r.jsxs)(H.av,{value:"stores",className:"space-y-4",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Store Revenue Comparison"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:340,children:(0,r.jsxs)(k.E,{data:ez,children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"storeName"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(R.s,{}),(0,r.jsx)(M.y,{dataKey:"revenue",fill:"#2563eb",name:"Revenue"}),(0,r.jsx)(M.y,{dataKey:"bills",fill:"#16a34a",name:"Bills"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Store Performance Table"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Store"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Revenue"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Bills"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Items"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Avg Bill"})]})}),(0,r.jsxs)(V.BF,{children:[0===eI.length&&(0,r.jsx)(V.Hj,{children:(0,r.jsx)(V.nA,{colSpan:5,className:"text-center text-muted-foreground",children:"No store data for this filter."})}),eI.map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{className:"font-medium",children:e.storeName}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.revenue)}),(0,r.jsx)(V.nA,{className:"text-right",children:e.bills}),(0,r.jsx)(V.nA,{className:"text-right",children:e.items}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.avgBill)})]},e.storeId))]})]})})]})]}),(0,r.jsxs)(H.av,{value:"products",className:"space-y-4",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Search Products In Analytics"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)("div",{className:"relative max-w-md",children:[(0,r.jsx)(N.A,{className:"pointer-events-none absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(T.p,{value:eg,onChange:e=>ef(e.target.value),placeholder:"Search by product name, id, or category",className:"pl-9"})]})})]}),(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Top Products by Revenue"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:eQ.slice(0,10),layout:"vertical",children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{type:"number"}),(0,r.jsx)(S.h,{dataKey:"productName",type:"category",width:130}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(M.y,{dataKey:"revenue",fill:"#2563eb"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Trending Products (Current vs Previous)"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:eJ.slice(0,10),children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"productName"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{}),(0,r.jsx)(R.s,{}),(0,r.jsx)(M.y,{dataKey:"currentQty",fill:"#16a34a",name:"Current Qty"}),(0,r.jsx)(M.y,{dataKey:"previousQty",fill:"#9ca3af",name:"Previous Qty"})]})})})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Product Sales Table"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Product"}),(0,r.jsx)(V.nd,{children:"Category"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Qty Sold"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Revenue"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Bills"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Avg Selling Price"}),(0,r.jsx)(V.nd,{children:"Last Sold"})]})}),(0,r.jsxs)(V.BF,{children:[0===eO.length&&(0,r.jsx)(V.Hj,{children:(0,r.jsx)(V.nA,{colSpan:7,className:"text-center text-muted-foreground",children:"No product sales in this period."})}),eO.slice(0,30).map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{className:"font-medium",children:e.productName}),(0,r.jsx)(V.nA,{children:e.category}),(0,r.jsx)(V.nA,{className:"text-right",children:e.quantity}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.revenue)}),(0,r.jsx)(V.nA,{className:"text-right",children:e.bills}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.avgSellingPrice)}),(0,r.jsx)(V.nA,{children:e.lastSoldAt?(0,c.GP)(new Date(e.lastSoldAt),"dd MMM yyyy"):"N/A"})]},e.productId))]})]})})]})]}),(0,r.jsxs)(H.av,{value:"categories",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Revenue by Category"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:eY,children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"category"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(M.y,{dataKey:"revenue",fill:"#2563eb"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Quantity by Category"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(_.r,{children:[(0,r.jsx)(Z.F,{data:eY,dataKey:"quantity",nameKey:"category",outerRadius:100,label:!0,children:eY.map((e,t)=>(0,r.jsx)(E.f,{fill:F[t%F.length]},"".concat(e.category,"-").concat(t)))}),(0,r.jsx)(P.m,{}),(0,r.jsx)(R.s,{})]})})})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Category Performance Table"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Category"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Revenue"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Qty Sold"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Bills"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Total Products"})]})}),(0,r.jsxs)(V.BF,{children:[0===e_.length&&(0,r.jsx)(V.Hj,{children:(0,r.jsx)(V.nA,{colSpan:5,className:"text-center text-muted-foreground",children:"No category sales data in this period."})}),e_.map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{className:"font-medium",children:e.category}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.revenue)}),(0,r.jsx)(V.nA,{className:"text-right",children:e.quantity}),(0,r.jsx)(V.nA,{className:"text-right",children:e.bills}),(0,r.jsx)(V.nA,{className:"text-right",children:e.productCount})]},e.category))]})]})})]})]}),(0,r.jsxs)(H.av,{value:"inventory",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsx)($,{title:"Total Cost Value",value:X(eD.totalCostValue),icon:(0,r.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,r.jsx)($,{title:"Potential Sales Value",value:X(eD.totalPotentialSalesValue),icon:(0,r.jsx)(d.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,r.jsx)($,{title:"Potential Profit",value:X(eD.totalPotentialProfit),icon:(0,r.jsx)(d.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,r.jsx)($,{title:"Low + Out of Stock",value:"".concat(eD.lowStockCount+eD.outOfStockCount),icon:(0,r.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Cost vs Selling Price by Product"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:350,children:(0,r.jsxs)(k.E,{data:e0,children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"productName"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(R.s,{}),(0,r.jsx)(M.y,{dataKey:"costPrice",fill:"#64748b",name:"Cost Price"}),(0,r.jsx)(M.y,{dataKey:"sellingPrice",fill:"#2563eb",name:"Selling Price"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Inventory Margin Table"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Product"}),(0,r.jsx)(V.nd,{children:"Category"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Stock"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Cost"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Selling"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Unit Margin"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Margin %"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Potential Profit"})]})}),(0,r.jsx)(V.BF,{children:eW.slice(0,50).map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{className:"font-medium",children:e.productName}),(0,r.jsx)(V.nA,{children:e.category}),(0,r.jsx)(V.nA,{className:"text-right",children:e.stock}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.costPrice)}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.sellingPrice)}),(0,r.jsx)(V.nA,{className:"text-right",children:(0,r.jsx)("span",{className:e.marginPerUnit>=0?"text-green-600":"text-red-600",children:X(e.marginPerUnit)})}),(0,r.jsx)(V.nA,{className:"text-right",children:null===e.marginPct?"N/A":"".concat(e.marginPct.toFixed(1),"%")}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.potentialProfit)})]},e.productId))})]})})]})]}),(0,r.jsxs)(H.av,{value:"nonselling",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Non-Selling Products by Store (90 Days)"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:e1,children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{dataKey:"storeName"}),(0,r.jsx)(S.h,{}),(0,r.jsx)(P.m,{}),(0,r.jsx)(M.y,{dataKey:"nonSellingCount",fill:"#dc2626",name:"Non-Selling Count"})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Overall Non-Selling (90 Days) by Blocked Value"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(k.E,{data:eZ.slice(0,12),layout:"vertical",children:[(0,r.jsx)(w.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{type:"number"}),(0,r.jsx)(S.h,{dataKey:"productName",type:"category",width:130}),(0,r.jsx)(P.m,{formatter:e=>X(Number(e))}),(0,r.jsx)(M.y,{dataKey:"blockedValue",fill:"#f59e0b",name:"Blocked Value"})]})})})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Store-wise Top Non-Selling Products (90 Days)"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Store"}),(0,r.jsx)(V.nd,{children:"Product"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Stock"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Blocked Value"})]})}),(0,r.jsxs)(V.BF,{children:[eE.every(e=>0===e.topNonSelling.length)&&(0,r.jsx)(V.Hj,{children:(0,r.jsx)(V.nA,{colSpan:4,className:"text-center text-muted-foreground",children:"No non-selling products found for selected scope."})}),eE.flatMap(e=>e.topNonSelling.map(t=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{className:"font-medium",children:e.storeName}),(0,r.jsx)(V.nA,{children:t.productName}),(0,r.jsx)(V.nA,{className:"text-right",children:t.stock}),(0,r.jsx)(V.nA,{className:"text-right",children:X(t.blockedValue)})]},"".concat(e.storeId,"-").concat(t.productId))))]})]})})]})]}),(0,r.jsxs)(H.av,{value:"returns",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Returns by Status"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsx)(v.u,{width:"100%",height:320,children:(0,r.jsxs)(_.r,{children:[(0,r.jsx)(Z.F,{data:eK,dataKey:"value",nameKey:"name",outerRadius:100,label:!0,children:eK.map((e,t)=>(0,r.jsx)(E.f,{fill:F[t%F.length]},"".concat(e.name,"-").concat(t)))}),(0,r.jsx)(P.m,{}),(0,r.jsx)(R.s,{})]})})})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Returns Snapshot"})}),(0,r.jsxs)(K.Wu,{className:"space-y-2 text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"Returns in selected period: ".concat(eq.length)}),(0,r.jsx)("p",{children:"Pending: ".concat(eq.filter(e=>"pending"===e.status).length)}),(0,r.jsx)("p",{children:"Approved: ".concat(eq.filter(e=>"approved"===e.status).length)}),(0,r.jsx)("p",{children:"Rejected: ".concat(eq.filter(e=>"rejected"===e.status).length)}),(0,r.jsx)("p",{children:"Completed: ".concat(eq.filter(e=>"completed"===e.status).length)}),(0,r.jsx)("p",{children:"Total return amount: ".concat(X(eq.reduce((e,t)=>e+t.returnAmount,0)))})]})]})]}),(0,r.jsxs)(K.Zp,{className:L,children:[(0,r.jsx)(K.aR,{children:(0,r.jsx)(K.ZB,{children:"Recent Returns"})}),(0,r.jsx)(K.Wu,{children:(0,r.jsxs)(V.XI,{children:[(0,r.jsx)(V.A0,{children:(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nd,{children:"Date"}),(0,r.jsx)(V.nd,{children:"Return ID"}),(0,r.jsx)(V.nd,{children:"Product ID"}),(0,r.jsx)(V.nd,{className:"text-right",children:"Amount"}),(0,r.jsx)(V.nd,{children:"Status"})]})}),(0,r.jsxs)(V.BF,{children:[0===eq.length&&(0,r.jsx)(V.Hj,{children:(0,r.jsx)(V.nA,{colSpan:5,className:"text-center text-muted-foreground",children:"No returns in this period."})}),eq.slice().sort((e,t)=>{var s,r;return((null==(s=G(t.createdAt))?void 0:s.getTime())||0)-((null==(r=G(e.createdAt))?void 0:r.getTime())||0)}).slice(0,30).map(e=>(0,r.jsxs)(V.Hj,{children:[(0,r.jsx)(V.nA,{children:G(e.createdAt)?(0,c.GP)(G(e.createdAt),"dd MMM yyyy"):"N/A"}),(0,r.jsx)(V.nA,{className:"font-mono text-xs",children:e.returnId}),(0,r.jsx)(V.nA,{className:"font-mono text-xs",children:e.productId||"-"}),(0,r.jsx)(V.nA,{className:"text-right",children:X(e.returnAmount)}),(0,r.jsx)(V.nA,{children:(0,r.jsx)(D.E,{variant:"approved"===e.status||"completed"===e.status?"default":"pending"===e.status?"secondary":"destructive",children:e.status})})]},e.returnId))]})]})})]})]})]})]})})}},81955:(e,t,s)=>{Promise.resolve().then(s.bind(s,63290))},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>i});var r=s(95155),a=s(12115),l=s(25016);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},90923:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>i});var r=s(95155),a=s(12115),l=s(25667),n=s(25016);let i=l.bL,c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.B8,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});c.displayName=l.B8.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});d.displayName=l.l9.displayName;let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});o.displayName=l.UC.displayName},96633:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>c,Gg:()=>d,Hj:()=>o,XI:()=>n,nA:()=>m,nd:()=>u});var r=s(95155),a=s(12115),l=s(25016);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...a})})});n.displayName="Table";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...a})});i.displayName="TableHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...a})});c.displayName="TableBody";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})});d.displayName="TableFooter";let o=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...n,children:a})});o.displayName="TableRow";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});u.displayName="TableHead";let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});m.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption"}},e=>{e.O(0,[9206,6445,5239,5584,9648,6288,6840,5701,832,8441,1255,7358],()=>e(e.s=81955)),_N_E=e.O()}]);