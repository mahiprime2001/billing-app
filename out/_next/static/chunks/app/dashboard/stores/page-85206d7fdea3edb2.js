(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3488],{54679:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>m,Es:()=>u,L3:()=>f,c7:()=>h,lG:()=>d,rr:()=>j,zM:()=>c});var a=t(95155),l=t(12115),r=t(93409),n=t(65229),i=t(25016);let d=r.bL,c=r.l9,o=r.ZL;r.bm;let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hJ,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});x.displayName=r.hJ.displayName;let m=l.forwardRef((e,s)=>{let{className:t,children:l,...d}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(r.UC,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...d,children:[l,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.UC.displayName;let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};h.displayName="DialogHeader";let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};u.displayName="DialogFooter";let f=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hE,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})});f.displayName=r.hE.displayName;let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...l})});j.displayName=r.VY.displayName},67001:(e,s,t)=>{"use strict";t.d(s,{T:()=>n});var a=t(95155),l=t(12115),r=t(25016);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});n.displayName="Textarea"},80409:(e,s,t)=>{Promise.resolve().then(t.bind(t,81744))},81744:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>M});var a=t(95155),l=t(12115),r=t(20063),n=t(10832),i=t(97003),d=t(33789),c=t(90235),o=t(83209),x=t(96633),m=t(54679),h=t(67812),u=t(27599),f=t(25016);let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(u.bL,{className:(0,f.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:s,children:(0,a.jsx)(u.zi,{className:(0,f.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});j.displayName=u.bL.displayName;var g=t(67001),p=t(90368),N=t(27937),b=t(71871),v=t(16485),y=t(6191),w=t(1524),S=t(53409),C=t(86651),k=t(21873),A=t(69141),T=t(23664),E=t(20508),R=t(11010),F=t(23327),D=t(71360),P=t(68267),z=t(65229),L=t(7125);function I(e){let{storeId:s,storeName:t,trigger:r,onAssign:n}=e,[c,x]=(0,l.useState)(!1),[u,f]=(0,l.useState)(""),[j,g]=(0,l.useState)([]),[p,N]=(0,l.useState)([]),[b,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{c&&w()},[c]);let w=async()=>{v(!0);try{let e=await fetch("".concat("http://127.0.0.1:8080","/api/products"));if(e.ok){let s=await e.json();g(s)}else console.error("Failed to fetch products")}catch(e){console.error("Error loading products:",e)}v(!1)},S=j.filter(e=>{var s,t;if(!e)return!1;let a=u.toLowerCase();return(null==(s=e.name)?void 0:s.toLowerCase().includes(a))||(null==(t=e.barcode)?void 0:t.toLowerCase().includes(a))}),k=e=>{p.find(s=>s.id===e.id)?N(s=>s.map(s=>s.id===e.id?{...s,assignedQuantity:Math.min(s.assignedQuantity+1,s.stock)}:s)):N(s=>[...s,{...e,assignedQuantity:1}])},A=(e,s)=>{N(t=>t.map(t=>{if(t.id===e){let e=Math.max(0,Math.min(t.stock,t.assignedQuantity+s));return{...t,assignedQuantity:e}}return t}).filter(e=>e.assignedQuantity>0))},T=()=>{N([]),f("")};return(0,a.jsxs)(m.lG,{open:c,onOpenChange:x,children:[(0,a.jsx)(m.zM,{asChild:!0,children:r}),(0,a.jsxs)(m.Cf,{className:"max-w-7xl max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsxs)(m.L3,{className:"text-2xl flex items-center",children:[(0,a.jsx)(y.A,{className:"h-6 w-6 mr-2 text-blue-600"}),"Assign Products to ",t]}),(0,a.jsx)(m.rr,{children:"Select products to assign to this store and set their quantities."})]}),(0,a.jsxs)("div",{className:"flex gap-6 h-[70vh]",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(C.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(d.p,{placeholder:"Search by product name or barcode...",value:u,onChange:e=>f(e.target.value),className:"pl-10"})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[b?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading products..."}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(e=>(0,a.jsx)(o.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>k(e),children:(0,a.jsx)(o.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-1",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:["#",e.barcode]}),(0,a.jsxs)(h.E,{variant:"outline",className:"text-xs",children:["Stock: ",e.stock]})]}),(0,a.jsx)(i.$,{size:"sm",onClick:s=>{s.stopPropagation(),k(e)},className:"ml-2",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})})},e.id))}),!b&&0===S.length&&(0,a.jsx)("div",{className:"text-center py-16",children:(0,a.jsx)("div",{className:"text-gray-500",children:u?"No products found matching your search.":"No products available."})})]})]}),(0,a.jsxs)("div",{className:"w-80 border-l pl-6 flex flex-col",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Selected Products (",p.length,")"]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===p.length?(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No products selected yet."}):(0,a.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,a.jsx)(o.Zp,{className:"border",children:(0,a.jsxs)(o.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["#",e.barcode]}),(0,a.jsxs)(h.E,{variant:"outline",className:"text-xs mt-1",children:["Available: ",e.stock]})]}),(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.id,void N(e=>e.filter(e=>e.id!==s))},className:"text-red-600 hover:text-red-700",children:(0,a.jsx)(z.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Quantity:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>A(e.id,-1),disabled:e.assignedQuantity<=1,children:(0,a.jsx)(L.A,{className:"h-3 w-3"})}),(0,a.jsx)("span",{className:"min-w-[2rem] text-center font-medium",children:e.assignedQuantity}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>A(e.id,1),disabled:e.assignedQuantity>=e.stock,children:(0,a.jsx)(y.A,{className:"h-3 w-3"})})]})]})]})},e.id))})})]})]}),(0,a.jsxs)(m.Es,{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>{T(),x(!1)},children:"Cancel"}),(0,a.jsx)(i.$,{variant:"outline",onClick:T,children:"Reset"})]}),(0,a.jsx)(i.$,{onClick:()=>{if(0===p.length)return void alert("Please select at least one product to assign.");n(s,p),T(),x(!1)},disabled:0===p.length,className:"bg-blue-600 hover:bg-blue-700",children:"Assign Products"})]})]})]})}let $=e=>"store_1"===e?"STR-1722255700000":(e.startsWith("STR-"),e),J="http://127.0.0.1:8080";function O(e){let{dates:s,selectedDate:t,onDateSelect:r}=e,[n,d]=(0,l.useState)(new Date),c=new Map(s.map(e=>[e.date,e])),o=new Date,x=n.getFullYear(),m=n.getMonth(),h=new Date(x,m,1),u=new Date(x,m+1,0).getDate(),f=h.getDay(),j=[];for(let e=0;e<f;e++)j.push(null);for(let e=1;e<=u;e++){let s=new Date(x,m,e).toISOString().split("T")[0],t=c.get(s);j.push({day:e,dateStr:s,isToday:s===o.toISOString().split("T")[0],hasData:!!t,data:t})}return(0,a.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>{d(new Date(x,m-1))},className:"h-8 w-8 p-0",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][m]," ",x]}),(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>{d(new Date(x,m+1))},className:"h-8 w-8 p-0",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"text-xs font-medium text-gray-500 text-center p-2",children:e},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1",children:j.map((e,s)=>{if(!e)return(0,a.jsx)("div",{className:"h-8"},s);let l=t===e.dateStr,n=e.isToday,i=e.hasData;return(0,a.jsxs)("button",{onClick:()=>i&&r(e.dateStr),disabled:!i,className:"\n                h-8 w-8 text-xs rounded-md relative transition-all duration-200\n                ".concat(l&&i?"bg-blue-600 text-white font-semibold":i?"bg-blue-50 text-blue-700 hover:bg-blue-100 font-medium border border-blue-200":n?"bg-gray-100 text-gray-900 font-medium":"text-gray-400 hover:bg-gray-50","\n                ").concat(i?"cursor-pointer":"cursor-default","\n              "),children:[e.day,i&&(0,a.jsx)("div",{className:"\n                  absolute -top-0.5 -right-0.5 h-2 w-2 rounded-full\n                  ".concat(l?"bg-white":"bg-blue-500","\n                ")})]},e.dateStr)})}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 mt-4 text-xs text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),(0,a.jsx)("span",{children:"Has inventory"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-gray-300 rounded-full"}),(0,a.jsx)("span",{children:"No data"})]})]})]})}function B(e){let{open:s,onClose:t,store:r}=e,[n,d]=(0,l.useState)(90),[c,o]=(0,l.useState)([]),[u,f]=(0,l.useState)(null),[j,g]=(0,l.useState)([]),[p,N]=(0,l.useState)({totalStock:0,totalValue:0});(0,l.useEffect)(()=>{s&&r&&fetch("".concat(J,"/api/stores/").concat(r.id,"/inventory-calendar?days=").concat(n)).then(e=>e.json()).then(e=>o(e.data||[])).catch(()=>o([]))},[s,r,n]),(0,l.useEffect)(()=>{s&&r&&u&&fetch("".concat(J,"/api/stores/").concat(r.id,"/inventory-by-date/").concat(u)).then(e=>e.json()).then(e=>{g(e.rows||[]),N({totalStock:e.totalStock||0,totalValue:e.totalValue||0})}).catch(()=>{g([]),N({totalStock:0,totalValue:0})})},[s,r,u]);let y=async()=>{var e;let s=(null==(e=document.getElementById("printable-table"))?void 0:e.outerHTML)||"",t="\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Store Inventory — ".concat((null==r?void 0:r.name)||"","</title>\n          <style>\n            body{font-family:Inter,system-ui,Arial;padding:12px}\n            table{width:100%;border-collapse:collapse}\n            th,td{border:1px solid #000;padding:6px;text-align:left;font-size:12px}\n            tfoot td{font-weight:600}\n            @page{size:auto;margin:10mm}\n          </style>\n        </head>\n        <body>").concat(s,"</body>\n      </html>\n    ");try{await (0,P.lA)("print_html",{html:t})}catch(e){console.error("Print failed:",e)}};return s&&r?(0,a.jsx)(m.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(m.Cf,{className:"max-w-6xl max-h-[90vh] flex flex-col",children:[(0,a.jsxs)(m.c7,{className:"border-b pb-4",children:[(0,a.jsxs)(m.L3,{className:"text-lg font-semibold flex items-center",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 mr-2 text-blue-600"}),r.name," - Inventory Overview"]}),(0,a.jsxs)(m.rr,{children:[(0,a.jsx)("span",{children:r.address||"No address"})," • ",(0,a.jsx)("span",{children:r.phone||"No phone"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 mr-2"}),"Inventory Calendar"]}),(0,a.jsxs)(h.E,{variant:"secondary",className:"text-xs",children:[c.length," days with inventory"]})]}),(0,a.jsx)(O,{dates:c,selectedDate:u,onDateSelect:f}),u&&(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-blue-800 mb-2",children:["Selected: ",new Date(u).toDateString()]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-blue-600 font-medium",children:"Products"}),(0,a.jsx)("div",{className:"text-blue-800 font-semibold",children:j.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-blue-600 font-medium",children:"Total Stock"}),(0,a.jsx)("div",{className:"text-blue-800 font-semibold",children:p.totalStock})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-blue-600 font-medium",children:"Total Value"}),(0,a.jsxs)("div",{className:"text-blue-800 font-semibold",children:["₹",p.totalValue.toFixed(2)]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:u?"Product Details":"Select a date to view products"}),u&&j.length>0&&(0,a.jsx)(i.$,{size:"sm",onClick:y,className:"bg-blue-600 hover:bg-blue-700",children:"Print Report"})]}),u?(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden max-h-[500px] overflow-y-auto",children:(0,a.jsxs)(x.XI,{id:"printable-table",children:[(0,a.jsx)(x.A0,{className:"bg-slate-100 sticky top-0",children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nd,{className:"text-xs",children:"S.No"}),(0,a.jsx)(x.nd,{className:"text-xs",children:"Barcode"}),(0,a.jsx)(x.nd,{className:"text-xs",children:"Product"}),(0,a.jsx)(x.nd,{className:"text-xs",children:"Price"}),(0,a.jsx)(x.nd,{className:"text-xs",children:"Stock"}),(0,a.jsx)(x.nd,{className:"text-xs",children:"Value"})]})}),(0,a.jsx)(x.BF,{children:j.map((e,s)=>(0,a.jsxs)(x.Hj,{className:"hover:bg-gray-50",children:[(0,a.jsx)(x.nA,{className:"text-xs",children:s+1}),(0,a.jsx)(x.nA,{className:"text-xs font-mono",children:e.barcode}),(0,a.jsx)(x.nA,{className:"text-xs",children:e.name}),(0,a.jsxs)(x.nA,{className:"text-xs",children:["₹",e.price.toFixed(2)]}),(0,a.jsx)(x.nA,{className:"text-xs",children:e.stock}),(0,a.jsxs)(x.nA,{className:"text-xs",children:["₹",e.rowValue.toFixed(2)]})]},e.id))}),j.length>0&&(0,a.jsx)(x.Gg,{className:"bg-slate-50",children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nA,{colSpan:4,className:"text-xs font-semibold",children:"Totals"}),(0,a.jsx)(x.nA,{className:"text-xs font-semibold",children:p.totalStock}),(0,a.jsxs)(x.nA,{className:"text-xs font-semibold",children:["₹",p.totalValue.toFixed(2)]})]})})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-64 border-2 border-dashed border-gray-200 rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(v.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Click on a highlighted date in the calendar to view inventory details"})]})})]})]})}),(0,a.jsxs)(m.Es,{className:"border-t pt-4",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:t,children:"Close"}),u&&j.length>0&&(0,a.jsx)(i.$,{onClick:y,className:"bg-blue-600 hover:bg-blue-700",children:"Print Selected Date"})]})]})}):null}function M(){let e=(0,r.useRouter)(),[s,t]=(0,l.useState)([]),[u,f]=(0,l.useState)([]),[p,N]=(0,l.useState)(""),[v,P]=(0,l.useState)(!1),[z,L]=(0,l.useState)(null),[J,O]=(0,l.useState)({name:"",address:"",phone:"",email:"",manager:"",status:"active"}),[M,Z]=(0,l.useState)(!1),[H,V]=(0,l.useState)(null);(0,l.useEffect)(()=>{let s=localStorage.getItem("adminLoggedIn"),t=localStorage.getItem("adminUser");return"true"===s&&t?"super_admin"!==JSON.parse(t).role?void e.push("/billing"):void _():void e.push("/")},[e]);let _=async()=>{try{let[e,s]=await Promise.all([fetch("http://127.0.0.1:8080/api/stores"),fetch("http://127.0.0.1:8080/api/bills")]);if(e.ok){let s=await e.json();t(s)}else console.error("Failed to fetch stores");if(s.ok){let e=await s.json();f(e)}else console.error("Failed to fetch bills")}catch(e){console.error("Error loading data:",e)}},Q=async e=>{if(e.preventDefault(),!J.name||!J.address)return void alert("Please fill in all required fields");let s={name:J.name,address:J.address,phone:J.phone,email:J.email,manager:J.manager,status:J.status};try{let e;if((e=z?await fetch("http://127.0.0.1:8080"+"/api/stores/".concat(z.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}):await fetch("http://127.0.0.1:8080/api/stores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)await _(),Y(),P(!1);else{let s=await e.json();alert("Failed to save store: ".concat(s.message))}}catch(e){console.error("Error saving store:",e),alert("An error occurred while saving the store.")}},W=async e=>{let s=$(e),t=u.filter(e=>$(e.storeId)===s);if(t.length>0)return void alert("Cannot delete store. It has ".concat(t.length," associated bills. Please deactivate instead."));if(confirm("Are you sure you want to delete this store? This action cannot be undone."))try{let s=await fetch("http://127.0.0.1:8080"+"/api/stores/".concat(e),{method:"DELETE"});if(s.ok)await _();else{let e=await s.json();alert("Failed to delete store: ".concat(e.message))}}catch(e){console.error("Error deleting store:",e),alert("An error occurred while deleting the store.")}},U=async(e,s)=>{try{let t=await fetch("".concat("http://127.0.0.1:8080","/api/stores/").concat(e,"/assign-products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:s})});if(t.ok)alert("Successfully assigned ".concat(s.length," products to the store!"));else{let e=await t.json().catch(()=>({}));alert("Failed to assign products: ".concat(e.message||"Unknown error"))}}catch(e){console.error("Error assigning products:",e),alert("An error occurred while assigning products.")}},G=async e=>{let t=s.find(s=>s.id===e);if(!t)return;let a="active"===t.status?"inactive":"active";try{let s=await fetch("http://127.0.0.1:8080"+"/api/stores/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})});if(s.ok)await _();else{let e=await s.json();alert("Failed to update status: ".concat(e.message))}}catch(e){console.error("Error updating status:",e),alert("An error occurred while updating the store status.")}},Y=()=>{O({name:"",address:"",phone:"",email:"",manager:"",status:"active"}),L(null)},q=s.filter(e=>{var s,t,a;if(!e)return!1;let l=p.toLowerCase();return((null==(s=e.name)?void 0:s.toLowerCase())||"").includes(l)||((null==(t=e.address)?void 0:t.toLowerCase())||"").includes(l)||((null==(a=e.manager)?void 0:a.toLowerCase())||"").includes(l)}),X=u.reduce((e,s)=>e+(s.total||0),0),K=u.length,ee=s.filter(e=>"active"===e.status).length;return(0,a.jsx)(n.default,{children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Store Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your store locations and track performance"})]}),(0,a.jsxs)(m.lG,{open:v,onOpenChange:P,children:[(0,a.jsx)(m.zM,{asChild:!0,children:(0,a.jsxs)(i.$,{onClick:Y,className:"bg-blue-600 hover:bg-blue-700 shadow-lg",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Add New Store"]})}),(0,a.jsxs)(m.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsxs)(m.L3,{className:"text-2xl flex items-center",children:[(0,a.jsx)(b.A,{className:"h-6 w-6 mr-2 text-blue-600"}),z?"Edit Store":"Add New Store"]}),(0,a.jsx)(m.rr,{children:z?"Update store information and details":"Create a new store location with complete details"})]}),(0,a.jsxs)("form",{onSubmit:Q,children:[(0,a.jsxs)("div",{className:"grid gap-6 py-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"name",children:"Store Name *"}),(0,a.jsx)(d.p,{id:"name",value:J.name,onChange:e=>O({...J,name:e.target.value}),placeholder:"Enter store name",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"address",children:"Store Address *"}),(0,a.jsx)(g.T,{id:"address",value:J.address,onChange:e=>O({...J,address:e.target.value}),placeholder:"Enter complete store address",rows:3,required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"phone",children:"Phone Number"}),(0,a.jsx)(d.p,{id:"phone",value:J.phone,onChange:e=>O({...J,phone:e.target.value}),placeholder:"Enter phone number"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"email",children:"Email Address"}),(0,a.jsx)(d.p,{id:"email",type:"email",value:J.email,onChange:e=>O({...J,email:e.target.value}),placeholder:"Enter email address"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"manager",children:"Store Manager"}),(0,a.jsx)(d.p,{id:"manager",value:J.manager,onChange:e=>O({...J,manager:e.target.value}),placeholder:"Enter manager name"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"status",children:"Store Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,a.jsx)(j,{id:"status",checked:"active"===J.status,onCheckedChange:e=>O({...J,status:e?"active":"inactive"})}),(0,a.jsx)(c.J,{htmlFor:"status",children:"Store is active"})]})]})]})]}),(0,a.jsxs)(m.Es,{className:"flex space-x-2",children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,a.jsx)(i.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:z?"Update Store":"Create Store"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Stores"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.length}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[ee," active stores"]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",X.toFixed(2)]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Across all stores"})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Total Bills"}),(0,a.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:K}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bills generated"})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ZB,{className:"text-sm font-medium",children:"Average per Store"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["₹",ee>0?(X/ee).toFixed(2):"0.00"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Revenue per active store"})]})]})]}),(0,a.jsxs)(o.Zp,{className:"shadow-lg",children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.ZB,{className:"text-2xl",children:"Store Locations"}),(0,a.jsxs)(o.BT,{children:[s.length," total stores • ",ee," active • ",s.length-ee," inactive"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)(d.p,{placeholder:"Search stores...",value:p,onChange:e=>N(e.target.value),className:"w-64"})]})]})}),(0,a.jsx)(o.Wu,{children:q.length>0?(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{className:"bg-gray-50",children:[(0,a.jsx)(x.nd,{children:"Store Details"}),(0,a.jsx)(x.nd,{children:"Store Info"}),(0,a.jsx)(x.nd,{children:"Revenue"}),(0,a.jsx)(x.nd,{children:"Status"}),(0,a.jsx)(x.nd,{children:"Actions"})]})}),(0,a.jsx)(x.BF,{children:q.map(e=>(0,a.jsxs)(x.Hj,{className:"hover:bg-gray-50",children:[(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"font-medium flex items-center",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2 text-blue-600"}),e.name]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-start",children:[(0,a.jsx)(k.A,{className:"h-3 w-3 mr-1 mt-0.5 text-gray-400"}),(0,a.jsx)("span",{className:"line-clamp-2",children:e.address})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["Created: ",new Date(e.createdDate).toLocaleDateString()]})]})}),(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[e.phone&&(0,a.jsxs)("div",{className:"text-sm flex items-center",children:[(0,a.jsx)(A.A,{className:"h-3 w-3 mr-1 text-gray-400"}),e.phone]}),e.email&&(0,a.jsxs)("div",{className:"text-sm flex items-center",children:[(0,a.jsx)(T.A,{className:"h-3 w-3 mr-1 text-gray-400"}),e.email]}),e.manager&&(0,a.jsxs)("div",{className:"text-sm flex items-center",children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 text-gray-400"}),e.manager]})]})}),(0,a.jsx)(x.nA,{children:(0,a.jsx)("div",{className:"space-y-1",children:(()=>{let s=u.filter(s=>$(s.storeId)===$(e.id)),t=s.reduce((e,s)=>e+(s.total||0),0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:["₹",t.toFixed(2)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[s.length," bills"]})]})})()})}),(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j,{checked:"active"===e.status,onCheckedChange:()=>G(e.id)}),"active"===e.status?(0,a.jsx)(h.E,{className:"bg-green-100 text-green-800",children:"Active"}):(0,a.jsx)(h.E,{variant:"secondary",children:"Inactive"})]})}),(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{L(e),O({name:e.name,address:e.address,phone:e.phone,email:e.email,manager:e.manager,status:e.status}),P(!0)},children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{V(e),Z(!0)},className:"bg-blue-50 hover:bg-blue-100 border-blue-200",title:"Store insights",children:(0,a.jsx)(F.A,{className:"h-4 w-4"})}),(0,a.jsx)(I,{storeId:e.id,storeName:e.name,trigger:(0,a.jsx)(i.$,{variant:"outline",size:"sm",className:"bg-green-50 hover:bg-green-100 border-green-200",title:"Assign products",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})}),onAssign:U}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>W(e.id),className:"text-red-600 hover:text-red-700",disabled:u.filter(s=>$(s.storeId)===$(e.id)).length>0,children:(0,a.jsx)(D.A,{className:"h-4 w-4"})})]})})]},e.id))})]})}):(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(b.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"No stores found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:p?"Try adjusting your search criteria":"Create your first store to get started"}),!p&&(0,a.jsxs)(i.$,{onClick:()=>P(!0),children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Add Your First Store"]})]})})]}),(0,a.jsx)(B,{open:M,onClose:()=>Z(!1),store:H})]})})}},83209:(e,s,t)=>{"use strict";t.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>i});var a=t(95155),l=t(12115),r=t(25016);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});n.displayName="Card";let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...l})});i.displayName="CardHeader";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...l})});d.displayName="CardTitle";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...l})});c.displayName="CardDescription";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...l})});o.displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter"},90235:(e,s,t)=>{"use strict";t.d(s,{J:()=>c});var a=t(95155),l=t(12115),r=t(32894),n=t(83101),i=t(25016);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.b,{ref:s,className:(0,i.cn)(d(),t),...l})});c.displayName=r.b.displayName},96633:(e,s,t)=>{"use strict";t.d(s,{A0:()=>i,BF:()=>d,Gg:()=>c,Hj:()=>o,XI:()=>n,nA:()=>m,nd:()=>x});var a=t(95155),l=t(12115),r=t(25016);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,r.cn)("w-full caption-bottom text-sm",t),...l})})});n.displayName="Table";let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("thead",{ref:s,className:(0,r.cn)("[&_tr]:border-b",t),...l})});i.displayName="TableHeader";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,r.cn)("[&_tr:last-child]:border-0",t),...l})});d.displayName="TableBody";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l})});c.displayName="TableFooter";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tr",{ref:s,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...l})});o.displayName="TableRow";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("th",{ref:s,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l})});x.displayName="TableHead";let m=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("td",{ref:s,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l})});m.displayName="TableCell",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("caption",{ref:s,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",t),...l})}).displayName="TableCaption"}},e=>{e.O(0,[3194,6445,939,9989,832,8441,1255,7358],()=>e(e.s=80409)),_N_E=e.O()}]);