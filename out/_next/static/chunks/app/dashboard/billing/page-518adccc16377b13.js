(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3613],{309:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},6191:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},12140:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(12115);let n=(e,t)=>{let{interval:s=5e3,enabled:n=!0}=t||{},[r,l]=(0,a.useState)(void 0),[i,d]=(0,a.useState)(!0),[o,c]=(0,a.useState)(void 0),m=(0,a.useRef)(e);return(0,a.useEffect)(()=>{m.current=e},[e]),(0,a.useEffect)(()=>{if(!n)return void d(!1);let e=async()=>{d(!0);try{let e=await m.current();l(e),c(void 0)}catch(e){c(e),l(void 0)}finally{d(!1)}};e();let t=setInterval(()=>{e()},s);return()=>clearInterval(t)},[s,n]),{data:r,loading:i,error:o}}},18728:(e,t,s)=>{Promise.resolve().then(s.bind(s,86352))},21786:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},47507:(e,t,s)=>{"use strict";s.d(t,{bq:()=>h,eb:()=>f,gC:()=>p,l6:()=>c,yv:()=>m});var a=s(95155),n=s(12115),r=s(4729),l=s(24033),i=s(12108),d=s(5917),o=s(25016);let c=r.bL;r.YJ;let m=r.WT,h=n.forwardRef((e,t)=>{let{className:s,children:n,...i}=e;return(0,a.jsxs)(r.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[n,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=r.l9.displayName;let x=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...n,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...n,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});u.displayName=r.wn.displayName;let p=n.forwardRef((e,t)=>{let{className:s,children:n,position:l="popper",...i}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(x,{}),(0,a.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(u,{})]})})});p.displayName=r.UC.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...n})}).displayName=r.JU.displayName;let f=n.forwardRef((e,t)=>{let{className:s,children:n,...l}=e;return(0,a.jsxs)(r.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(r.p4,{children:n})]})});f.displayName=r.q7.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...n})}).displayName=r.wv.displayName},52179:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let a=s(95125).A.create({baseURL:"http://localhost:8080",withCredentials:!0});a.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(console.log("401 Unauthorized: Redirecting to login page."),localStorage.removeItem("adminLoggedIn"),localStorage.removeItem("adminUser"),window.location.href="/"),Promise.reject(e)));let n=a},54679:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>h,Es:()=>u,L3:()=>p,c7:()=>x,lG:()=>d,rr:()=>f,zM:()=>o});var a=s(95155),n=s(12115),r=s(93409),l=s(65229),i=s(25016);let d=r.bL,o=r.l9,c=r.ZL;r.bm;let m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n})});m.displayName=r.hJ.displayName;let h=n.forwardRef((e,t)=>{let{className:s,children:n,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(r.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[n,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.UC.displayName;let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};x.displayName="DialogHeader";let u=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};u.displayName="DialogFooter";let p=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...n})});p.displayName=r.hE.displayName;let f=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...n})});f.displayName=r.VY.displayName},57828:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},68267:(e,t,s)=>{"use strict";var a,n,r,l,i;function d(e,t,s,a){if("a"===s&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?a:"a"===s?a.call(e):a?a.value:t.get(e)}function o(e,t,s,a,n){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?n.call(e,s):n?n.value=s:t.set(e,s),s}s.d(t,{c3:()=>h,FW:()=>u,lA:()=>x,yw:()=>m}),"function"==typeof SuppressedError&&SuppressedError;let c="__TAURI_TO_IPC_KEY__";function m(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}class h{constructor(e){a.set(this,void 0),n.set(this,0),r.set(this,[]),l.set(this,void 0),o(this,a,e||(()=>{}),"f"),this.id=m(e=>{let t=e.index;if("end"in e)return void(t==d(this,n,"f")?this.cleanupCallback():o(this,l,t,"f"));let s=e.message;if(t==d(this,n,"f")){for(d(this,a,"f").call(this,s),o(this,n,d(this,n,"f")+1,"f");d(this,n,"f")in d(this,r,"f");){let e=d(this,r,"f")[d(this,n,"f")];d(this,a,"f").call(this,e),delete d(this,r,"f")[d(this,n,"f")],o(this,n,d(this,n,"f")+1,"f")}d(this,n,"f")===d(this,l,"f")&&this.cleanupCallback()}else d(this,r,"f")[t]=s})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){o(this,a,e,"f")}get onmessage(){return d(this,a,"f")}[(a=new WeakMap,n=new WeakMap,r=new WeakMap,l=new WeakMap,c)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[c]()}}async function x(e,t={},s){return window.__TAURI_INTERNALS__.invoke(e,t,s)}class u{get rid(){return d(this,i,"f")}constructor(e){i.set(this,void 0),o(this,i,e,"f")}async close(){return x("plugin:resources|close",{rid:this.rid})}}i=new WeakMap},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},76577:(e,t,s)=>{"use strict";async function a(e){return new Promise((t,s)=>{try{var a;let n=!1,r=document.createElement("iframe");r.style.position="fixed",r.style.right="0",r.style.bottom="0",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);let l=null==(a=r.contentWindow)?void 0:a.document;if(!l){document.body.removeChild(r),s(Error("Failed to access iframe document"));return}l.open(),l.write(e),l.close(),r.onload=()=>{if(!n){n=!0;try{var e,a;null==(e=r.contentWindow)||e.focus(),null==(a=r.contentWindow)||a.print(),setTimeout(()=>{r.parentNode&&document.body.removeChild(r),t()},1e3)}catch(e){r.parentNode&&document.body.removeChild(r),s(e)}}},setTimeout(()=>{if(!n){n=!0;try{r.contentWindow&&(r.contentWindow.focus(),r.contentWindow.print(),setTimeout(()=>{r.parentNode&&document.body.removeChild(r),t()},1e3))}catch(e){r.parentNode&&document.body.removeChild(r),s(e)}}},500)}catch(e){console.error("Print error:",e),s(e)}})}async function n(e){let{htmlContent:t,thermalContent:s,isThermalPrinter:n=!1,productIds:r,copies:l=1,useBackendPrint:i=!1,printerName:d,storeName:o}=e;if(i&&r&&r.length>0)try{let e="http://127.0.0.1:8080".replace(/\/+$/g,""),t={productIds:r,copies:l};d&&(t.printerName=d),o&&(t.storeName=o),console.log("\uD83D\uDCE4 Sending backend print request:",t);let s=await fetch("".concat(e,"/api/print-label"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json().catch(()=>({}));if(s.ok&&"success"===a.status)return void console.log("✅ Backend print succeeded:",a.message||"");console.warn("⚠️ Backend print returned non-success, falling back to browser print",a)}catch(e){console.error("❌ Error sending backend print request, falling back to browser print:",e)}if(t){console.log("\uD83D\uDDA8️ Using browser-based HTML printing"),await a(t);return}if(s){console.log("\uD83D\uDDA8️ Using browser-based thermal content printing");let e='<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Print</title>\n  <style>\n    body {\n      font-family: monospace;\n      white-space: pre-wrap;\n      margin: 0;\n      padding: 10mm;\n    }\n  </style>\n</head>\n<body><pre>'.concat(String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),"</pre></body>\n</html>");await a(e);return}throw Error("No printable content provided.")}s.d(t,{G:()=>n}),s(68267)},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>i});var a=s(95155),n=s(12115),r=s(25016);let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});i.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});d.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});o.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter"},86352:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var a=s(95155),n=s(12115),r=s(20063),l=s(10832),i=s(97003),d=s(12140),o=s(52179),c=s(33789),m=s(90235),h=s(83209),x=s(96633),u=s(54679),p=s(47507),f=s(67812),j=s(6191),g=s(71360);let y=(0,s(71847).A)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var v=s(86651),b=s(57828),N=s(309),w=s(53409),C=s(54664),A=s(21786),k=s(76577);function E(){var e;let t=(0,r.useRouter)(),[s,E]=(0,n.useState)(!1),[F,S]=(0,n.useState)(!1),[P,T]=(0,n.useState)(null),[I,R]=(0,n.useState)(""),[_,B]=(0,n.useState)(!1),[D,L]=(0,n.useState)(null),[z,M]=(0,n.useState)(""),[q,$]=(0,n.useState)(""),[J,O]=(0,n.useState)(""),[H,U]=(0,n.useState)([]),[W,G]=(0,n.useState)(""),[V,Y]=(0,n.useState)(1),[Z,Q]=(0,n.useState)(0),[X,K]=(0,n.useState)({gstin:"",taxPercentage:0,companyName:"",companyAddress:"",companyPhone:"",companyEmail:""}),[ee,et]=(0,n.useState)({}),[es,ea]=(0,n.useState)("A4");(0,n.useEffect)(()=>{if(localStorage.setItem("adminLoggedIn","true"),fetch("http://127.0.0.1:8080/api/settings").then(e=>e.json()).then(e=>{e.systemSettings&&K(e.systemSettings),e.billFormats&&et(e.billFormats)}).catch(e=>console.error("Failed to load system settings and bill formats:",e)),"true"!==localStorage.getItem("adminLoggedIn"))return void t.push("/")},[t]);let en=(0,n.useCallback)(async()=>(await o.A.get("/api/products")).data,[]),er=(0,n.useCallback)(async()=>(await o.A.get("/api/bills")).data.map(e=>({...e,date:e.timestamp,tax:e.taxAmount,status:e.status||"Paid"})),[]),{data:el,loading:ei,error:ed}=(0,d.A)(en,{interval:5e3}),{data:eo,loading:ec,error:em}=(0,d.A)(er,{interval:5e3});(0,n.useEffect)(()=>{ed&&console.error("Failed to load products:",ed),em&&console.error("Failed to load bills:",em)},[ed,em]);let eh=el||[],ex=eo||[],eu=()=>{let e=H.reduce((e,t)=>e+t.total,0),t=.1*e,s=e*Z/100;return{subtotal:e,tax:t,discountAmount:s,total:e+t-s}},ep=async()=>{if(!z||0===H.length)return;let{subtotal:e,tax:t,discountAmount:s,total:a}=eu(),n={id:Date.now().toString(),customerName:z,customerEmail:q,customerPhone:J,items:H,subtotal:e,tax:t,discountPercentage:Z,discountAmount:s,total:a,date:new Date().toISOString(),status:"Paid",companyName:X.companyName,companyAddress:X.companyAddress,companyPhone:X.companyPhone,companyEmail:X.companyEmail,gstin:X.gstin,billFormat:es};try{if(!(await fetch("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw Error("Failed to create bill");M(""),$(""),O(""),U([]),Q(0),E(!1)}catch(e){console.error("Error creating bill:",e),alert("Failed to create bill.")}},ef=async e=>{try{if(!(await o.A.delete("/api/bills/".concat(e))).status.toString().startsWith("2"))throw Error("Failed to delete bill")}catch(e){console.error("Error deleting bill:",e)}},ej=async e=>{let t=ee[e.billFormat||es]||ee.A4,s=((e,t)=>{let s=216===t.width&&279===t.height,a=210===t.width&&297===t.height,n=t.width<=80?"80mm":s?"216mm":a?"210mm":"".concat(t.width,"mm"),r=e.companyName||X.companyName,l=e.companyAddress||X.companyAddress,i=e.companyPhone||X.companyPhone,d=e.companyEmail||X.companyEmail,o=e.gstin||X.gstin;return"\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Invoice - ".concat(e.id,"</title>\n          <style>\n            @page {\n              size: ").concat(s?"letter":a?"A4":"".concat(t.width,"mm ").concat("auto"===t.height?"auto":"".concat(t.height,"mm")),";\n              margin: ").concat(t.margins.top,"mm ").concat(t.margins.right,"mm ").concat(t.margins.bottom,"mm ").concat(t.margins.left,"mm;\n            }\n            body {\n              font-family: 'Arial', sans-serif;\n              max-width: ").concat(n,';\n              margin: 0 auto;\n              font-size: 13px;\n              color: #000;\n            }\n            .header, .footer {\n              text-align: center;\n              padding: 10px 0;\n            }\n            .company-name {\n              font-size: 18px;\n              font-weight: bold;\n              text-transform: uppercase;\n            }\n            .invoice-title {\n              font-size: 16px;\n              font-weight: bold;\n              margin-top: 10px;\n            }\n            .section {\n              margin: 20px 0;\n            }\n            .section-title {\n              font-weight: bold;\n              border-bottom: 1px solid #ccc;\n              margin-bottom: 5px;\n            }\n            .row {\n              display: flex;\n              justify-content: space-between;\n              margin-bottom: 6px;\n            }\n            .items-table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-top: 15px;\n            }\n            .items-table th, .items-table td {\n              border: 1px solid #ccc;\n              padding: 6px 8px;\n              text-align: left;\n            }\n            .items-table th {\n              background-color: #f2f2f2;\n            }\n            .totals {\n              margin-top: 10px;\n              width: 100%;\n            }\n            .totals td {\n              padding: 6px;\n            }\n            .totals .label {\n              text-align: right;\n              font-weight: bold;\n            }\n            .totals .value {\n              text-align: right;\n              width: 100px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <div class="company-name">').concat(r,"</div>\n            <div>").concat(l,"</div>\n            <div>Phone: ").concat(i,"</div>\n            <div>Email: ").concat(d,'</div>\n            <div class="invoice-title">INVOICE</div>\n          </div>\n\n          <div class="section">\n            <div class="row">\n              <div><strong>Invoice ID:</strong> ').concat(e.id,"</div>\n              <div><strong>Date:</strong> ").concat(new Date(e.date).toLocaleString(),"</div>\n            </div>\n            ").concat(o?"<div><strong>GSTIN:</strong> ".concat(o,"</div>"):"","\n          </div>\n\n          ").concat(e.customerName||e.customerPhone?'\n          <div class="section">\n            <div class="section-title">Customer Details</div>\n            '.concat(e.customerName?"<div>Name: ".concat(e.customerName,"</div>"):"","\n            ").concat(e.customerPhone?"<div>Phone: ".concat(e.customerPhone,"</div>"):"","\n            ").concat(e.customerEmail?"<div>Email: ".concat(e.customerEmail,"</div>"):"","\n            ").concat(e.customerAddress?"<div>Address: ".concat(e.customerAddress,"</div>"):"","\n          </div>"):"",'\n\n          <div class="section">\n            <table class="items-table">\n              <thead>\n                <tr>\n                  <th>#</th>\n                  <th>Item</th>\n                  <th>Qty</th>\n                  <th>Rate</th>\n                  <th>Total</th>\n                </tr>\n              </thead>\n              <tbody>\n                ').concat(e.items.map((e,t)=>"\n                  <tr>\n                    <td>".concat(t+1,"</td>\n                    <td>").concat(e.productName,"</td>\n                    <td>").concat(e.quantity,"</td>\n                    <td>₹").concat(e.price.toFixed(2),"</td>\n                    <td>₹").concat(e.total.toFixed(2),"</td>\n                  </tr>\n                ")).join(""),'\n              </tbody>\n            </table>\n          </div>\n\n          <div class="section">\n            <table class="totals">\n              <tr>\n                <td class="label">Subtotal:</td>\n                <td class="value">₹').concat(e.subtotal.toFixed(2),"</td>\n              </tr>\n              ").concat(e.discountAmount>0?'<tr>\n                      <td class="label">Discount ('.concat(e.discountPercentage.toFixed(1),'%):</td>\n                      <td class="value">-₹').concat(e.discountAmount.toFixed(2),"</td>\n                    </tr>"):"",'\n              <tr>\n                <td class="label">Tax (').concat(X.taxPercentage,'%):</td>\n                <td class="value">₹').concat(e.tax.toFixed(2),'</td>\n              </tr>\n              <tr>\n                <td class="label">Total:</td>\n                <td class="value"><strong>₹').concat(e.total.toFixed(2),'</strong></td>\n              </tr>\n            </table>\n          </div>\n\n          <div class="footer">\n            <p>Thank you for your business!</p>\n          </div>\n        </body>\n      </html>\n    ')})(e,t);try{await (0,k.G)({htmlContent:s})}catch(e){console.error("Failed to send print job:",e),alert("Failed to print bill. Please check console for details.")}},eg=ex.filter(e=>{let t=e.customerName||"",s=e.id||"",a=I.toLowerCase();return t.toLowerCase().includes(a)||s.includes(a)}),{subtotal:ey,tax:ev,discountAmount:eb,total:eN}=eu(),ew=async()=>{if(!D)return;let e=new FileReader;e.onload=async e=>{try{var t;let s=JSON.parse(null==(t=e.target)?void 0:t.result);if(!(await o.A.post("/api/bills/import",s)).status.toString().startsWith("2"))throw Error("Failed to import bills");console.log("Bills imported successfully"),B(!1),L(null)}catch(e){console.error("Error parsing or importing bills:",e)}},e.readAsText(D)};return(0,a.jsx)(l.default,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Billing System"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create and manage bills with discount adjustments"}),(ei||ec)&&(0,a.jsx)("p",{className:"text-sm text-blue-500",children:"Loading data..."}),(ed||em)&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Error loading data."})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(u.lG,{open:_,onOpenChange:B,children:[(0,a.jsx)(u.zM,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"outline",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Import Bills"]})}),(0,a.jsxs)(u.Cf,{children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsx)(u.L3,{children:"Import Bills from JSON"}),(0,a.jsx)(u.rr,{children:"Upload a JSON file containing bill data."})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsx)(c.p,{id:"billFile",type:"file",accept:".json",onChange:e=>L(e.target.files?e.target.files[0]:null)})}),(0,a.jsxs)(u.Es,{children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),(0,a.jsx)(i.$,{onClick:()=>ew(),disabled:!D,children:"Import"})]})]})]}),(0,a.jsxs)(u.lG,{open:s,onOpenChange:E,children:[(0,a.jsx)(u.zM,{asChild:!0,children:(0,a.jsxs)(i.$,{children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Create Bill"]})}),(0,a.jsxs)(u.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsx)(u.L3,{children:"Create New Bill"}),(0,a.jsx)(u.rr,{children:"Enter customer details and add products to create a bill"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Customer Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"customerName",children:"Customer Name"}),(0,a.jsx)(c.p,{id:"customerName",value:z,onChange:e=>M(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"customerEmail",children:"Email (optional)"}),(0,a.jsx)(c.p,{id:"customerEmail",type:"email",value:q,onChange:e=>$(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"customerPhone",children:"Phone (optional)"}),(0,a.jsx)(c.p,{id:"customerPhone",value:J,onChange:e=>O(e.target.value)})]})]})]}),(0,a.jsx)(C.w,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Add Products"}),(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(m.J,{htmlFor:"product",children:"Select Product"}),(0,a.jsxs)(p.l6,{value:W,onValueChange:G,children:[(0,a.jsx)(p.bq,{children:(0,a.jsx)(p.yv,{placeholder:"Choose a product"})}),(0,a.jsx)(p.gC,{children:eh.map(e=>(0,a.jsxs)(p.eb,{value:e.id,children:[e.name," - ₹",e.price?e.price.toFixed(2):"0.00"]},e.id))})]})]}),(0,a.jsxs)("div",{className:"w-24",children:[(0,a.jsx)(m.J,{htmlFor:"quantity",children:"Quantity"}),(0,a.jsx)(c.p,{id:"quantity",type:"number",min:"1",value:V,onChange:e=>Y(Number.parseInt(e.target.value)||1)})]}),(0,a.jsx)(i.$,{onClick:()=>{if(!W)return;let e=eh.find(e=>e.id===W);if(!e)return;let t=void 0!==e.price&&null!==e.price?e.price:0,s=H.findIndex(e=>e.productId===W);if(s>=0){let e=[...H];e[s].quantity+=V,e[s].total=e[s].quantity*t,U(e)}else U([...H,{productId:e.id,productName:e.name,price:t,quantity:V,total:t*V}]);G(""),Y(1)},disabled:!W,children:"Add Item"})]})]}),H.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Bill Items"}),(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nd,{children:"Product"}),(0,a.jsx)(x.nd,{children:"Price"}),(0,a.jsx)(x.nd,{children:"Quantity"}),(0,a.jsx)(x.nd,{children:"Total"}),(0,a.jsx)(x.nd,{children:"Actions"})]})}),(0,a.jsx)(x.BF,{children:H.map(e=>(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nA,{children:e.productName}),(0,a.jsxs)(x.nA,{children:["₹",e.price.toFixed(2)]}),(0,a.jsx)(x.nA,{children:e.quantity}),(0,a.jsxs)(x.nA,{children:["₹",e.total.toFixed(2)]}),(0,a.jsx)(x.nA,{children:(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{var t;return t=e.productId,void U(H.filter(e=>e.productId!==t))},children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})})]},e.productId))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",ey.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{children:"Tax (10%):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",ev.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(m.J,{className:"flex items-center text-base",children:[(0,a.jsx)(y,{className:"h-4 w-4 mr-2"}),"Discount Percentage:"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.p,{type:"number",min:"0",max:"100",step:"0.1",value:Z.toFixed(1),onChange:e=>{Q(Math.max(0,Math.min(100,Number.parseFloat(e.target.value)||0)))},className:"w-20 text-right"}),(0,a.jsx)("span",{className:"text-sm",children:"%"})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Quick:"}),[5,10,15,20,25].map(e=>(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>Q(e),className:"text-xs h-7",children:[e,"%"]},e)),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>Q(0),className:"text-xs h-7",children:"Clear"})]}),Z>0&&(0,a.jsxs)("div",{className:"flex justify-between text-base text-red-600",children:[(0,a.jsxs)("span",{children:["Discount (",Z.toFixed(1),"%):"]}),(0,a.jsxs)("span",{className:"font-medium",children:["-₹",eb.toFixed(2)]})]})]}),(0,a.jsx)(C.w,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-xl font-bold",children:[(0,a.jsx)("span",{children:"Total:"}),(0,a.jsxs)("span",{children:["₹",eN.toFixed(2)]})]}),Z>0&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-sm text-green-600 font-medium",children:["Customer saves ₹",eb.toFixed(2)," (",Z.toFixed(1),"% discount)"]})})]})]})]}),(0,a.jsxs)(u.Es,{children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(i.$,{onClick:ep,disabled:!z||0===H.length,children:"Create Bill"})]})]})]})]})]}),(0,a.jsxs)(h.Zp,{children:[(0,a.jsxs)(h.aR,{children:[(0,a.jsx)(h.ZB,{children:"Bills History"}),(0,a.jsxs)(h.BT,{children:[ex.length," bills created"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(c.p,{placeholder:"Search bills...",value:I,onChange:e=>R(e.target.value),className:"max-w-sm"})]})]}),(0,a.jsx)(h.Wu,{children:eg.length>0?(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nd,{children:"Bill ID"}),(0,a.jsx)(x.nd,{children:"Customer"}),(0,a.jsx)(x.nd,{children:"Date"}),(0,a.jsx)(x.nd,{children:"Items"}),(0,a.jsx)(x.nd,{children:"Discount"}),(0,a.jsx)(x.nd,{children:"Total"}),(0,a.jsx)(x.nd,{children:"Status"}),(0,a.jsx)(x.nd,{children:"Actions"})]})}),(0,a.jsx)(x.BF,{children:eg.map(e=>{var t;return(0,a.jsxs)(x.Hj,{children:[(0,a.jsxs)(x.nA,{className:"font-mono",children:["#",e.id]}),(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.customerName||"N/A"}),e.customerEmail&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.customerEmail})]})}),(0,a.jsx)(x.nA,{children:new Date(e.date).toLocaleDateString()}),(0,a.jsxs)(x.nA,{children:[(null==(t=e.items)?void 0:t.length)||0," items"]}),(0,a.jsx)(x.nA,{children:e.discountPercentage>0?(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"text-red-600 font-medium",children:[e.discountPercentage.toFixed(1),"%"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["₹",e.discountAmount.toFixed(2)]})]}):(0,a.jsx)("span",{className:"text-gray-400",children:"No discount"})}),(0,a.jsxs)(x.nA,{className:"font-bold",children:["₹",e.total.toFixed(2)]}),(0,a.jsx)(x.nA,{children:(0,a.jsx)(f.E,{variant:"default",children:e.status})}),(0,a.jsx)(x.nA,{children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{T(e),S(!0)},children:(0,a.jsx)(b.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>ej(e),children:(0,a.jsx)(N.A,{className:"h-4 w-4"})}),(0,a.jsxs)(u.lG,{children:[(0,a.jsx)(u.zM,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"outline",size:"sm",children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(u.Cf,{children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsx)(u.L3,{children:"Are you sure?"}),(0,a.jsxs)(u.rr,{children:["This action cannot be undone. This will permanently delete the bill (",e.id,")."]})]}),(0,a.jsxs)(u.Es,{children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>{var e;return null==(e=document.querySelector('[data-state="open"]'))?void 0:e.click()},children:"Cancel"}),(0,a.jsx)(i.$,{variant:"destructive",onClick:()=>ef(e.id),children:"Delete"})]})]})]})]})})]},e.id)})})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(w.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium",children:"No bills found"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:I?"Try adjusting your search terms":"Create your first bill to get started"})]})})]}),(0,a.jsx)(u.lG,{open:F,onOpenChange:S,children:(0,a.jsxs)(u.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsx)(u.L3,{children:"Bill Details"}),(0,a.jsxs)(u.rr,{children:["Bill #",null==P?void 0:P.id]})]}),P&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:"Customer Information"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[(0,a.jsx)("div",{children:P.customerName||"N/A"}),P.customerEmail&&(0,a.jsx)("div",{children:P.customerEmail}),P.customerPhone&&(0,a.jsx)("div",{children:P.customerPhone})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:"Bill Information"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[(0,a.jsxs)("div",{children:["Date: ",new Date(P.date).toLocaleDateString()]}),(0,a.jsxs)("div",{children:["Status: ",P.status]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Items"}),(0,a.jsxs)(x.XI,{children:[(0,a.jsx)(x.A0,{children:(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nd,{children:"Product"}),(0,a.jsx)(x.nd,{children:"Price"}),(0,a.jsx)(x.nd,{children:"Qty"}),(0,a.jsx)(x.nd,{children:"Total"})]})}),(0,a.jsx)(x.BF,{children:(null==(e=P.items)?void 0:e.map((e,t)=>(0,a.jsxs)(x.Hj,{children:[(0,a.jsx)(x.nA,{children:e.productName}),(0,a.jsxs)(x.nA,{children:["₹",e.price.toFixed(2)]}),(0,a.jsx)(x.nA,{children:e.quantity}),(0,a.jsxs)(x.nA,{children:["₹",e.total.toFixed(2)]})]},t)))||[]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-right bg-gray-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsxs)("span",{children:["₹",P.subtotal.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Tax:"}),(0,a.jsxs)("span",{children:["₹",P.tax.toFixed(2)]})]}),P.discountPercentage>0&&(0,a.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,a.jsxs)("span",{children:["Discount (",P.discountPercentage.toFixed(1),"%):"]}),(0,a.jsxs)("span",{children:["-₹",P.discountAmount.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,a.jsx)("span",{children:"Total:"}),(0,a.jsxs)("span",{children:["₹",P.total.toFixed(2)]})]})]})]}),(0,a.jsxs)(u.Es,{children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>S(!1),children:"Close"}),P&&(0,a.jsxs)(i.$,{onClick:()=>ej(P),className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Print Bill"]})]})]})})]})})}},86651:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},90235:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(95155),n=s(12115),r=s(32894),l=s(83101),i=s(25016);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.b,{ref:t,className:(0,i.cn)(d(),s),...n})});o.displayName=r.b.displayName},96633:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>d,Gg:()=>o,Hj:()=>c,XI:()=>l,nA:()=>h,nd:()=>m});var a=s(95155),n=s(12115),r=s(25016);let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",s),...n})})});l.displayName="Table";let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",s),...n})});i.displayName="TableHeader";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",s),...n})});d.displayName="TableBody";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...n})});o.displayName="TableFooter";let c=n.forwardRef((e,t)=>{let{className:s,children:n,...l}=e;return(0,a.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...l,children:n})});c.displayName="TableRow";let m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...n})});m.displayName="TableHead";let h=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...n})});h.displayName="TableCell",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",s),...n})}).displayName="TableCaption"}},e=>{e.O(0,[3194,6445,939,9553,5125,832,8441,1255,7358],()=>e(e.s=18728)),_N_E=e.O()}]);