(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9926],{20120:(e,t,a)=>{"use strict";a.d(t,{$v:()=>g,EO:()=>h,Lt:()=>c,Rx:()=>f,Zr:()=>j,ck:()=>p,r7:()=>u,tv:()=>d,wd:()=>x});var s=a(95155),l=a(12115),r=a(52498),n=a(25016),i=a(97003);let c=r.bL,d=r.l9,o=r.ZL,m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});m.displayName=r.hJ.displayName;let h=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(m,{}),(0,s.jsx)(r.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});h.displayName=r.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};x.displayName="AlertDialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="AlertDialogFooter";let u=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...l})});u.displayName=r.hE.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...l})});g.displayName=r.VY.displayName;let f=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.rc,{ref:t,className:(0,n.cn)((0,i.r)(),a),...l})});f.displayName=r.rc.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.ZD,{ref:t,className:(0,n.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});j.displayName=r.ZD.displayName},32457:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>M});var s=a(95155),l=a(12115),r=a(73609),n=a(20063),i=a(85400),c=a(10832),d=a(97003),o=a(33789),m=a(90235),h=a(83209),x=a(67812),p=a(54679),u=a(47507),g=a(54664),f=a(20120),j=a(78874),b=a(6132),N=a(42529),v=a(16485),y=a(21786),w=a(39867),C=a(63581),k=a(6191),S=a(71360),P=a(26617),A=a(86651),F=a(309),E=a(11010),B=a(95261),L=a.n(B),D=a(76577);function T(e){let{products:t,isOpen:a,onClose:n,onPrintSuccess:i,storeName:c,forceBackendPrint:h=!1}=e,[x,g]=(0,l.useState)(1),[f,j]=(0,l.useState)(!1),[b,N]=(0,l.useState)({}),[v,y]=(0,l.useState)([]),[w,C]=(0,l.useState)(""),[k,S]=(0,l.useState)(!1),[P,A]=(0,l.useState)(81),[E,B]=(0,l.useState)(12),[T,I]=(0,l.useState)(2),[J,z]=(0,l.useState)(35),[$,R]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!a)return;let e=("http://127.0.0.1:8080".trim()||"").replace(/\/+$/,""),t="".concat(e,"/api/printers");(async()=>{try{let e=await fetch(t,{method:"GET"}),a=await e.json();if(e.ok&&"success"===a.status&&Array.isArray(a.printers))if(y(a.printers),a.printers.length>0){let e="SNBC TVSE LP46 Dlite BPLE";C(a.printers.includes(e)?e:a.printers[0])}else C("");else console.error("Failed to fetch printers:",(null==a?void 0:a.message)||"Unknown error")}catch(e){console.error("Error fetching printers:",e)}})()},[a]);let O=e=>{try{let t=document.createElement("canvas");return t.width=3.779528*P,t.height=3.779528*E,L()(t,e,{format:"CODE128",width:T,height:J,displayValue:$,margin:1,background:"#ffffff",lineColor:"#000000"}),t.toDataURL("image/png")}catch(t){return console.error("Failed to create barcode for ".concat(e,":"),t),null}};(0,l.useEffect)(()=>{if(a&&t.length>0){let e={};for(let a of t){let t=(0,r.n)(a)||a.id;e[a.id]=O(t)}N(e)}else a||N({})},[a,t,P,E,T,J,$]);let W=async()=>{if(0===t.length)return void alert("No products selected");j(!0);try{if(h||k){let e=t.map(e=>e.id);await (0,D.G)({useBackendPrint:!0,productIds:e,copies:x,printerName:w||void 0,storeName:c}),alert("Print job sent to backend."),i(),n();return}let a=[];for(let s of t){let t=(0,r.n)(s)||s.id,l=b[s.id]||"";for(let r=0;r<Math.max(1,x);r++){var e;a.push('\n            <div class="label" style="display:inline-block;vertical-align:top;width:'.concat(P,"mm;height:").concat(E,'mm;box-sizing:border-box;padding:4px;margin:4px;border:0;">\n              <div style="display:flex;flex-direction:row;height:100%;font-family:Arial,Helvetica,sans-serif;">\n                <div style="width:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:2mm;">\n                  ').concat(l?'<img src="'.concat(l,'" style="max-width:90%;height:auto;display:block;margin-bottom:2px;"/>'):"","\n                  ").concat($?'<div style="font-size:7px;font-weight:bold;text-align:center;">'.concat(M(t),"</div>"):"",'\n                </div>\n                <div style="width:50%;padding-left:2mm;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;">\n                  <div style="font-size:6px;font-weight:bold;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">').concat(M(c),'</div>\n                  <div style="font-size:7px;font-weight:bold;margin-top:2px;line-height:1.1;max-height:6mm;overflow:hidden;">Product Name: ').concat(M(s.name),'</div>\n                  <div style="font-size:7px;font-weight:bold;white-space:nowrap;margin-top:2px;">Price: ₹').concat((null!=(e=s.price)?e:0).toFixed(2),"</div>\n                </div>\n              </div>\n            </div>\n          "))}}let s='<!doctype html><html><head><meta charset="utf-8"><title>Labels</title><style>body{margin:8mm;font-family:Arial,Helvetica,sans-serif} @media print { @page { size: auto; margin: 0; } body{margin:0} .label{page-break-inside:avoid;} }</style></head><body>'.concat(a.join("\n"),"<script>window.onload=function(){window.print();setTimeout(()=>window.close(),300);};<\/script></body></html>");await (0,D.G)({htmlContent:s}),alert("Print dialog opened."),i(),n()}catch(e){alert("Error printing labels."),console.error(e)}finally{j(!1)}};function M(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/'/g,"&#039;")}return(0,s.jsx)(p.lG,{open:a,onOpenChange:n,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsxs)(p.L3,{className:"flex items-center",children:[(0,s.jsx)(F.A,{className:"h-5 w-5 mr-2"}),"Print Labels"]}),(0,s.jsx)(p.rr,{children:"Configure and preview labels for the selected products."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"copies",className:"text-base font-medium",children:"Copies per Product"}),(0,s.jsx)(o.p,{id:"copies",type:"number",min:"1",max:"100",value:x,onChange:e=>g(Number.parseInt(e.target.value)||1),className:"w-32"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Number of labels to print for each selected product."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{className:"text-base font-medium",children:"Label Dimensions (mm)"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(m.J,{htmlFor:"label-width",className:"sr-only",children:"Width"}),(0,s.jsx)(o.p,{id:"label-width",type:"number",min:"1",value:P,onChange:e=>A(Number.parseInt(e.target.value)||1),placeholder:"Width"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Width (mm)"})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(m.J,{htmlFor:"label-height",className:"sr-only",children:"Height"}),(0,s.jsx)(o.p,{id:"label-height",type:"number",min:"1",value:E,onChange:e=>B(Number.parseInt(e.target.value)||1),placeholder:"Height"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Height (mm)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"printer-select",className:"text-base font-medium",children:"Select Printer"}),(0,s.jsxs)(u.l6,{value:w,onValueChange:C,children:[(0,s.jsx)(u.bq,{id:"printer-select",className:"w-full",children:(0,s.jsx)(u.yv,{placeholder:"Select a printer"})}),(0,s.jsx)(u.gC,{children:v.map(e=>(0,s.jsx)(u.eb,{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsx)("input",{id:"direct-print",type:"checkbox",checked:k,onChange:e=>S(e.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,s.jsx)(m.J,{htmlFor:"direct-print",className:"text-sm font-medium",children:"Direct print (no browser dialog)"})]}),0===v.length&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:"No printers found. Ensure backend is running and printers are installed."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{className:"text-base font-medium",children:"Barcode Options"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(m.J,{htmlFor:"barcode-width",className:"sr-only",children:"Barcode Bar Width"}),(0,s.jsx)(o.p,{id:"barcode-width",type:"number",min:"1",max:"10",value:T,onChange:e=>I(Number.parseInt(e.target.value)||1),placeholder:"Bar Width"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Bar Width (px)"})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(m.J,{htmlFor:"barcode-height",className:"sr-only",children:"Barcode Height"}),(0,s.jsx)(o.p,{id:"barcode-height",type:"number",min:"10",max:"100",value:J,onChange:e=>z(Number.parseInt(e.target.value)||10),placeholder:"Height"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Barcode Height (px)"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsx)("input",{id:"display-value",type:"checkbox",checked:$,onChange:e=>R(e.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,s.jsx)(m.J,{htmlFor:"display-value",className:"text-sm font-medium",children:"Display Barcode Value"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-sm",children:"Printer Specifications (TVS LP 46 DLite)"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Layout:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:"Horizontal"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Barcode Type:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:"Code 128"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Total Labels:"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:t.length*x})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(m.J,{className:"text-base font-medium",children:"Label Preview"}),(0,s.jsx)("div",{className:"max-h-[500px] overflow-y-auto border rounded-lg p-3 bg-gray-50",children:0===t.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No products selected for preview."}):t.map(e=>(0,s.jsx)("div",{className:"mb-4 p-2 border rounded-md bg-white shadow-sm",style:{width:"".concat(P,"mm"),height:"".concat(E,"mm"),overflow:"hidden"},children:(0,s.jsxs)("div",{className:"label-container",style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",boxSizing:"border-box",fontSize:"6px",lineHeight:"1",height:"100%",width:"100%"},children:[(0,s.jsxs)("div",{className:"barcode-section",style:{width:"50%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:"2mm"},children:[b[e.id]&&(0,s.jsx)("img",{src:b[e.id]||"",alt:"Barcode for ".concat(e.name),className:"barcode-image",style:{height:"".concat(J/3.779528,"mm"),maxWidth:"90%",marginBottom:"0.5mm"}}),$&&(0,s.jsx)("div",{className:"barcode-number",style:{fontSize:"7px",fontWeight:"bold",textAlign:"center",letterSpacing:"0.2px"},children:(0,r.n)(e)||e.id})]}),(0,s.jsxs)("div",{className:"left-section",style:{width:"50%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",paddingLeft:"2mm"},children:[(0,s.jsx)("div",{className:"company-name",style:{fontSize:"6px",fontWeight:"bold",marginBottom:"0.5mm",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:c}),(0,s.jsxs)("div",{className:"product-name",style:{fontSize:"7px",fontWeight:"bold",marginBottom:"0.5mm",lineHeight:"1.1",maxHeight:"6mm",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",wordBreak:"break-word"},children:["Product Name: ",e.name]}),(0,s.jsxs)("div",{className:"price",style:{fontSize:"7px",fontWeight:"bold",whiteSpace:"nowrap"},children:["Price: ₹",e.price.toFixed(2)]})]})]})},e.id))})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(d.$,{type:"button",variant:"outline",onClick:n,disabled:f,children:"Cancel"}),(0,s.jsx)(d.$,{type:"button",className:"bg-blue-600 hover:bg-blue-700",onClick:W,disabled:f,children:f?"Printing...":"Print"})]})]})})}var I=a(8803);let J=e=>{let{onClick:t}=e;return(0,s.jsx)(d.$,{onClick:t,className:"fixed bottom-8 right-8 p-3 rounded-full shadow-lg bg-blue-600 hover:bg-blue-700 text-white z-50",size:"icon",children:(0,s.jsx)(I.A,{className:"h-6 w-6"})})};var z=a(20562);function $(e){let{onClick:t}=e;return(0,s.jsxs)(d.$,{variant:"outline",size:"sm",onClick:t,className:"flex items-center space-x-1",children:[(0,s.jsx)(z.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Scroll to Top"})]})}let R=e=>fetch("".concat("http://127.0.0.1:8080").concat(e)).then(e=>e.json()),O=e=>{let{isOpen:t,onOpenChange:a}=e,{mutate:r}=(0,i.Ay)("/api/batches",R),[n,c]=(0,l.useState)(""),[h,x]=(0,l.useState)(""),u=async()=>{if(n&&h)try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/batches"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batchNumber:n,place:h})})).ok)throw Error("Failed to add batch");r(),c(""),x(""),a(!1)}catch(e){console.error("Error adding batch:",e),alert("Failed to add batch.")}else alert("Please fill in both batch number and place.")};return(0,s.jsx)(p.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsx)(p.L3,{children:"Add New Batch"}),(0,s.jsx)(p.rr,{children:"Enter the batch number and place for the new batch."})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"batch-number",children:"Batch Number"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(o.p,{id:"batch-number",value:n,onChange:e=>c(e.target.value),placeholder:"e.g., btch-12dhei",className:"flex-1"}),(0,s.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>{let e=Math.random().toString(36).substring(2,8);c("btch-".concat(e))},children:[" ","Generate"]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"place",children:"Place"}),(0,s.jsx)(o.p,{id:"place",value:h,onChange:e=>x(e.target.value),placeholder:"e.g., Warehouse A"})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(d.$,{onClick:u,children:"Save Batch"})]})]})})},W=async e=>{try{let t=await fetch("".concat("http://127.0.0.1:8080").concat(e));if(!t.ok){let a=await t.json();throw console.error("API Error for ".concat(e,":"),a),Error("API request failed with status ".concat(t.status))}return t.json()}catch(t){throw console.error("Error fetching ".concat(e,":"),t),t}};function M(){var e,t;(0,n.useRouter)();let{data:a=[],error:B,isLoading:L,mutate:I}=(0,i.Ay)("/api/products",W),{data:z=[],error:R,isLoading:M,mutate:V}=(0,i.Ay)("/api/batches",W),G=(0,l.useMemo)(()=>a?a.map(e=>{var t,a,s,l;return{...e,barcodes:Array.isArray(e.barcodes)?e.barcodes:e.barcode?[e.barcode]:[],price:"number"==typeof e.price?e.price:Number(null!=(t=e.price)?t:0),displayPrice:null!=(l=null!=(s=null!=(a=e.sellingPrice)?a:e.selling_price)?s:e.price)?l:0}}):[],[a]);(0,l.useEffect)(()=>{console.log("SWR Products Data:",G),B&&console.error("SWR Products Error:",B),console.log("SWR Batches Data:",z),R&&console.error("SWR Batches Error:",R)},[G,B,z,R]);let H=(0,l.useRef)(null),[U,Z]=(0,l.useState)(null),[q,Y]=(0,l.useState)([]),[_,Q]=(0,l.useState)(""),[K,X]=(0,l.useState)("all"),[ee,et]=(0,l.useState)("all"),[ea,es]=(0,l.useState)({min:"",max:""}),[el,er]=(0,l.useState)("all"),[en,ei]=(0,l.useState)({min:"",max:""}),[ec,ed]=(0,l.useState)({from:"",to:""}),[eo,em]=(0,l.useState)(!1),[eh,ex]=(0,l.useState)(!1),[ep,eu]=(0,l.useState)(!1),[eg,ef]=(0,l.useState)(null),[ej,eb]=(0,l.useState)(!1),[eN,ev]=(0,l.useState)([]),[ey,ew]=(0,l.useState)([]),[eC,ek]=(0,l.useState)(!1),[eS,eP]=(0,l.useState)(new Date),[eA,eF]=(0,l.useState)(null),[eE,eB]=(0,l.useState)(!1),[eL,eD]=(0,l.useState)(!1),[eT,eI]=(0,l.useState)(null),[eJ,ez]=(0,l.useState)([]),[e$,eR]=(0,l.useState)(!1),[eO,eW]=(0,l.useState)(null),[eM,eV]=(0,l.useState)(!1);(0,l.useEffect)(()=>{eC&&eP(new Date)},[eC]);let eG=e=>{eF(e);let t=te[e9(e)]||[],a=[...new Set(t.map(e=>e.batchId).filter(Boolean))],s=z.filter(e=>a.includes(e.id));ez(s),0===s.length&&t.length>0?eB(!0):eR(!0)},[eH,eU]=(0,l.useState)({name:"",price:"",stock:"",sellingPrice:"",barcodes:[""],batchId:""}),[eZ,eq]=(0,l.useState)([]);(0,l.useEffect)(()=>{let e=localStorage.getItem("adminUser");if(e){let t=JSON.parse(e);if(Z(t),"billing_user"===t.role&&t.assignedStores){let e=localStorage.getItem("stores");e&&Y(JSON.parse(e).filter(e=>{var a;return(null==(a=t.assignedStores)?void 0:a.includes(e.id))&&"active"===e.status}))}}},[]);let eY=()=>{eU({name:"",price:"",stock:"",sellingPrice:"",barcodes:[""],batchId:""})},e_=()=>{eU(e=>({...e,barcodes:[...e.barcodes,""]}))},eQ=(e,t)=>{eU(a=>{let s=[...a.barcodes];return s[e]=t,{...a,barcodes:s}})},eK=e=>{eU(t=>{let a=t.barcodes.filter((t,a)=>a!==e);return{...t,barcodes:a.length>0?a:[""]}})},eX=()=>{let e=Date.now().toString(),t=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return"".concat(e).concat(t)},e0=e=>!!e&&""!==e.trim()&&e.length>=1&&e.length<=80,e1=async()=>{if(!eH.name||!eH.price||!eH.stock)return void alert("Please fill in all required fields");let e=eH.barcodes.filter(e=>""!==e.trim());if(0===e.length)return void alert("Please add at least one barcode.");for(let t of e){if(!e0(t))return void alert("Please enter a valid barcode (1-80 characters) for: ".concat(t));let e=G.find(e=>{var a;return null==(a=e.barcodes)?void 0:a.includes(t)});if(e)return void alert("Barcode already exists: ".concat(t," (Product: ").concat(e.name,")"))}let t={name:eH.name,price:Number.parseFloat(eH.price),stock:Number.parseInt(eH.stock),sellingPrice:Number.parseFloat(eH.sellingPrice),barcodes:e,batchId:eH.batchId};try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to add product");I(),eY(),ex(!1)}catch(e){console.error("Error adding product:",e),alert("Failed to add product.")}},e2=async()=>{if(!eg||!eH.name||!eH.price||!eH.stock)return void alert("Please fill in all required fields");let e=eH.barcodes.filter(e=>""!==e.trim());if(0===e.length)return void alert("Please add at least one barcode.");for(let t of e){if(!e0(t))return void alert("Please enter a valid barcode (1-80 characters) for: ".concat(t));let e=G.filter(e=>e.id!==eg.id).find(e=>{var a;return null==(a=e.barcodes)?void 0:a.includes(t)});if(e)return void alert("Barcode already exists: ".concat(t," (Product: ").concat(e.name,")"))}let t={name:eH.name,price:Number.parseFloat(eH.price),stock:Number.parseInt(eH.stock),sellingPrice:Number.parseFloat(eH.sellingPrice),barcodes:e,batchId:""===eH.batchId?void 0:eH.batchId};try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(eg.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to update product");I(),eY(),ef(null),eu(!1)}catch(e){console.error("Error updating product:",e),alert("Failed to update product.")}},e4=async e=>{try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete product");I()}catch(e){console.error("Error deleting product:",e),alert("Failed to delete product.")}},e5=e=>{ew(a.filter(t=>e.includes(t.id)).map(e=>({...e,barcodes:e.barcodes||[]}))),eb(!0)},e6=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let s=new FileReader;s.onload=async e=>{try{var t;let a=JSON.parse(null==(t=e.target)?void 0:t.result);if(Array.isArray(a)){for(let e of a)await fetch("".concat("http://127.0.0.1:8080","/api/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});I(),alert("Successfully imported ".concat(a.length," products"))}else alert("Invalid file format")}catch(e){alert("Error reading file")}},s.readAsText(a)},e3=(0,l.useMemo)(()=>["all",...new Set(a.map(e=>e.category).filter(Boolean))],[a]),e8=(0,l.useMemo)(()=>{console.log("Filtering products. Current products array:",a);let e=a.filter(e=>{var t;let a=_.toLowerCase(),s=""===_||e.name.toLowerCase().includes(a)||(()=>{let t=(0,r.n)(e);return!!t&&t.toLowerCase().includes(a)})(),l="all"===ee||"low"===ee&&e.stock<=5||"out"===ee&&0===e.stock||"available"===ee&&e.stock>5,n="all"===K||(null==(t=e.category)?void 0:t.toLowerCase())===K.toLowerCase(),i=Number(e.price)||0,c=ea.min?parseFloat(ea.min):0,d=ea.max?parseFloat(ea.max):1/0,o="all"===el||e.batchId===el,m=en.min?parseFloat(en.min):0,h=en.max?parseFloat(en.max):1/0,x=Number(e.sellingPrice)||0,p=!0;if(ec.from||ec.to){let t=e.createdAt?new Date(e.createdAt):null;if(t&&!isNaN(t.getTime())){let e=ec.from?new Date(ec.from):null,a=ec.to?new Date(ec.to):null;e&&(p=p&&t>=e),a&&(p=p&&t<=a)}else p=!1}return s&&l&&n&&i>=c&&i<=d&&o&&x>=m&&x<=h&&p});return console.log("Filtered Products:",e),e},[a,_,ee,K,ea,el,en,ec]),e7=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),e9=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},te=(0,l.useMemo)(()=>{let e={};for(let t of a){if(!(null==t?void 0:t.createdAt))continue;let a=new Date(t.createdAt);if(Number.isNaN(a.getTime()))continue;let s=a.toISOString().slice(0,10);(e[s]||(e[s]=[])).push(t)}return e},[a]),tt=(0,l.useMemo)(()=>{let e={};for(let t in te)e[t]=te[t].length;return e},[te]),ta=eA?e9(eA):"",ts=(e,t)=>{let a=0,s=0,l=e.map(e=>{var t,l;let r=z.find(t=>t.id===e.batchId),n=null!=(t=e.stock)?t:0,i=Number(null!=(l=e.price)?l:0),c=n*i;return a+=n,s+=c,'\n        <tr>\n          <td style="padding:6px;border:1px solid #ddd;">'.concat(e.barcodes&&e.barcodes.length>0?e.barcodes[0]:"N/A",'</td>\n          <td style="padding:6px;border:1px solid #ddd;">').concat(e.name,'</td>\n          <td style="padding:6px;border:1px solid #ddd;">').concat((null==r?void 0:r.batchNumber)||"N/A"," (").concat((null==r?void 0:r.place)||"N/A",')</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">').concat(n,'</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(i.toFixed(2),'</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(c.toFixed(2),"</td>\n        </tr>")}).join("");return'\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf-8" />\n          <title>Products on '.concat(t.toDateString(),'</title>\n          <style>\n            @media print {\n              @page { margin: 12mm; }\n              body { font-family: ui-sans-serif, system-ui, Arial, sans-serif; }\n              h1 { font-size: 18px; margin-bottom: 12px; }\n              table { width: 100%; border-collapse: collapse; }\n              th { background:#f3f4f6; }\n              tfoot { font-weight: bold; }\n              tfoot { display: table-footer-group; }\n              @page {\n                @bottom-right {\n                  content: "Page " counter(page) " of " counter(pages);\n                }\n              }\n            }\n            @media print {\n              tfoot {\n                display: table-row-group;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>Products on ').concat(t.toDateString(),'</h1>\n          <table>\n            <thead>\n              <tr>\n                <th style="padding:6px;border:1px solid #ddd; text-align:left;">Product Barcode Number</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:left;">Product Name</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:left;">Product Batch</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Stock</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Price</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Value (Total Value)</th>\n              </tr>\n            </thead>\n            <tbody>').concat(l,'</tbody>\n            <tfoot>\n              <tr>\n                <td colspan="3" style="padding:6px;border:1px solid #ddd; text-align:right;">Total:</td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;">').concat(a,'</td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;"></td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(s.toFixed(2),"</td>\n              </tr>\n            </tfoot>\n          </table>\n          <script>\n            // window.onload = function() { // Not needed for unifiedPrint\n            //   window.print();\n            //   setTimeout(function(){ window.close(); }, 300);\n            // };\n          <\/script>\n        </body>\n      </html>\n    ")};return(0,s.jsx)(c.default,{children:(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Product Management"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your inventory and product catalog"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(d.$,{variant:"outline",onClick:()=>ek(e=>!e),children:[(0,s.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Calendar"]}),eC&&(0,s.jsxs)("div",{className:"absolute right-0 z-50 mt-2 bg-white border rounded shadow-lg p-3 w-80",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>eP(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),children:"◀"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:eS.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>eP(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),children:"▶"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-7 text-[11px] text-gray-500 mb-1",children:[(0,s.jsx)("div",{className:"text-center",children:"Su"}),(0,s.jsx)("div",{className:"text-center",children:"Mo"}),(0,s.jsx)("div",{className:"text-center",children:"Tu"}),(0,s.jsx)("div",{className:"text-center",children:"We"}),(0,s.jsx)("div",{className:"text-center",children:"Th"}),(0,s.jsx)("div",{className:"text-center",children:"Fr"}),(0,s.jsx)("div",{className:"text-center",children:"Sa"})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:(()=>{let e=new Date(eS.getFullYear(),eS.getMonth(),1).getDay(),t=new Date(eS.getFullYear(),eS.getMonth()+1,0).getDate(),a=[];for(let t=0;t<e;t++)a.push((0,s.jsx)("div",{className:"h-8"},"b-".concat(t)));for(let e=1;e<=t;e++){var l;let t=new Date(eS.getFullYear(),eS.getMonth(),e),r=e9(t),n=null!=(l=tt[r])?l:0,i=e7(t,new Date),c="h-8 w-8 mx-auto flex items-center justify-center rounded-full cursor-pointer select-none ";i?c+="border-2 border-red-500 text-red-600 ":n>0?c+="bg-blue-100 text-blue-700 ":c+="text-gray-400 ",a.push((0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:c,title:n>0?"".concat(n," products"):"No products",onClick:()=>eG(t),children:e})},r))}return a})()}),eA&&(0,s.jsx)("div",{className:"mt-3 border-t pt-3",children:(0,s.jsxs)("div",{className:"text-sm mb-2",children:[(null!=(t=tt[ta])?t:0).toString()," products on ",eA.toDateString()]})}),(0,s.jsx)("div",{className:"mt-3 border-t pt-3 text-right",children:(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>ek(!1),children:"Close"})})]})]}),(0,s.jsx)("input",{type:"file",accept:".json",onChange:e6,className:"hidden",id:"import-products"}),(0,s.jsxs)(d.$,{variant:"outline",onClick:()=>{var e;return null==(e=document.getElementById("import-products"))?void 0:e.click()},children:[(0,s.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,s.jsxs)(d.$,{variant:"outline",onClick:()=>{let e="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a,null,2)),t="products_".concat(new Date().toISOString().split("T")[0],".json"),s=document.createElement("a");s.setAttribute("href",e),s.setAttribute("download",t),s.click()},children:[(0,s.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsxs)(d.$,{variant:"outline",onClick:()=>em(!0),children:[(0,s.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Filters"]}),(0,s.jsxs)(p.lG,{open:eh,onOpenChange:e=>{ex(e),eY(),eI(null)},children:[(0,s.jsx)(p.zM,{asChild:!0,children:(0,s.jsxs)(d.$,{className:"bg-blue-600 hover:bg-blue-700",children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Add Product"]})}),(0,s.jsxs)(p.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsx)(p.L3,{children:"Add New Product"}),(0,s.jsx)(p.rr,{children:"Create a new product with barcode information"})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"name",children:"Product Name *"}),(0,s.jsx)(o.p,{id:"name",value:eH.name,onChange:e=>{eU({...eH,name:e.target.value});let t=e.target.value.toLowerCase();eq(a.map(e=>e.name).filter(e=>e.toLowerCase().includes(t)&&e.toLowerCase()!==t).slice(0,5))},placeholder:"Enter product name",list:"product-name-suggestions"}),(0,s.jsx)("datalist",{id:"product-name-suggestions",children:eZ.map((e,t)=>(0,s.jsx)("option",{value:e},"".concat(e,"-").concat(t)))})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"price",children:"Price (₹) *"}),(0,s.jsx)(o.p,{id:"price",type:"number",min:"0",step:"0.01",value:eH.price,onChange:e=>eU({...eH,price:e.target.value}),placeholder:"0.00"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"stock",children:"Stock Quantity *"}),(0,s.jsx)(o.p,{id:"stock",type:"number",min:"0",value:eH.stock,onChange:e=>eU({...eH,stock:e.target.value}),placeholder:"0"})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"sellingPrice",children:"Selling Price (₹)"}),(0,s.jsx)(o.p,{id:"sellingPrice",type:"number",min:"0",step:"0.01",value:eH.sellingPrice,onChange:e=>eU({...eH,sellingPrice:e.target.value}),placeholder:"0.00"})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"batch",children:"Batch (Optional)"}),(0,s.jsxs)(u.l6,{value:eH.batchId||"",onValueChange:e=>{eU({...eH,batchId:e})},children:[(0,s.jsx)(u.bq,{id:"batch",children:(0,s.jsx)(u.yv,{placeholder:"Select a batch"})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"no-batch",children:"No Batch"})," ",z.map(e=>(0,s.jsx)(u.eb,{value:e.id,children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{children:e.place}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.batchNumber})]})},e.id)),(0,s.jsx)(g.w,{className:"my-2"}),(0,s.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>eD(!0),children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"New Batch"]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m.J,{children:"Barcodes *"}),(0,s.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:e_,children:[(0,s.jsx)(k.A,{className:"h-3 w-3 mr-1"}),"Add Barcode"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:eH.barcodes.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.p,{value:e,onChange:e=>eQ(t,e.target.value),placeholder:"Enter barcode or click generate",className:"flex-1"}),(0,s.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>eQ(t,eX()),children:"Generate"}),eH.barcodes.length>1&&(0,s.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>eK(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(S.A,{className:"h-3 w-3"})})]},t))})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>{ex(!1),eY()},children:"Cancel"}),(0,s.jsx)(d.$,{onClick:e1,children:"Add Product"})]})]})]}),(0,s.jsx)(O,{isOpen:eL,onOpenChange:eD})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsx)(h.Zp,{children:(0,s.jsx)(h.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(P.A,{className:"h-8 w-8 text-blue-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Products"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})]})})}),(0,s.jsx)(h.Zp,{children:(0,s.jsx)(h.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(N.A,{className:"h-8 w-8 text-green-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Stock"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:a.reduce((e,t)=>e+t.stock,0)})]})]})})}),(0,s.jsx)(h.Zp,{children:(0,s.jsx)(h.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(b.A,{className:"h-8 w-8 text-yellow-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Value of Inventory"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{let e=a.reduce((e,t)=>{var a,s,l;let r=Number(null!=(a=t.stock)?a:0),n=Number(null!=(l=null!=(s=t.sellingPrice)?s:t.price)?l:0);return isNaN(r)||isNaN(n)?(console.warn("Invalid stock or price for product ".concat(t.id,": stock=").concat(t.stock,", price=").concat(n)),e):e+r*n},0);return console.log("Calculated Total Inventory Value:",e.toFixed(2)),"₹".concat(e.toFixed(2))})()})]})]})})}),(0,s.jsx)(h.Zp,{children:(0,s.jsx)(h.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(j.A,{className:"h-8 w-8 text-red-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Out of Stock"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:a.filter(e=>0===e.stock).length})]})]})})})]}),(0,s.jsxs)(h.Zp,{children:[(0,s.jsx)(h.aR,{children:(0,s.jsx)(h.ZB,{children:"Product Catalog"})}),(0,s.jsxs)(h.Wu,{children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(A.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(o.p,{placeholder:"Search products or barcodes...",value:_,onChange:e=>Q(e.target.value),className:"pl-10"})]})}),(0,s.jsxs)(u.l6,{value:K,onValueChange:X,children:[(0,s.jsx)(u.bq,{className:"w-full md:w-48",children:(0,s.jsx)(u.yv,{placeholder:"Filter by category"})}),(0,s.jsx)(u.gC,{children:e3.map(e=>(0,s.jsx)(u.eb,{value:e,children:"all"===e?"All Categories":e},e))})]}),(0,s.jsxs)(u.l6,{value:ee,onValueChange:et,children:[(0,s.jsx)(u.bq,{className:"w-full md:w-48",children:(0,s.jsx)(u.yv,{placeholder:"Filter by stock"})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"all",children:"All Stock Levels"}),(0,s.jsx)(u.eb,{value:"available",children:"In Stock"}),(0,s.jsx)(u.eb,{value:"low",children:"Low Stock"}),(0,s.jsx)(u.eb,{value:"out",children:"Out of Stock"})]})]})]}),eN.length>0&&(0,s.jsx)("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-blue-700",children:[eN.length," product(s) selected"]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>e5(eN),children:[(0,s.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print Labels"]}),(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>ev([]),children:"Clear Selection"})]})]})}),(0,s.jsxs)("div",{className:"overflow-x-auto max-h-[500px] overflow-y-auto relative",ref:H,children:[(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left p-4",children:(0,s.jsx)("input",{type:"checkbox",checked:eN.length===e8.length&&e8.length>0,onChange:()=>{eN.length===e8.length?ev([]):ev(e8.map(e=>e.id))},className:"rounded"})}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Product"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Batch"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Price"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Selling Price"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Stock"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Barcodes"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Status"}),(0,s.jsx)("th",{className:"text-left p-4 font-medium",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e8.map(e=>{var t,a,l,n;let i=0===(n=e.stock)?{label:"Out of Stock",variant:"destructive",icon:j.A}:n<=5?{label:"Low Stock",variant:"secondary",icon:b.A}:{label:"In Stock",variant:"default",icon:N.A},c=i.icon,o=z.find(t=>t.id===e.batchId);return(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("input",{type:"checkbox",checked:eN.includes(e.id),onChange:()=>{var t;return t=e.id,void ev(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"rounded"})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"font-medium",children:e.name})})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:(null==o?void 0:o.batchNumber)||"N/A"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:(null==o?void 0:o.place)||""})]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("span",{className:"font-medium",children:["₹",Number(null!=(t=e.price)?t:0).toFixed(2)]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("span",{className:"font-medium",children:["₹",Number(null!=(l=null!=(a=e.sellingPrice)?a:e.selling_price)?l:0).toFixed(2)]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("span",{className:"font-medium",children:e.stock})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("div",{className:"space-y-1",children:(()=>{let t=(0,r.n)(e);return t?(0,s.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded block",children:t}):null})()})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)(x.E,{variant:i.variant,className:"flex items-center w-fit",children:[(0,s.jsx)(c,{className:"h-3 w-3 mr-1"}),i.label]})}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{ef(e),eU({name:e.name,price:e.price.toString(),stock:e.stock.toString(),sellingPrice:null!=e.sellingPrice?e.sellingPrice.toString():"",barcodes:Array.isArray(e.barcodes)&&e.barcodes.length>0?e.barcodes:[""],batchId:e.batchId||""}),eu(!0)},children:(0,s.jsx)(E.A,{className:"h-3 w-3"})}),(0,s.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>e5([e.id]),children:(0,s.jsx)(F.A,{className:"h-3 w-3"})}),(0,s.jsxs)(f.Lt,{children:[(0,s.jsx)(f.tv,{asChild:!0,children:(0,s.jsx)(d.$,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 bg-transparent",children:(0,s.jsx)(S.A,{className:"h-3 w-3"})})}),(0,s.jsxs)(f.EO,{children:[(0,s.jsxs)(f.wd,{children:[(0,s.jsx)(f.r7,{children:"Delete Product"}),(0,s.jsxs)(f.$v,{children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']})]}),(0,s.jsxs)(f.ck,{children:[(0,s.jsx)(f.Zr,{children:"Cancel"}),(0,s.jsx)(f.Rx,{onClick:()=>e4(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})})]},e.id)})})]}),0===e8.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(P.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"No products found"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:_||"all"!==K||"all"!==ee||""!==ea.min||""!==ea.max||"all"!==el||""!==en.min||""!==en.max||""!==ec.from||""!==ec.to?"Try adjusting your search or filters":"Get started by adding your first product"}),!_&&"all"===K&&"all"===ee&&(0,s.jsxs)(d.$,{onClick:()=>ex(!0),children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Add Your First Product"]})]})]}),e8.length>15&&(0,s.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,s.jsx)($,{onClick:()=>{var e;return null==(e=H.current)?void 0:e.scrollTo({top:0,behavior:"smooth"})}}),(0,s.jsx)(J,{onClick:()=>{var e;return null==(e=H.current)?void 0:e.scrollTo({top:H.current.scrollHeight,behavior:"smooth"})}})]})]})]}),(0,s.jsx)(p.lG,{open:eo,onOpenChange:em,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsx)(p.L3,{children:"Advanced Filters"}),(0,s.jsx)(p.rr,{children:"Refine your product search with additional criteria."})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{children:"Price Range (₹)"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)(o.p,{type:"number",placeholder:"Min",value:ea.min,onChange:e=>es({...ea,min:e.target.value})}),(0,s.jsx)(o.p,{type:"number",placeholder:"Max",value:ea.max,onChange:e=>es({...ea,max:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{children:"Batch"}),(0,s.jsxs)(u.l6,{value:el,onValueChange:er,children:[(0,s.jsx)(u.bq,{children:(0,s.jsx)(u.yv,{placeholder:"Select batch"})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"all",children:"All Batches"}),z.map(e=>(0,s.jsxs)(u.eb,{value:e.id,children:[e.batchNumber," (",e.place,")"]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{children:"Selling Price Range (₹)"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Min",value:en.min,onChange:e=>ei({...en,min:e.target.value})}),(0,s.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Max",value:en.max,onChange:e=>ei({...en,max:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{children:"Date Added"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)(o.p,{type:"date",value:ec.from,onChange:e=>ed({...ec,from:e.target.value})}),(0,s.jsx)(o.p,{type:"date",value:ec.to,onChange:e=>ed({...ec,to:e.target.value})})]})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>{es({min:"",max:""}),er("all"),ei({min:"",max:""}),ed({from:"",to:""})},children:"Reset All"}),(0,s.jsx)(d.$,{onClick:()=>em(!1),children:"Apply Filters"})]})]})}),(0,s.jsx)(p.lG,{open:e$,onOpenChange:eR,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsxs)(p.L3,{children:["Batches on ",eA?eA.toDateString():""]}),(0,s.jsx)(p.rr,{children:"Select a batch to view its products."})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:eJ.length>0?eJ.map(e=>(0,s.jsx)(h.Zp,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{eW(e),eV(!0)},children:(0,s.jsxs)(h.aR,{children:[(0,s.jsx)(h.ZB,{children:e.batchNumber}),(0,s.jsx)(h.BT,{children:e.place})]})},e.id)):(0,s.jsx)("p",{className:"text-center text-muted-foreground",children:"No batches found for this date."})}),(0,s.jsx)(p.Es,{children:(0,s.jsx)(d.$,{variant:"outline",onClick:()=>eR(!1),children:"Close"})})]})}),(0,s.jsx)(p.lG,{open:eM,onOpenChange:eV,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsxs)(p.L3,{children:["Products in Batch ",null==eO?void 0:eO.batchNumber," on ",eA?eA.toDateString():""]}),(0,s.jsx)(p.rr,{children:"Listed by product id, name, stock, and price."})]}),(()=>{let e=0,t=0,a=(te[ta]||[]).filter(e=>e.batchId===(null==eO?void 0:eO.id)).map(a=>{let l=z.find(e=>e.id===a.batchId),r=Number(a.stock)||0,n=Number(a.price)||0,i=r*n;return e+=r,t+=i,(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-2",children:a.barcodes&&a.barcodes.length>0?a.barcodes[0]:"N/A"}),(0,s.jsx)("td",{className:"p-2",children:a.name}),(0,s.jsxs)("td",{className:"p-2",children:[(null==l?void 0:l.batchNumber)||"N/A"," (",(null==l?void 0:l.place)||"N/A",")"]}),(0,s.jsx)("td",{className:"p-2 text-right",children:r}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",n.toFixed(2)]}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",i.toFixed(2)]})]},a.id)});return(0,s.jsx)("div",{className:"overflow-x-auto max-h-[calc(90vh-180px)] relative",ref:H,children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left p-2",children:"Product Barcode Number"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Product Name"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Product Batch"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Stock"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Price"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Value (Total Value)"})]})}),(0,s.jsxs)("tbody",{children:[a,(0,s.jsxs)("tr",{className:"font-bold border-t",children:[(0,s.jsx)("td",{colSpan:3,className:"p-2 text-right",children:"Total:"}),(0,s.jsx)("td",{className:"p-2 text-right",children:e}),(0,s.jsx)("td",{className:"p-2 text-right"}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",t.toFixed(2)]})]})]})]})})})(),(0,s.jsxs)(p.Es,{className:"mt-4 flex justify-end items-center space-x-2",children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>eV(!1),children:"Close"}),(0,s.jsxs)(d.$,{onClick:()=>{if(!eA||!eO)return;let e=ts((te[ta]||[]).filter(e=>e.batchId===eO.id),eA);(0,D.G)({htmlContent:e})},children:[(0,s.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print"]})]})]})}),(0,s.jsx)(p.lG,{open:eE,onOpenChange:eB,children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsxs)(p.L3,{children:["Products on ",eA?eA.toDateString():""]}),(0,s.jsx)(p.rr,{children:"Listed by product id, name, stock, and price."})]}),(()=>{let e=0,t=0,a=(te[ta]||[]).map(a=>{let l=z.find(e=>e.id===a.batchId),r=Number(a.stock)||0,n=Number(a.price)||0,i=r*n;return e+=r,t+=i,(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-2",children:a.barcodes&&a.barcodes.length>0?a.barcodes[0]:"N/A"}),(0,s.jsx)("td",{className:"p-2",children:a.name}),(0,s.jsxs)("td",{className:"p-2",children:[(null==l?void 0:l.batchNumber)||"N/A"," (",(null==l?void 0:l.place)||"N/A",")"]}),(0,s.jsx)("td",{className:"p-2 text-right",children:r}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",n.toFixed(2)]}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",i.toFixed(2)]})]},a.id)});return(0,s.jsx)("div",{className:"overflow-x-auto max-h-[calc(90vh-180px)] relative",ref:H,children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left p-2",children:"Product Barcode Number"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Product Name"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Product Batch"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Stock"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Price"}),(0,s.jsx)("th",{className:"text-right p-2",children:"Value (Total Value)"})]})}),(0,s.jsxs)("tbody",{children:[a,(0,s.jsxs)("tr",{className:"font-bold border-t",children:[(0,s.jsx)("td",{colSpan:3,className:"p-2 text-right",children:"Total:"}),(0,s.jsx)("td",{className:"p-2 text-right",children:e}),(0,s.jsx)("td",{className:"p-2 text-right"}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["₹",t.toFixed(2)]})]})]})]})})})(),(0,s.jsxs)(p.Es,{className:"mt-4 flex justify-end items-center space-x-2",children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>eB(!1),children:"Close"}),(0,s.jsxs)(d.$,{onClick:()=>{if(!eA)return;let e=ts(te[ta]||[],eA);(0,D.G)({htmlContent:e})},children:[(0,s.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print"]})]})]})}),(0,s.jsx)(T,{products:ey,isOpen:ej,onClose:()=>eb(!1),onPrintSuccess:()=>{ev([]),ew([])},storeName:(null==q||null==(e=q[0])?void 0:e.name)||"Siri Art Jewellers",forceBackendPrint:!0}),(0,s.jsx)(p.lG,{open:ep,onOpenChange:e=>{eu(e),e||(eY(),ef(null),eI(null))},children:(0,s.jsxs)(p.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(p.c7,{children:[(0,s.jsx)(p.L3,{children:"Edit Product"}),(0,s.jsx)(p.rr,{children:"Update product information and barcode details"})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"edit-name",children:"Product Name *"}),(0,s.jsx)(o.p,{id:"edit-name",value:eH.name,onChange:e=>{eU({...eH,name:e.target.value});let t=e.target.value.toLowerCase();eq(a.map(e=>e.name).filter(e=>e.toLowerCase().includes(t)&&e.toLowerCase()!==t).slice(0,5))},placeholder:"Enter product name",list:"product-name-suggestions-edit"}),(0,s.jsx)("datalist",{id:"product-name-suggestions-edit",children:eZ.map((e,t)=>(0,s.jsx)("option",{value:e},"".concat(e,"-").concat(t)))})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"edit-price",children:"Price (₹) *"}),(0,s.jsx)(o.p,{id:"edit-price",type:"number",min:"0",step:"0.01",value:eH.price,onChange:e=>eU({...eH,price:e.target.value}),placeholder:"0.00"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"edit-stock",children:"Stock Quantity *"}),(0,s.jsx)(o.p,{id:"edit-stock",type:"number",min:"0",value:eH.stock,onChange:e=>eU({...eH,stock:e.target.value}),placeholder:"0"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"edit-sellingPrice",children:"Selling Price (₹)"}),(0,s.jsx)(o.p,{id:"edit-sellingPrice",type:"number",min:"0",step:"0.01",value:eH.sellingPrice,onChange:e=>eU({...eH,sellingPrice:e.target.value}),placeholder:"0.00"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"edit-batch",children:"Batch (Optional)"}),(0,s.jsxs)(u.l6,{value:eH.batchId||"",onValueChange:e=>{eU({...eH,batchId:e})},children:[(0,s.jsx)(u.bq,{id:"edit-batch",children:(0,s.jsx)(u.yv,{placeholder:"Select a batch"})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"no-batch",children:"No Batch"})," ",z.map(e=>(0,s.jsx)(u.eb,{value:e.id,children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{children:e.place}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.batchNumber})]})},e.id)),(0,s.jsx)(g.w,{className:"my-2"}),(0,s.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>eD(!0),children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"New Batch"]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m.J,{children:"Barcodes *"}),(0,s.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:e_,children:[(0,s.jsx)(k.A,{className:"h-3 w-3 mr-1"}),"Add Barcode"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:eH.barcodes.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.p,{value:e,onChange:e=>eQ(t,e.target.value),placeholder:"Enter barcode or click generate",className:"flex-1"}),(0,s.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>eQ(t,eX()),children:"Generate"}),eH.barcodes.length>1&&(0,s.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>eK(t),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(S.A,{className:"h-3 w-3"})})]},t))})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(d.$,{variant:"outline",onClick:()=>{eu(!1),eY(),ef(null)},children:"Cancel"}),(0,s.jsx)(d.$,{onClick:e2,children:"Update Product"})]})]})})]})})}},47507:(e,t,a)=>{"use strict";a.d(t,{bq:()=>h,eb:()=>g,gC:()=>u,l6:()=>o,yv:()=>m});var s=a(95155),l=a(12115),r=a(4729),n=a(24033),i=a(12108),c=a(5917),d=a(25016);let o=r.bL;r.YJ;let m=r.WT,h=l.forwardRef((e,t)=>{let{className:a,children:l,...i}=e;return(0,s.jsxs)(r.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[l,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=r.l9.displayName;let x=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=r.wn.displayName;let u=l.forwardRef((e,t)=>{let{className:a,children:l,position:n="popper",...i}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,s.jsx)(x,{}),(0,s.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,s.jsx)(p,{})]})})});u.displayName=r.UC.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=r.JU.displayName;let g=l.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,s.jsxs)(r.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})}),(0,s.jsx)(r.p4,{children:l})]})});g.displayName=r.q7.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=r.wv.displayName},52319:(e,t,a)=>{Promise.resolve().then(a.bind(a,32457))},54679:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>h,Es:()=>p,L3:()=>u,c7:()=>x,lG:()=>c,rr:()=>g,zM:()=>d});var s=a(95155),l=a(12115),r=a(93409),n=a(65229),i=a(25016);let c=r.bL,d=r.l9,o=r.ZL;r.bm;let m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});m.displayName=r.hJ.displayName;let h=l.forwardRef((e,t)=>{let{className:a,children:l,...c}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(r.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[l,(0,s.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};x.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let u=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});u.displayName=r.hE.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})});g.displayName=r.VY.displayName},73609:(e,t,a)=>{"use strict";function s(e){if(e){if("string"==typeof e.barcode&&""!==e.barcode.trim())return e.barcode;if(Array.isArray(e.barcodes)&&e.barcodes.length>0){let t=e.barcodes.find(e=>"string"==typeof e&&""!==e.trim());if(t)return t}if("string"==typeof e.barcodes&&""!==e.barcodes.trim())return e.barcodes}}a.d(t,{n:()=>s})},76577:(e,t,a)=>{"use strict";async function s(e){return new Promise((t,a)=>{try{var s;let l=document.createElement("iframe");l.style.position="fixed",l.style.right="0",l.style.bottom="0",l.style.width="0",l.style.height="0",l.style.border="none",document.body.appendChild(l);let r=null==(s=l.contentWindow)?void 0:s.document;if(!r){document.body.removeChild(l),a(Error("Failed to access iframe document"));return}r.open(),r.write(e),r.close(),l.onload=()=>{try{var e,s;null==(e=l.contentWindow)||e.focus(),null==(s=l.contentWindow)||s.print(),setTimeout(()=>{l.parentNode&&document.body.removeChild(l),t()},1e3)}catch(e){l.parentNode&&document.body.removeChild(l),a(e)}},setTimeout(()=>{try{l.contentWindow&&(l.contentWindow.focus(),l.contentWindow.print(),setTimeout(()=>{l.parentNode&&document.body.removeChild(l),t()},1e3))}catch(e){l.parentNode&&document.body.removeChild(l),a(e)}},500)}catch(e){console.error("Print error:",e),a(e)}})}async function l(e){let{htmlContent:t,thermalContent:a,isThermalPrinter:l=!1,productIds:r,copies:n=1,useBackendPrint:i=!1,printerName:c,storeName:d}=e;if(i&&r&&r.length>0)try{let e="http://127.0.0.1:8080".replace(/\/+$/g,""),t={productIds:r,copies:n};c&&(t.printerName=c),d&&(t.storeName=d),console.log("\uD83D\uDCE4 Sending backend print request:",t);let a=await fetch("".concat(e,"/api/print-label"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await a.json().catch(()=>({}));if(a.ok&&"success"===s.status)return void console.log("✅ Backend print succeeded:",s.message||"");console.warn("⚠️ Backend print returned non-success, falling back to browser print",s)}catch(e){console.error("❌ Error sending backend print request, falling back to browser print:",e)}if(t){console.log("\uD83D\uDDA8️ Using browser-based HTML printing"),await s(t);return}if(a){console.log("\uD83D\uDDA8️ Using browser-based thermal content printing");let e='<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Print</title>\n  <style>\n    body {\n      font-family: monospace;\n      white-space: pre-wrap;\n      margin: 0;\n      padding: 10mm;\n    }\n  </style>\n</head>\n<body><pre>'.concat(String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),"</pre></body>\n</html>");await s(e);return}throw Error("No printable content provided.")}a.d(t,{G:()=>l}),a(68267)},83209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>i});var s=a(95155),l=a(12115),r=a(25016);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...l})});n.displayName="Card";let i=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...l})});i.displayName="CardHeader";let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...l})});c.displayName="CardTitle";let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...l})});d.displayName="CardDescription";let o=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...l})});o.displayName="CardContent",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter"},90235:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var s=a(95155),l=a(12115),r=a(32894),n=a(83101),i=a(25016);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.b,{ref:t,className:(0,i.cn)(c(),a),...l})});d.displayName=r.b.displayName}},e=>{e.O(0,[3194,6445,939,9553,749,5973,832,8441,1255,7358],()=>e(e.s=52319)),_N_E=e.O()}]);