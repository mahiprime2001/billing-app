(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9926],{20120:(e,t,a)=>{"use strict";a.d(t,{$v:()=>g,EO:()=>m,Lt:()=>c,Rx:()=>f,Zr:()=>j,ck:()=>x,r7:()=>p,tv:()=>d,wd:()=>u});var l=a(95155),s=a(12115),r=a(52498),n=a(25016),i=a(97003);let c=r.bL,d=r.l9,o=r.ZL,h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});h.displayName=r.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsxs)(o,{children:[(0,l.jsx)(h,{}),(0,l.jsx)(r.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});m.displayName=r.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};u.displayName="AlertDialogHeader";let x=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="AlertDialogFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...s})});p.displayName=r.hE.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});g.displayName=r.VY.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.rc,{ref:t,className:(0,n.cn)((0,i.r)(),a),...s})});f.displayName=r.rc.displayName;let j=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.ZD,{ref:t,className:(0,n.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});j.displayName=r.ZD.displayName},32457:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var l=a(95155),s=a(12115),r=a(73609),n=a(20063),i=a(85400),c=a(10832),d=a(97003),o=a(33789),h=a(90235),m=a(83209),u=a(67812),x=a(54679),p=a(47507),g=a(54664),f=a(20120),j=a(78874),b=a(6132),v=a(42529),N=a(16485),y=a(21786),w=a(39867),C=a(63581),S=a(6191),k=a(71360),P=a(26617),A=a(86651),F=a(309),D=a(11010),E=a(95261),L=a.n(E),T=a(76577);let B=[{id:"default-80x12",name:"Default 80x12 mm",widthMm:80,heightMm:12,barcodeWidth:2,barcodeHeight:35,barcodeDisplayValue:!1},{id:"dummy-small-label",name:"Dummy Small Label 60x20 mm",widthMm:60,heightMm:20,barcodeWidth:2,barcodeHeight:35,barcodeDisplayValue:!1}];function O(e){let{products:t,isOpen:a,onClose:n,onPrintSuccess:i,storeName:c,forceBackendPrint:m=!1,batches:u=[]}=e,[g,f]=(0,s.useState)(1),[j,b]=(0,s.useState)(!1),[v,N]=(0,s.useState)({}),[y,w]=(0,s.useState)([]),[C,S]=(0,s.useState)(""),[k,P]=(0,s.useState)(!1),[A,D]=(0,s.useState)(B[0].id),[E,O]=(0,s.useState)(80),[R,z]=(0,s.useState)(12),[J,M]=(0,s.useState)(2),[$,_]=(0,s.useState)(35),[H,I]=(0,s.useState)(!1),V=e=>{let a=t.find(t=>t.id===e);if(console.log("\uD83D\uDD0D Looking for batch info for product ".concat(e)),console.log("\uD83D\uDCE6 Product found:",a),console.log("\uD83C\uDD94 Product batchid:",null==a?void 0:a.batchid),console.log("\uD83D\uDCE6 All batches:",u),!(null==a?void 0:a.batchid))return console.log("❌ No batchid found for product ".concat(e)),null;let l=u.find(e=>e.id===a.batchid);if(console.log("\uD83D\uDD0D Looking for batch with id: ".concat(a.batchid)),console.log("\uD83D\uDCE6 Found batch:",l),!l)return console.log("❌ No batch found for id: ".concat(a.batchid)),null;let s={batchNumber:l.batchNumber,place:l.place};return console.log("✅ Batch info found:",s),s};(0,s.useEffect)(()=>{if(!a)return;let e="http://127.0.0.1:8080".trim().replace(/\/+$/,""),t="".concat(e,"/api/printers");(async()=>{try{let e=await fetch(t,{method:"GET"}),a=await e.json();if(e.ok&&"success"===a.status&&Array.isArray(a.printers)&&(w(a.printers),a.printers.length>0)){let e="SNBC TVSE LP46 Dlite BPLE";S(a.printers.includes(e)?e:a.printers[0])}}catch(e){console.error("Error fetching printers:",e)}})()},[a]);let W=e=>{try{let t=document.createElement("canvas");return t.width=3.779528*E,t.height=3.779528*R,L()(t,e,{format:"CODE128",width:J,height:$,displayValue:H,margin:1,background:"#ffffff",lineColor:"#000000"}),t.toDataURL("image/png")}catch(t){return console.error("Failed to create barcode for ".concat(e,":"),t),null}};(0,s.useEffect)(()=>{if(a&&t.length>0){let a={};for(let l of t){var e;let t=null!=(e=(0,r.n)(l))?e:"NO-BARCODE";a[l.id]=W(t)}N(a)}else a||N({})},[a,t,E,R,J,$,H]),(0,s.useEffect)(()=>{let e=B.find(e=>e.id===A);e&&(O(e.widthMm),z(e.heightMm),M(e.barcodeWidth),_(e.barcodeHeight),I(e.barcodeDisplayValue))},[A]);let U=async()=>{if(0===t.length)return void alert("No products selected");b(!0);try{if(m||k){let e=B.find(e=>e.id===A)||B[0],a=t.map(e=>{var t,a;let l=V(e.id);return{id:e.id,name:e.name,selling_price:null!=(t=e.sellingPrice)?t:0,barcode:null!=(a=(0,r.n)(e))?a:"NO-BARCODE",batchNumber:(null==l?void 0:l.batchNumber)||""}});await (0,T.G)({useBackendPrint:!0,labelData:a,copies:g,printerName:C||void 0,storeName:c,labelProfile:{id:e.id,name:e.name},labelDimensions:{widthMm:E,heightMm:R}}),alert("Print job sent to backend."),i(),n();return}let s=[];for(let n of t){var e,a,l;let t=null!=(e=(0,r.n)(n))?e:"NO-BARCODE",i=v[n.id];for(let e=0;e<Math.max(1,g);e++)s.push('\n            <div class="label" style="\n              display: inline-block;\n              vertical-align: top;\n              width: '.concat(E,"mm;\n              height: ").concat(R,'mm;\n              box-sizing: border-box;\n              padding: 4px;\n              margin: 4px;\n              border: 0;\n            ">\n              <div style="\n                display: flex;\n                flex-direction: row;\n                height: 100%;\n                font-family: Arial, Helvetica, sans-serif;\n              ">\n                <div style="\n                  width: 50%;\n                  display: flex;\n                  flex-direction: column;\n                  align-items: center;\n                  justify-content: center;\n                  padding-top: 2mm;\n                ">\n                  ').concat(i?'<img src="'.concat(i,'" style="max-width: 90%; height: auto; display: block; margin-bottom: 2px;" />'):"","\n                  ").concat(H?'<div style="font-size: 7px; font-weight: bold; text-align: center;">'.concat(q(t),"</div>"):"",'\n                </div>\n                <div style="\n                  width: 50%;\n                  padding-left: 2mm;\n                  display: flex;\n                  flex-direction: column;\n                  justify-content: center;\n                  align-items: flex-start;\n                ">\n                  <div style="\n                    font-size: 6px;\n                    font-weight: bold;\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                  ">').concat(q(c),'</div>\n                  <div style="\n                    font-size: 7px;\n                    font-weight: bold;\n                    margin-top: 2px;\n                    line-height: 1.1;\n                    max-height: 6mm;\n                    overflow: hidden;\n                  ">Product Name: ').concat(q(n.name),'</div>\n                  <div style="\n                    font-size: 7px;\n                    font-weight: bold;\n                    white-space: nowrap;\n                    margin-top: 2px;\n                  ">Batch: ').concat(q((null==(a=V(n.id))?void 0:a.batchNumber)||"N/A"),'</div>\n                  <div style="\n                    font-size: 7px;\n                    font-weight: bold;\n                    white-space: nowrap;\n                    margin-top: 2px;\n                  ">Price: ').concat((null!=(l=n.price)?l:0).toFixed(2),"</div>\n                </div>\n              </div>\n            </div>\n          "))}let d='<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Labels</title>\n  <style>\n    body { margin: 8mm; font-family: Arial, Helvetica, sans-serif; }\n    @media print {\n      page-size: auto;\n      margin: 0;\n      body { margin: 0; }\n      .label { page-break-inside: avoid; }\n    }\n  </style>\n</head>\n<body>\n  '.concat(s.join(""),"\n  <script>\n    window.onload = function() {\n      window.print();\n      setTimeout(window.close, 300);\n    }\n  <\/script>\n</body>\n</html>");await (0,T.G)({htmlContent:d}),alert("Print dialog opened."),i(),n()}catch(e){alert("Error printing labels."),console.error(e)}finally{b(!1)}};function q(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}return(0,l.jsx)(x.lG,{open:a,onOpenChange:n,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsxs)(x.L3,{className:"flex items-center",children:[(0,l.jsx)(F.A,{className:"h-5 w-5 mr-2"}),"Print Labels"]}),(0,l.jsx)(x.rr,{children:"Configure and preview labels for the selected products."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(h.J,{htmlFor:"copies",className:"text-base font-medium",children:"Copies per Product"}),(0,l.jsx)(o.p,{id:"copies",type:"number",min:1,max:100,value:g,onChange:e=>f(Number.parseInt(e.target.value)||1),className:"w-32"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.J,{htmlFor:"label-profile-select",className:"text-base font-medium",children:"Label Dimension Profile"}),(0,l.jsxs)(p.l6,{value:A,onValueChange:D,children:[(0,l.jsx)(p.bq,{id:"label-profile-select",children:(0,l.jsx)(p.yv,{placeholder:"Select a label profile"})}),(0,l.jsx)(p.gC,{children:B.map(e=>(0,l.jsx)(p.eb,{value:e.id,children:e.name},e.id))})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Active dimensions: ",E," mm x ",R," mm"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.J,{htmlFor:"printer-select",className:"text-base font-medium",children:"Select Printer"}),(0,l.jsxs)(p.l6,{value:C,onValueChange:S,children:[(0,l.jsx)(p.bq,{id:"printer-select",children:(0,l.jsx)(p.yv,{placeholder:"Select a printer"})}),(0,l.jsx)(p.gC,{children:y.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,l.jsx)("input",{id:"direct-print",type:"checkbox",checked:k,onChange:e=>P(e.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),(0,l.jsx)(h.J,{htmlFor:"direct-print",className:"text-sm font-medium",children:"Direct print (no browser dialog)"})]})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[(0,l.jsx)("h4",{className:"font-medium text-sm",children:"Total Labels"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:t.length*g})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.J,{className:"text-base font-medium mb-2",children:"Label Preview"}),(0,l.jsx)("div",{className:"max-h-[500px] overflow-y-auto border rounded-lg p-3 bg-gray-50",children:0===t.length?(0,l.jsx)("p",{className:"text-gray-500 text-sm",children:"No products selected."}):t.map(e=>{var t,a,s;return(0,l.jsx)("div",{className:"mb-4 p-2 border rounded-md bg-white shadow-sm",style:{width:"".concat(E,"mm"),height:"".concat(R,"mm"),overflow:"hidden"},children:(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100%",fontSize:"6px",lineHeight:1},children:[(0,l.jsxs)("div",{style:{width:"50%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:"2mm"},children:[v[e.id]&&(0,l.jsx)("img",{src:v[e.id],alt:"Barcode for ".concat(e.name),style:{maxWidth:"90%",height:"auto",marginBottom:"2px"}}),H&&(0,l.jsx)("div",{style:{fontSize:"7px",fontWeight:"bold",textAlign:"center"},children:null!=(a=(0,r.n)(e))?a:"NO-BARCODE"})]}),(0,l.jsxs)("div",{style:{width:"50%",paddingLeft:"2mm",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start"},children:[(0,l.jsx)("div",{style:{fontSize:"6px",fontWeight:"bold"},children:c}),(0,l.jsxs)("div",{style:{fontSize:"7px",fontWeight:"bold",marginTop:"2px",lineHeight:1.1,maxHeight:"6mm",overflow:"hidden"},children:["Product Name: ",e.name]}),(0,l.jsxs)("div",{style:{fontSize:"7px",fontWeight:"bold",marginTop:"2px"},children:["Batch: ",(null==(t=V(e.id))?void 0:t.batchNumber)||"N/A"]}),(0,l.jsxs)("div",{style:{fontSize:"7px",fontWeight:"bold",marginTop:"2px"},children:["Price: ",(null!=(s=e.sellingPrice)?s:0).toFixed(2)]})]})]})},e.id)})})]})]}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{type:"button",variant:"outline",onClick:n,disabled:j,children:"Cancel"}),(0,l.jsx)(d.$,{type:"button",onClick:U,disabled:j,className:"bg-blue-600 hover:bg-blue-700",children:j?"Printing...":"Print"})]})]})})}var R=a(8803);let z=e=>{let{onClick:t}=e;return(0,l.jsx)(d.$,{onClick:t,className:"fixed bottom-8 right-8 p-3 rounded-full shadow-lg bg-blue-600 hover:bg-blue-700 text-white z-50",size:"icon",children:(0,l.jsx)(R.A,{className:"h-6 w-6"})})};var J=a(20562);function M(e){let{onClick:t}=e;return(0,l.jsxs)(d.$,{variant:"outline",size:"sm",onClick:t,className:"flex items-center space-x-1",children:[(0,l.jsx)(J.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"Scroll to Top"})]})}let $=e=>fetch("".concat("http://127.0.0.1:8080").concat(e)).then(e=>e.json()),_=e=>{let{isOpen:t,onOpenChange:a}=e,{mutate:r}=(0,i.Ay)("/api/batches",$),[n,c]=(0,s.useState)(""),[m,u]=(0,s.useState)(""),p=async()=>{if(n&&m)try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/batches"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batchNumber:n,place:m})})).ok)throw Error("Failed to add batch");r(),c(""),u(""),a(!1)}catch(e){console.error("Error adding batch:",e),alert("Failed to add batch.")}else alert("Please fill in both batch number and place.")};return(0,l.jsx)(x.lG,{open:t,onOpenChange:a,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[425px]",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsx)(x.L3,{children:"Add New Batch"}),(0,l.jsx)(x.rr,{children:"Enter the batch number and place for the new batch."})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"batch-number",children:"Batch Number"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(o.p,{id:"batch-number",value:n,onChange:e=>c(e.target.value),placeholder:"e.g., btch-12dhei",className:"flex-1"}),(0,l.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>{let e=Math.random().toString(36).substring(2,8);c("btch-".concat(e))},children:[" ","Generate"]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"place",children:"Place"}),(0,l.jsx)(o.p,{id:"place",value:m,onChange:e=>u(e.target.value),placeholder:"e.g., Warehouse A"})]})]}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,l.jsx)(d.$,{onClick:p,children:"Save Batch"})]})]})})},H=async e=>{try{let t=await fetch("".concat("http://127.0.0.1:8080").concat(e));if(!t.ok){let a=await t.json();throw console.error("API Error for ".concat(e,":"),a),Error("API request failed with status ".concat(t.status))}return t.json()}catch(t){throw console.error("Error fetching ".concat(e,":"),t),t}};function I(){var e,t,a,E,L,B;(0,n.useRouter)();let{data:R=[],error:J,isLoading:$,mutate:I}=(0,i.Ay)("/api/products",H,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:5e3,refreshInterval:0}),{data:V=[],error:W,isLoading:U,mutate:q}=(0,i.Ay)("/api/batches",H,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:5e3,refreshInterval:0}),{data:Z=[],error:G,isLoading:Y}=(0,i.Ay)("/api/hsn-codes",H,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:1e4,refreshInterval:0}),Q=(0,s.useMemo)(()=>R&&0!==R.length?R.map(e=>{var t,a,l,s,r,n,i,c,d;return{...e,barcodes:"string"==typeof e.barcode&&""!==e.barcode.trim()?e.barcode.split(","):[],price:"number"==typeof e.price?e.price:Number(null!=(t=e.price)?t:0),sellingPrice:"number"==typeof e.sellingPrice?e.sellingPrice:Number(null!=(r=null!=(s=null!=(l=null!=(a=e.sellingPrice)?a:e.selling_price)?l:e.displayPrice)?s:e.price)?r:0),displayPrice:null!=(d=null!=(c=null!=(i=null!=(n=e.sellingPrice)?n:e.selling_price)?i:e.displayPrice)?c:e.price)?d:0,createdAt:e.createdAt||e.createdat||e.created_at}}).filter(e=>!e._deleted):[],[R]);(0,s.useEffect)(()=>{if(console.log("=== SWR Data Debug ==="),console.log("Products Data:",Q),console.log("Products Count:",Q.length),J&&console.error("SWR Products Error:",J),console.log("Batches Data:",V),console.log("Batches Count:",V.length),console.log("Batches:",JSON.stringify(V,null,2)),W&&console.error("SWR Batches Error:",W),Q.length>0&&V.length>0){let e=Q[0];console.log("First Product:",e),console.log("First Product batchid:",e.batchid),console.log("Found Batch for first product:",V.find(t=>t.id===e.batchid))}console.log("======================")},[Q,J,V,W]);let K=(0,s.useRef)(null),X=(0,s.useRef)(null),ee=(0,s.useRef)(null),[et,ea]=(0,s.useState)(null),[el,es]=(0,s.useState)([]),[er,en]=(0,s.useState)(""),[ei,ec]=(0,s.useState)("all"),[ed,eo]=(0,s.useState)("all"),[eh,em]=(0,s.useState)({min:"",max:""}),[eu,ex]=(0,s.useState)("all"),[ep,eg]=(0,s.useState)({min:"",max:""}),[ef,ej]=(0,s.useState)({from:"",to:""}),[eb,ev]=(0,s.useState)("all"),[eN,ey]=(0,s.useState)("all"),[ew,eC]=(0,s.useState)({min:"",max:""}),[eS,ek]=(0,s.useState)("newest"),[eP,eA]=(0,s.useState)({min:"",max:""}),[eF,eD]=(0,s.useState)("all"),[eE,eL]=(0,s.useState)({min:"",max:""}),[eT,eB]=(0,s.useState)({from:"",to:""}),[eO,eR]=(0,s.useState)("all"),[ez,eJ]=(0,s.useState)("all"),[eM,e$]=(0,s.useState)({min:"",max:""}),[e_,eH]=(0,s.useState)(!1),[eI,eV]=(0,s.useState)(!1),[eW,eU]=(0,s.useState)(!1),[eq,eZ]=(0,s.useState)(null),[eG,eY]=(0,s.useState)(!1),[eQ,eK]=(0,s.useState)([]),[eX,e0]=(0,s.useState)([]),[e2,e1]=(0,s.useState)(!1),[e4,e5]=(0,s.useState)(""),[e6,e8]=(0,s.useState)(!1),[e3,e7]=(0,s.useState)(new Date),[e9,te]=(0,s.useState)(null),[tt,ta]=(0,s.useState)(!1),[tl,ts]=(0,s.useState)(!1),[tr,tn]=(0,s.useState)(null),[ti,tc]=(0,s.useState)([]),[td,to]=(0,s.useState)([]),[th,tm]=(0,s.useState)(!1),[tu,tx]=(0,s.useState)(null),[tp,tg]=(0,s.useState)(!1),[tf,tj]=(0,s.useState)([]),tb=(0,s.useMemo)(()=>{let e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(l)},[]),tv=e=>e?e>tb?tb:e:"";(0,s.useEffect)(()=>{e6&&e7(new Date)},[e6]);let tN=e=>{te(e);let t=tQ[tY(e)]||[],a=t.filter(e=>e.batchid),l=t.filter(e=>!e.batchid),s=[...new Set(a.map(e=>e.batchid).filter(Boolean))],r=V.filter(e=>s.includes(e.id));tc(r),to(l),0===r.length&&l.length>0?(tj(l),ta(!0)):r.length>0||l.length>0?tm(!0):(tm(!1),ta(!1),te(null),tj([]))},[ty,tw]=(0,s.useState)({name:"",price:"",stock:"",sellingPrice:"",barcodes:[""],batchid:"",hsnCode:""}),[tC,tS]=(0,s.useState)([]),tk=e=>{var t,a,l=null!=(a=null!=(t=e.hsnCode)?t:e.hsnCodeId)?a:e.hsn_code_id;if(null==l)return"";let s=String(l).trim();return s&&"null"!==s&&"undefined"!==s?s:""},tP=e=>{tw(t=>({...t,hsnCode:e}))};(0,s.useEffect)(()=>{let e=localStorage.getItem("adminUser");if(e){let t=JSON.parse(e);if(ea(t),"billing_user"===t.role&&t.assignedStores){let e=localStorage.getItem("stores");e&&es(JSON.parse(e).filter(e=>{var a;return(null==(a=t.assignedStores)?void 0:a.includes(e.id))&&"active"===e.status}))}}},[]);let tA=()=>{tw({name:"",price:"",stock:"",sellingPrice:"",barcodes:[""],batchid:"",hsnCode:""})},tF=()=>{tw(e=>({...e,barcodes:[...e.barcodes,""]}))},tD=(e,t)=>{tw(a=>{let l=[...a.barcodes];return l[e]=t,{...a,barcodes:l}})},tE=e=>{tw(t=>{let a=t.barcodes.filter((t,a)=>a!==e);return{...t,barcodes:a.length>0?a:[""]}})},tL=()=>{let e=new Date,t=e.getFullYear().toString(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),s="".concat(t).concat(a).concat(l),r=Math.floor(1e5*Math.random()).toString().padStart(5,"0");return"".concat(s).concat(r)},tT=e=>!!e&&""!==e.trim()&&e.length>=1&&e.length<=80,tB=async()=>{if(!ty.name||!ty.price||!ty.stock)return void alert("Please fill in all required fields");let e=ty.barcodes.filter(e=>""!==e.trim());if(0===e.length)return void alert("Please add at least one barcode.");for(let t of e){if(!tT(t))return void alert("Please enter a valid barcode (1-80 characters) for: ".concat(t));let e=Q.find(e=>{var a;return null==(a=e.barcodes)?void 0:a.includes(t)});if(e)return void alert("Barcode already exists: ".concat(t," (Product: ").concat(e.name,")"))}let t={name:ty.name,price:Number.parseFloat(ty.price),stock:Number.parseInt(ty.stock),sellingPrice:Number.parseFloat(ty.sellingPrice),barcode:e.join(","),batchid:ty.batchid,hsnCode:(e=>{if(null==e)return;let t=String(e).trim();return""===t?void 0:t})(ty.hsnCode)};try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to add product");I(),tA(),eV(!1)}catch(e){console.error("Error adding product:",e),alert("Failed to add product.")}},tO=async()=>{if(!eq||!ty.name||!ty.price||!ty.stock)return void alert("Please fill in all required fields");let e=ty.barcodes.filter(e=>""!==e.trim());if(0===e.length)return void alert("Please add at least one barcode.");for(let t of e){if(!tT(t))return void alert("Please enter a valid barcode (1-80 characters) for: ".concat(t));let e=Q.filter(e=>e.id!==eq.id).find(e=>{var a;return null==(a=e.barcodes)?void 0:a.includes(t)});if(e)return void alert("Barcode already exists: ".concat(t," (Product: ").concat(e.name,")"))}let t={name:ty.name,price:Number.parseFloat(ty.price),stock:Number.parseInt(ty.stock),sellingPrice:Number.parseFloat(ty.sellingPrice),barcode:e.join(","),batchid:""===ty.batchid?void 0:ty.batchid,hsnCode:(e=>{if(null==e)return;let t=String(e).trim();return""===t?void 0:t})(ty.hsnCode)};try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(eq.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to update product");I(),tA(),eZ(null),eU(!1)}catch(e){console.error("Error updating product:",e),alert("Failed to update product.")}},tR=async e=>{I(R.filter(t=>t.id!==e),!1);try{if(!(await fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to delete product");await I()}catch(e){console.error("Error deleting product:",e),alert("Failed to delete product."),I()}},tz=async()=>{if(0===eQ.length)return;let e=[...eQ];if(!window.confirm("Are you sure you want to delete ".concat(e.length," selected product(s)? This action cannot be undone.")))return;let t=new Set(e);I(R.filter(e=>!t.has(e.id)),!1),eK([]);try{let t=(await Promise.allSettled(e.map(e=>fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}})))).filter(e=>"rejected"===e.status||"fulfilled"===e.status&&!e.value.ok);if(t.length>0)throw Error("Failed to delete ".concat(t.length," product(s)"));await I(),alert("Successfully deleted ".concat(e.length," product(s)"))}catch(e){console.error("Error deleting products in bulk:",e),alert("Failed to delete some products. Please try again."),I()}},tJ=async()=>{if(!e4||0===eQ.length)return void alert("Please enter an HSN code value and select products");let e=e4.trim();if(!e)return void alert("Please enter a valid HSN code");try{let t=eQ.map(t=>fetch("".concat("http://127.0.0.1:8080","/api/products/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({hsnCode:e})}));await Promise.all(t),I(),eK([]),e5(""),e1(!1),alert("Successfully updated HSN code for ".concat(eQ.length," products"))}catch(e){console.error("Error updating HSN code:",e),alert("Failed to update HSN code for some products")}},tM=e=>{e0(Q.filter(t=>e.includes(t.id)).map(e=>({...e,barcodes:"string"==typeof e.barcode&&""!==e.barcode.trim()?e.barcode.split(","):[]}))),eY(!0)},t$=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let l=new FileReader;l.onload=async e=>{try{var t;let a=JSON.parse(null==(t=e.target)?void 0:t.result);if(Array.isArray(a)){for(let e of a)await fetch("".concat("http://127.0.0.1:8080","/api/products"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});I(),alert("Successfully imported ".concat(a.length," products"))}else alert("Invalid file format")}catch(e){alert("Error reading file")}},l.readAsText(a)},t_=()=>{eA(eh),eD(eu),eL(ep),eB(ef),eR(eb),eJ(eN),e$(ew)},tH=(0,s.useMemo)(()=>new Map(Z.map(e=>[String(e.id),e])),[Z]),tI=(0,s.useMemo)(()=>new Map(V.map(e=>[e.id,e])),[V]);(0,s.useEffect)(()=>{let e=X.current,t=K.current,a=ee.current;if(!e||!t||!a)return;let l=e.firstElementChild;if(!l)return;let s=!1,r=()=>{l.style.width="".concat(a.scrollWidth,"px")},n=()=>{s||(s=!0,t.scrollLeft=e.scrollLeft,s=!1)},i=()=>{s||(s=!0,e.scrollLeft=t.scrollLeft,s=!1)};r(),e.addEventListener("scroll",n,{passive:!0}),t.addEventListener("scroll",i,{passive:!0});let c="undefined"!=typeof ResizeObserver?new ResizeObserver(r):null;return c&&c.observe(a),window.addEventListener("resize",r),()=>{e.removeEventListener("scroll",n),t.removeEventListener("scroll",i),null==c||c.disconnect(),window.removeEventListener("resize",r)}},[Q.length,$]);let tV=(0,s.useMemo)(()=>[...Q.filter(e=>{var t,a,l,s,n,i,c,d,o,h,m,u,x,p;let g=er.toLowerCase(),f=e.batchid?tI.get(e.batchid):void 0,j="".concat(null!=(l=null==f?void 0:f.batchNumber)?l:""," ").concat(null!=(s=null==f?void 0:f.place)?s:"").toLowerCase(),b=((0,r.n)(e)||"").toLowerCase(),v=tk(e),N=((null==(t=tH.get(v))?void 0:t.hsnCode)||v).toLowerCase(),y=!g||("name"===ei?e.name.toLowerCase().includes(g):"barcode"===ei?b.includes(g):"batch"===ei?j.includes(g):"hsn"===ei?N.includes(g):e.name.toLowerCase().includes(g)||b.includes(g)||j.includes(g)||N.includes(g)),w=Number(null!=(n=e.stock)?n:0),C="all"===ed||"low"===ed&&w>0&&w<=5||"out"===ed&&0===w||"available"===ed&&w>5,S=Number(e.price)||0,k=""!==eh.min?parseFloat(eh.min):-1/0,P=""!==eh.max?parseFloat(eh.max):1/0,A=void 0!==e.batchid&&null!==e.batchid?String(e.batchid):"",F="all"===eu||A===String(eu),D=!!e.batchid,E="all"===eN||"with-batch"===eN&&D||"without-batch"===eN&&!D,L=""!==ep.min?parseFloat(ep.min):-1/0,T=""!==ep.max?parseFloat(ep.max):1/0,B=Number(null!=(o=null!=(d=null!=(c=null!=(i=e.sellingPrice)?i:e.selling_price)?c:e.displayPrice)?d:e.price)?o:0)||0,O=!0;if(ef.from||ef.to){let t=null!=(u=null!=(m=null!=(h=e.createdAt)?h:e.createdat)?m:e.created_at)?u:null,a=null===t?null:new Date("number"==typeof t?t:String(t));if(a&&!isNaN(a.getTime())){let e=ef.from?new Date("".concat(ef.from,"T00:00:00.000")):null,t=ef.to?new Date("".concat(ef.to,"T23:59:59.999")):null;e&&(O=O&&a>=e),t&&(O=O&&a<=t)}else O=!1}let R="all"===eb||"none"===eb&&""===v.trim()||v===eb,z=Number(null!=(p=null!=(x=null==(a=tH.get(v))?void 0:a.tax)?x:e.tax)?p:0),J=ew.min?parseFloat(ew.min):0,M=ew.max?parseFloat(ew.max):1/0;return y&&C&&S>=k&&S<=P&&F&&E&&B>=L&&B<=T&&O&&R&&z>=J&&z<=M})].sort((e,t)=>{var a,l,s,r;let n=e.createdAt?new Date(e.createdAt).getTime():0,i=t.createdAt?new Date(t.createdAt).getTime():0,c=e.name.toLowerCase(),d=t.name.toLowerCase(),o=Number(null!=(a=e.stock)?a:0),h=Number(null!=(l=t.stock)?l:0),m=Number(null!=(s=e.price)?s:0),u=Number(null!=(r=t.price)?r:0);return"oldest"===eS?n-i:"name_asc"===eS?c.localeCompare(d):"name_desc"===eS?d.localeCompare(c):"stock_desc"===eS?h-o:"price_asc"===eS?m-u:"price_desc"===eS?u-m:i-n}),[Q,er,ei,ed,eh,eu,eN,ep,ef,eb,ew,eS,tH,tI]),tW=(0,s.useMemo)(()=>{let e=tV.reduce((e,t)=>{var a,l,s,r,n;let i=Number(null!=(a=t.stock)?a:0),c=Number(null!=(n=null!=(r=null!=(s=null!=(l=t.sellingPrice)?l:t.selling_price)?s:t.displayPrice)?r:t.price)?n:0);return isNaN(i)||isNaN(c)?(console.warn("Invalid stock or selling price for product ".concat(t.id,": stock=").concat(t.stock,", sellingPrice=").concat(c)),e):e+i*c},0);return console.log("Calculated Total Selling Value:",e.toFixed(2)),e.toFixed(2)},[tV]),tU=(0,s.useMemo)(()=>{let e=tV.reduce((e,t)=>{var a,l;let s=Number(null!=(a=t.stock)?a:0),r=Number(null!=(l=t.price)?l:0);return isNaN(s)||isNaN(r)?(console.warn("Invalid stock or cost price for product ".concat(t.id,": stock=").concat(t.stock,", costPrice=").concat(r)),e):e+s*r},0);return console.log("Calculated Total Cost Value:",e.toFixed(2)),e.toFixed(2)},[tV]),tq=(0,s.useMemo)(()=>tV.reduce((e,t)=>{var a;return e+Number(null!=(a=t.stock)?a:0)},0),[tV]),tZ=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),tG=e=>{if(!e)return"";let t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),l=e.getFullYear();return"".concat(t,"/").concat(a,"/").concat(l)},tY=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(l)},tQ=(0,s.useMemo)(()=>{let e={};for(let t of Q){let a=(null==t?void 0:t.createdAt)||(null==t?void 0:t.createdat);if(!a){console.log("Product missing createdAt:",t);continue}let l=new Date(a);if(Number.isNaN(l.getTime())){console.log("Invalid date for product:",t,"createdAt:",a);continue}let s=l.toISOString().slice(0,10);e[s]=[...e[s]||[],t]}return console.log("Final productsByDate map:",e),e},[Q]),tK=(0,s.useMemo)(()=>{let e={};for(let t in tQ)e[t]=tQ[t].length;return e},[tQ]),tX=e9?tY(e9):"",t0=(e,t,a,l)=>{var s;let r=0,n=0,i=e.map(e=>{var t,a;let l=null!=(t=e.stock)?t:0,s=Number(null!=(a=e.price)?a:0),i=l*s;r+=l,n+=i;let c=e.barcode&&""!==e.barcode.trim()?e.barcode.split(",").map(e=>'<span style="display:block;">'.concat(e,"</span>")).join(""):"N/A";return'\n        <tr>\n          <td style="padding:6px;border:1px solid #ddd;">'.concat(c,'</td>\n          <td style="padding:6px;border:1px solid #ddd;">').concat(e.name,'</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">').concat(l,'</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(s.toFixed(2),'</td>\n          <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(i.toFixed(2),"</td>\n        </tr>")}).join(""),c=(null!=(s=null==l?void 0:l.printedAt)?s:new Date).toLocaleString(),d='\n      <div style="font-size:8px; margin-bottom:8px; border:1px solid #ddd; padding:6px;">\n        <div><strong>Batch ID:</strong> '.concat((null==l?void 0:l.batchId)||"N/A","</div>\n        <div><strong>Batch Name:</strong> ").concat((null==l?void 0:l.batchName)||"N/A","</div>\n        <div><strong>Batch Place:</strong> ").concat((null==l?void 0:l.batchPlace)||"N/A","</div>\n        <div><strong>Date:</strong> ").concat(tG(t),"</div>\n        <div><strong>Printed At:</strong> ").concat(c,"</div>\n      </div>\n    ");return'\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf-8" />\n          <title>Products on '.concat(tG(t),'</title>\n          <style>\n            @media print {\n              @page { margin: 12mm; }\n              body { font-family: ui-sans-serif, system-ui, Arial, sans-serif; font-size: 8px; line-height: 1.25; }\n              h1 { font-size: 10px; margin-bottom: 8px; }\n              table { width: 100%; border-collapse: collapse; }\n              th, td { font-size: 8px; padding: 4px !important; }\n              th { background:#f3f4f6; }\n              tfoot { font-weight: bold; }\n              tfoot { display: table-footer-group; }\n              @page {\n                @bottom-right {\n                  content: "Page " counter(page) " of " counter(pages);\n                }\n              }\n            }\n            @media print {\n              tfoot {\n                display: table-row-group;\n              }\n            }\n          </style>\n        </head>\n        <body>\n      <h1>Products on ').concat(tG(t),"</h1>\n          ").concat(a?'<p style="font-size: 8px; margin-bottom: 6px;">Store: '.concat(a,"</p>"):"","\n          ").concat(d,'\n          <table>\n            <thead>\n              <tr>\n                <th style="padding:6px;border:1px solid #ddd; text-align:left;">Product Barcode Number</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:left;">Product Name</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Stock</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Price</th>\n                <th style="padding:6px;border:1px solid #ddd; text-align:right;">Value (Total Value)</th>\n              </tr>\n            </thead>\n            <tbody>').concat(i,'</tbody>\n            <tfoot>\n              <tr>\n                <td colspan="2" style="padding:6px;border:1px solid #ddd; text-align:right;">Total:</td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;">').concat(r,'</td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;"></td>\n                <td style="padding:6px;border:1px solid #ddd; text-align:right;">₹').concat(n.toFixed(2),"</td>\n              </tr>\n            </tfoot>\n          </table>\n          <script>\n            // window.onload = function() { // Not needed for unifiedPrint\n            //   window.print();\n            //   setTimeout(function(){ window.close(); }, 300);\n            // };\n          <\/script>\n        </body>\n      </html>\n    ")};return(0,l.jsx)(c.default,{children:(0,l.jsxs)("div",{className:"w-full min-w-0 space-y-8",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Product Management"}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your inventory and product catalog"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)(d.$,{variant:"outline",onClick:()=>e8(e=>!e),children:[(0,l.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Calendar"]}),e6&&(0,l.jsxs)("div",{className:"absolute right-0 z-50 mt-2 bg-white border rounded shadow-lg p-3 w-80",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>e7(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),children:"◀"}),(0,l.jsx)("div",{className:"text-sm font-medium",children:e3.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>e7(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),children:"▶"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-7 text-[11px] text-gray-500 mb-1",children:[(0,l.jsx)("div",{className:"text-center",children:"Su"}),(0,l.jsx)("div",{className:"text-center",children:"Mo"}),(0,l.jsx)("div",{className:"text-center",children:"Tu"}),(0,l.jsx)("div",{className:"text-center",children:"We"}),(0,l.jsx)("div",{className:"text-center",children:"Th"}),(0,l.jsx)("div",{className:"text-center",children:"Fr"}),(0,l.jsx)("div",{className:"text-center",children:"Sa"})]}),(0,l.jsx)("div",{className:"grid grid-cols-7 gap-1",children:(()=>{let e=new Date(e3.getFullYear(),e3.getMonth(),1).getDay(),t=new Date(e3.getFullYear(),e3.getMonth()+1,0).getDate(),a=[];for(let t=0;t<e;t++)a.push((0,l.jsx)("div",{className:"h-8"},"b-".concat(t)));for(let e=1;e<=t;e++){var s;let t=new Date(e3.getFullYear(),e3.getMonth(),e),r=tY(t),n=null!=(s=tK[r])?s:0,i=tZ(t,new Date),c="h-8 w-8 mx-auto flex items-center justify-center rounded-full cursor-pointer select-none ";i?c+="border-2 border-red-500 text-red-600 ":n>0?c+="bg-blue-100 text-blue-700 ":c+="text-gray-400 ",a.push((0,l.jsx)("div",{className:"flex items-center justify-center",children:(0,l.jsx)("div",{className:c,title:n>0?"".concat(n," products"):"No products",onClick:()=>tN(t),children:e})},r))}return a})()}),e9&&(0,l.jsx)("div",{className:"mt-3 border-t pt-3",children:(0,l.jsxs)("div",{className:"text-sm mb-2",children:[(null!=(E=tK[tX])?E:0).toString()," products on ",tG(e9)]})}),(0,l.jsx)("div",{className:"mt-3 border-t pt-3 text-right",children:(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>e8(!1),children:"Close"})})]})]}),(0,l.jsx)("input",{type:"file",accept:".json",onChange:t$,className:"hidden",id:"import-products"}),(0,l.jsxs)(d.$,{variant:"outline",onClick:()=>{var e;return null==(e=document.getElementById("import-products"))?void 0:e.click()},children:[(0,l.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,l.jsxs)(d.$,{variant:"outline",onClick:()=>{let e="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(Q,null,2)),t="products_".concat(new Date().toISOString().split("T")[0],".json"),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download",t),a.click()},children:[(0,l.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,l.jsxs)(d.$,{variant:"outline",onClick:()=>{t_(),eH(!0)},children:[(0,l.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Filters"]}),(0,l.jsxs)(x.lG,{open:eI,onOpenChange:e=>{eV(e),tA(),tn(null)},children:[(0,l.jsx)(x.zM,{asChild:!0,children:(0,l.jsxs)(d.$,{className:"bg-blue-600 hover:bg-blue-700",children:[(0,l.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Add Product"]})}),(0,l.jsxs)(x.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsx)(x.L3,{children:"Add New Product"}),(0,l.jsx)(x.rr,{children:"Create a new product with barcode information"})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"name",children:"Product Name *"}),(0,l.jsx)(o.p,{id:"name",value:ty.name,onChange:e=>{tw({...ty,name:e.target.value});let t=e.target.value.toLowerCase();tS(Q.map(e=>e.name).filter(e=>e.toLowerCase().includes(t)&&e.toLowerCase()!==t).slice(0,5))},placeholder:"Enter product name",list:"product-name-suggestions"}),(0,l.jsx)("datalist",{id:"product-name-suggestions",children:tC.map((e,t)=>(0,l.jsx)("option",{value:e},"".concat(e,"-").concat(t)))})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"price",children:"Price (₹) *"}),(0,l.jsx)(o.p,{id:"price",type:"number",min:"0",step:"0.01",value:ty.price,onChange:e=>tw({...ty,price:e.target.value}),placeholder:"0.00"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"stock",children:"Stock Quantity *"}),(0,l.jsx)(o.p,{id:"stock",type:"number",min:"0",value:ty.stock,onChange:e=>tw({...ty,stock:e.target.value}),placeholder:"0"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"sellingPrice",children:"Selling Price (₹)"}),(0,l.jsx)(o.p,{id:"sellingPrice",type:"number",min:"0",step:"0.01",value:ty.sellingPrice,onChange:e=>tw({...ty,sellingPrice:e.target.value}),placeholder:"0.00"})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"hsnCode",children:"HSN Code"}),(0,l.jsxs)(p.l6,{value:ty.hsnCode||"none",onValueChange:e=>tP("none"===e?"":e),children:[(0,l.jsx)(p.bq,{id:"hsnCode",children:(0,l.jsx)(p.yv,{placeholder:"Select HSN Code"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"none",children:"None"}),Z.map(e=>(0,l.jsx)(p.eb,{value:String(e.id),children:e.hsnCode},e.id))]})]}),ty.hsnCode&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Tax: ",Number(null!=(L=null==(e=Z.find(e=>String(e.id)===String(ty.hsnCode)))?void 0:e.tax)?L:0).toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"batch",children:"Batch (Optional)"}),(0,l.jsxs)(p.l6,{value:ty.batchid||"",onValueChange:e=>{tw({...ty,batchid:"no-batch-selected"===e?"":e})},children:[(0,l.jsx)(p.bq,{id:"batch",children:(0,l.jsx)(p.yv,{placeholder:"Select a batch"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"no-batch-selected",children:"No Batch"})," ",V.map((e,t)=>(0,l.jsx)(p.eb,{value:e.id,children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:e.place}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:e.batchNumber})]})},"".concat(e.id,"-").concat(t))),(0,l.jsx)(g.w,{className:"my-2"}),(0,l.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>ts(!0),children:[(0,l.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"New Batch"]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(h.J,{children:"Barcodes *"}),(0,l.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:tF,children:[(0,l.jsx)(S.A,{className:"h-3 w-3 mr-1"}),"Add Barcode"]})]}),(0,l.jsx)("div",{className:"space-y-2",children:ty.barcodes.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(o.p,{value:e,onChange:e=>tD(t,e.target.value),placeholder:"Enter barcode or click generate",className:"flex-1"}),(0,l.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>tD(t,tL()),children:"Generate"}),ty.barcodes.length>1&&(0,l.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>tE(t),className:"text-red-600 hover:text-red-700",children:(0,l.jsx)(k.A,{className:"h-3 w-3"})})]},t))})]})]}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>{eV(!1),tA()},children:"Cancel"}),(0,l.jsx)(d.$,{onClick:tB,children:"Add Product"})]})]})]}),(0,l.jsx)(_,{isOpen:tl,onOpenChange:ts})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,l.jsx)(m.Zp,{children:(0,l.jsx)(m.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(P.A,{className:"h-8 w-8 text-blue-600"}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Products"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:tV.length})]})]})})}),(0,l.jsx)(m.Zp,{children:(0,l.jsx)(m.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(v.A,{className:"h-8 w-8 text-green-600"}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Stock"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:tq})]})]})})}),(0,l.jsx)(m.Zp,{children:(0,l.jsx)(m.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.A,{className:"h-8 w-8 text-yellow-600"}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Value of Selling Price"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["₹",tW]})]})]})})}),(0,l.jsx)(m.Zp,{children:(0,l.jsx)(m.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(P.A,{className:"h-8 w-8 text-blue-600"}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Inventory Price Value"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["₹",tU]})]})]})})})]}),(0,l.jsxs)(m.Zp,{children:[(0,l.jsx)(m.aR,{children:(0,l.jsx)(m.ZB,{children:"Product Catalog"})}),(0,l.jsxs)(m.Wu,{children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(A.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,l.jsx)(o.p,{placeholder:"Search products, barcodes, batch, HSN...",value:er,onChange:e=>en(e.target.value),className:"pl-10"})]})}),(0,l.jsxs)(p.l6,{value:ei,onValueChange:ec,children:[(0,l.jsx)(p.bq,{className:"w-full md:w-52",children:(0,l.jsx)(p.yv,{placeholder:"Search in"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"Search All Fields"}),(0,l.jsx)(p.eb,{value:"name",children:"Product Name"}),(0,l.jsx)(p.eb,{value:"barcode",children:"Barcode"}),(0,l.jsx)(p.eb,{value:"batch",children:"Batch"}),(0,l.jsx)(p.eb,{value:"hsn",children:"HSN Code"})]})]}),(0,l.jsxs)(p.l6,{value:ed,onValueChange:eo,children:[(0,l.jsx)(p.bq,{className:"w-full md:w-48",children:(0,l.jsx)(p.yv,{placeholder:"Filter by stock"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Stock Levels"}),(0,l.jsx)(p.eb,{value:"available",children:"In Stock"}),(0,l.jsx)(p.eb,{value:"low",children:"Low Stock"}),(0,l.jsx)(p.eb,{value:"out",children:"Out of Stock"})]})]}),(0,l.jsxs)(p.l6,{value:eS,onValueChange:ek,children:[(0,l.jsx)(p.bq,{className:"w-full md:w-52",children:(0,l.jsx)(p.yv,{placeholder:"Sort products"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"newest",children:"Newest First"}),(0,l.jsx)(p.eb,{value:"oldest",children:"Oldest First"}),(0,l.jsx)(p.eb,{value:"name_asc",children:"Name A-Z"}),(0,l.jsx)(p.eb,{value:"name_desc",children:"Name Z-A"}),(0,l.jsx)(p.eb,{value:"stock_desc",children:"Stock High-Low"}),(0,l.jsx)(p.eb,{value:"price_asc",children:"Price Low-High"}),(0,l.jsx)(p.eb,{value:"price_desc",children:"Price High-Low"})]})]})]}),eQ.length>0&&(0,l.jsx)("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-sm font-medium text-blue-700",children:[eQ.length," product(s) selected"]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>e1(!0),children:"Update HSN Code"}),(0,l.jsxs)(d.$,{variant:"outline",size:"sm",onClick:tz,className:"text-red-600 hover:text-red-700",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Delete Selected"]}),(0,l.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>tM(eQ),children:[(0,l.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print Labels"]}),(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>eK([]),children:"Clear Selection"})]})]})}),(0,l.jsx)("div",{ref:X,className:"overflow-x-auto overflow-y-hidden mb-2",children:(0,l.jsx)("div",{className:"h-px"})}),(0,l.jsxs)("div",{className:"overflow-x-hidden max-h-[500px] overflow-y-auto relative",ref:K,children:[(0,l.jsxs)("table",{ref:ee,className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("th",{className:"text-left p-4",children:(0,l.jsx)("input",{type:"checkbox",checked:eQ.length===tV.length&&tV.length>0,onChange:()=>{eQ.length===tV.length?eK([]):eK(tV.map(e=>e.id))},className:"rounded"})}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Product"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Batch"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Price"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Selling Price"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Tax (%)"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"HSN Code"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Stock"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Barcodes"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Status"}),(0,l.jsx)("th",{className:"text-left p-4 font-medium",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:tV.map(e=>{var t,a,s,r,n;let i=0===(n=e.stock)?{label:"Out of Stock",variant:"destructive",icon:j.A}:n<=5?{label:"Low Stock",variant:"secondary",icon:b.A}:{label:"In Stock",variant:"default",icon:v.A},c=i.icon,o=V.find(t=>t.id===e.batchid);return(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"p-4",children:(0,l.jsx)("input",{type:"checkbox",checked:eQ.includes(e.id),onChange:()=>{var t;return t=e.id,void eK(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"rounded"})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:e.name}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():""})]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"font-medium",children:["Batch: ",(null==o?void 0:o.batchNumber)||"N/A"]}),(0,l.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Place: ",(null==o?void 0:o.place)||"N/A"]})]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("span",{className:"font-medium",children:["₹",Number(null!=(t=e.price)?t:0).toFixed(2)]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("span",{className:"font-medium",children:["₹",Number(null!=(r=null!=(s=null!=(a=e.sellingPrice)?a:e.selling_price)?s:e.displayPrice)?r:0).toFixed(2)]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("span",{className:"font-medium",children:[(()=>{var t,a;let l=tk(e),s=null==(t=Z.find(e=>String(e.id)===String(l)))?void 0:t.tax;return Number(null!=(a=null!=s?s:e.tax)?a:0).toFixed(2)})(),"%"]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsx)("span",{className:"font-medium",children:(()=>{let t=tk(e);if(!t||"null"===t||null===t)return(0,l.jsx)("span",{className:"font-medium text-gray-400",children:"N/A"});let a=Z.find(e=>String(e.id)===String(t));return a?(0,l.jsx)("span",{className:"font-medium",children:a.hsnCode}):(0,l.jsx)("span",{className:"font-medium text-gray-500",children:String(t)})})()})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsx)("span",{className:"font-medium",children:e.stock})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsx)("div",{className:"space-y-1",children:e.barcodes&&e.barcodes.length>0?e.barcodes.map((e,t)=>(0,l.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded block",children:e},t)):(0,l.jsx)("code",{className:"text-xs text-muted-foreground px-2 py-1 rounded block",children:"N/A"})})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)(u.E,{variant:i.variant,className:"flex items-center w-fit",children:[(0,l.jsx)(c,{className:"h-3 w-3 mr-1"}),i.label]})}),(0,l.jsx)("td",{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{eZ(e),tw({name:e.name,price:e.price.toString(),stock:e.stock.toString(),sellingPrice:null!=e.sellingPrice?e.sellingPrice.toString():"",barcodes:"string"==typeof e.barcode&&""!==e.barcode.trim()?e.barcode.split(","):[""],batchid:e.batchid||"",hsnCode:tk(e)}),eU(!0)},children:(0,l.jsx)(D.A,{className:"h-3 w-3"})}),(0,l.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>tM([e.id]),children:(0,l.jsx)(F.A,{className:"h-3 w-3"})}),(0,l.jsxs)(f.Lt,{children:[(0,l.jsx)(f.tv,{asChild:!0,children:(0,l.jsx)(d.$,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 bg-transparent",children:(0,l.jsx)(k.A,{className:"h-3 w-3"})})}),(0,l.jsxs)(f.EO,{children:[(0,l.jsxs)(f.wd,{children:[(0,l.jsx)(f.r7,{children:"Delete Product"}),(0,l.jsxs)(f.$v,{children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']})]}),(0,l.jsxs)(f.ck,{children:[(0,l.jsx)(f.Zr,{children:"Cancel"}),(0,l.jsx)(f.Rx,{onClick:()=>tR(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})})]},e.id)})})]}),0===tV.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)(P.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"No products found"}),(0,l.jsx)("p",{className:"text-gray-500 mb-4",children:er||"all"!==ed||""!==eh.min||""!==eh.max||"all"!==eu||""!==ep.min||""!==ep.max||""!==ef.from||""!==ef.to||"all"!==eb||"all"!==eN||""!==ew.min||""!==ew.max||"newest"!==eS||"all"!==ei?"Try adjusting your search or filters":"Get started by adding your first product"}),!er&&"all"===ed&&"all"===ei&&(0,l.jsxs)(d.$,{onClick:()=>eV(!0),type:"button",children:[(0,l.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Add Your First Product"]})]})]}),tV.length>15&&(0,l.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,l.jsx)(M,{onClick:()=>{var e;return null==(e=K.current)?void 0:e.scrollTo({top:0,behavior:"smooth"})}}),(0,l.jsx)(z,{onClick:()=>{var e;return null==(e=K.current)?void 0:e.scrollTo({top:K.current.scrollHeight,behavior:"smooth"})}})]})]})]}),(0,l.jsx)(x.lG,{open:e_,onOpenChange:e=>{e&&t_(),eH(e)},children:(0,l.jsxs)(x.Cf,{className:"w-[95vw] sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsx)(x.L3,{children:"Advanced Filters"}),(0,l.jsx)(x.rr,{children:"Refine your product search with additional criteria."})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Price Range (₹)"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)(o.p,{type:"number",placeholder:"Min",value:eP.min,onChange:e=>eA({...eP,min:e.target.value})}),(0,l.jsx)(o.p,{type:"number",placeholder:"Max",value:eP.max,onChange:e=>eA({...eP,max:e.target.value})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Batch"}),(0,l.jsxs)(p.l6,{value:eF,onValueChange:eD,children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Select batch"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Batches"}),V.map(e=>(0,l.jsxs)(p.eb,{value:e.id,children:[e.batchNumber," (",e.place,")"]},e.id))]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Selling Price Range (₹)"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Min",value:eE.min,onChange:e=>eL({...eE,min:e.target.value})}),(0,l.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Max",value:eE.max,onChange:e=>eL({...eE,max:e.target.value})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Date Added"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)(o.p,{type:"date",value:eT.from,max:tb,onChange:e=>{let t=tv(e.target.value);eB(e=>({...e,from:t,to:e.to&&t&&e.to<t?t:e.to}))}}),(0,l.jsx)(o.p,{type:"date",value:eT.to,max:tb,onChange:e=>{let t=tv(e.target.value);eB(e=>({...e,to:t,from:e.from&&t&&e.from>t?t:e.from}))}})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"HSN Code"}),(0,l.jsxs)(p.l6,{value:eO,onValueChange:eR,children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Select HSN code"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All HSN Codes"}),(0,l.jsx)(p.eb,{value:"none",children:"No HSN Assigned"}),Z.map(e=>(0,l.jsx)(p.eb,{value:String(e.id),children:e.hsnCode},e.id))]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Batch Assignment"}),(0,l.jsxs)(p.l6,{value:ez,onValueChange:eJ,children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Filter batch assignment"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Products"}),(0,l.jsx)(p.eb,{value:"with-batch",children:"With Batch"}),(0,l.jsx)(p.eb,{value:"without-batch",children:"Without Batch"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{children:"Tax Range (%)"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Min",value:eM.min,onChange:e=>e$({...eM,min:e.target.value})}),(0,l.jsx)(o.p,{type:"number",step:"0.01",placeholder:"Max",value:eM.max,onChange:e=>e$({...eM,max:e.target.value})})]})]})]}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>{em({min:"",max:""}),ex("all"),eg({min:"",max:""}),ej({from:"",to:""}),ev("all"),ey("all"),eC({min:"",max:""}),ek("newest"),ec("all"),eA({min:"",max:""}),eD("all"),eL({min:"",max:""}),eB({from:"",to:""}),eR("all"),eJ("all"),e$({min:"",max:""})},children:"Reset All"}),(0,l.jsx)(d.$,{onClick:()=>{let e={from:tv(eT.from),to:tv(eT.to)};em(eP),ex(eF),eg(eE),ej(e),ev(eO),ey(ez),eC(eM),eH(!1)},children:"Apply Filters"})]})]})}),(0,l.jsx)(x.lG,{open:th,onOpenChange:tm,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsxs)(x.L3,{children:["Batches on ",e9?tG(e9):""]}),(0,l.jsx)(x.rr,{children:"Select a batch to view its products."})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[td.length>0&&(0,l.jsx)(m.Zp,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{tj(td),tm(!1),ta(!0)},children:(0,l.jsxs)(m.aR,{children:[(0,l.jsx)(m.ZB,{children:"Un-Batched Products"}),(0,l.jsxs)(m.BT,{children:[td.length," products not assigned to a batch"]})]})}),ti.length>0&&(0,l.jsxs)(l.Fragment,{children:[td.length>0&&(0,l.jsx)(g.w,{className:"my-2"}),ti.map(e=>(0,l.jsx)(m.Zp,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{tx(e),tg(!0)},children:(0,l.jsxs)(m.aR,{children:[(0,l.jsx)(m.ZB,{children:e.batchNumber}),(0,l.jsx)(m.BT,{children:e.place})]})},e.id))]}),0===ti.length&&0===td.length&&(0,l.jsx)("p",{className:"text-center text-muted-foreground",children:"No products found for this date."})]}),(0,l.jsx)(x.Es,{className:"mt-4 flex justify-end items-center space-x-2",children:(0,l.jsx)(d.$,{variant:"outline",onClick:()=>tm(!1),children:"Close"})})]})}),(0,l.jsx)(x.lG,{open:tp,onOpenChange:tg,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsxs)(x.L3,{children:["Products in Batch ",null==tu?void 0:tu.batchNumber," on ",e9?tG(e9):""]}),(0,l.jsx)(x.rr,{children:"Listed by product id, name, stock, and price."})]}),(()=>{let e=0,t=0,a=(tQ[tX]||[]).filter(e=>e.batchid===(null==tu?void 0:tu.id)).map(a=>{let s=V.find(e=>e.id===a.batchid),r=Number(a.stock)||0,n=Number(a.price)||0,i=r*n;e+=r,t+=i;let c=a.barcode&&""!==a.barcode.trim()?a.barcode.split(",").map(e=>e.trim()).filter(e=>""!==e):[];return(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"p-2",children:c.length>0?(0,l.jsx)("div",{className:"space-y-1",children:c.map((e,t)=>(0,l.jsx)("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e},t))}):"N/A"}),(0,l.jsx)("td",{className:"p-2",children:a.name}),(0,l.jsxs)("td",{className:"p-2",children:[(null==s?void 0:s.batchNumber)||"N/A"," (",(null==s?void 0:s.place)||"N/A",")"]}),(0,l.jsx)("td",{className:"p-2 text-right",children:r}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹",n.toFixed(2)]}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹",i.toFixed(2)]})]},a.id)});return(0,l.jsx)("div",{className:"overflow-x-auto max-h-[calc(90vh-180px)] relative",ref:K,children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("th",{className:"text-left p-2",children:"Product Barcode Number"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Product Name"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Product Batch Number"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Stock"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Price"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Value (Total Value)"})]})}),(0,l.jsxs)("tbody",{children:[a,(0,l.jsxs)("tr",{className:"font-bold border-t",children:[(0,l.jsx)("td",{colSpan:3,className:"p-2 text-right",children:"Total:"}),(0,l.jsx)("td",{className:"p-2 text-right",children:e}),(0,l.jsx)("td",{className:"p-2 text-right"}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹",t.toFixed(2)]})]})]})]})})})(),(0,l.jsxs)(x.Es,{className:"mt-4 flex justify-end items-center space-x-2",children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>tg(!1),children:"Close"}),(0,l.jsxs)(d.$,{onClick:()=>{var e,t;if(!e9||!tu)return;let a=(tQ[tX]||[]).filter(e=>e.batchid===tu.id);a.map(e=>e.id);let l=t0(a,e9,(null==el||null==(e=el[0])?void 0:e.name)||"Siri Art Jewellers",{batchId:tu.id,batchName:tu.batchNumber,batchPlace:tu.place});(0,T.G)({htmlContent:l,useBackendPrint:!0,storeName:(null==el||null==(t=el[0])?void 0:t.name)||"Siri Art Jewellers"})},children:[(0,l.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print"]})]})]})}),(0,l.jsx)(x.lG,{open:tt,onOpenChange:ta,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsxs)(x.L3,{children:["Products on ",e9?tG(e9):""]}),(0,l.jsx)(x.rr,{children:"Listed by product id, name, stock, and price."})]}),(()=>{let e=0,t=0,a=tf.map(a=>{let s=V.find(e=>e.id===a.batchid),r=Number(a.stock)||0,n=Number(a.price)||0,i=r*n;e+=r,t+=i;let c=a.barcode&&""!==a.barcode.trim()?a.barcode.split(",").map(e=>e.trim()).filter(e=>""!==e):[];return(0,l.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"p-2",children:c.length>0?(0,l.jsx)("div",{className:"space-y-1",children:c.map((e,t)=>(0,l.jsx)("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e},t))}):"N/A"}),(0,l.jsx)("td",{className:"p-2",children:a.name}),(0,l.jsxs)("td",{className:"p-2",children:[(null==s?void 0:s.batchNumber)||"N/A"," (",(null==s?void 0:s.place)||"N/A",")"]}),(0,l.jsx)("td",{className:"p-2 text-right",children:r}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹",n.toFixed(2)]}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹",i.toFixed(2)]})]},a.id)});return(0,l.jsx)("div",{className:"overflow-x-auto max-h-[calc(90vh-180px)] relative",ref:K,children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("th",{className:"text-left p-2",children:"Product Barcode Number"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Product Name"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Product Batch"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Stock"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Price"}),(0,l.jsx)("th",{className:"text-right p-2",children:"Value (Total Value)"})]})}),(0,l.jsxs)("tbody",{children:[a,(0,l.jsxs)("tr",{className:"font-bold border-t",children:[(0,l.jsx)("td",{colSpan:3,className:"p-2 text-right",children:"Total:"}),(0,l.jsx)("td",{className:"p-2 text-right",children:e}),(0,l.jsx)("td",{className:"p-2 text-right"}),(0,l.jsxs)("td",{className:"p-2 text-right",children:["₹$",t.toFixed(2)]})]})]})]})})})(),(0,l.jsxs)(x.Es,{className:"mt-4 flex justify-end items-center space-x-2",children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>ta(!1),children:"Close"}),(0,l.jsxs)(d.$,{onClick:()=>{var e,t;if(!e9)return;tf.map(e=>e.id);let a=t0(tf,e9,(null==el||null==(e=el[0])?void 0:e.name)||"Siri Art Jewellers",{batchId:"N/A",batchName:"Un-batched / Mixed"});(0,T.G)({htmlContent:a,useBackendPrint:!0,storeName:(null==el||null==(t=el[0])?void 0:t.name)||"Siri Art Jewellers"})},children:[(0,l.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Print"]})]})]})}),(0,l.jsx)(O,{products:eX,isOpen:eG,onClose:()=>eY(!1),onPrintSuccess:()=>{eK([]),e0([])},storeName:(null==el||null==(t=el[0])?void 0:t.name)||"Siri Art Jewellers",forceBackendPrint:!0,batches:V}),(0,l.jsx)(x.lG,{open:eW,onOpenChange:e=>{eU(e),e||(tA(),eZ(null),tn(null))},children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsx)(x.L3,{children:"Edit Product"}),(0,l.jsx)(x.rr,{children:"Update product information and barcode details"})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-name",children:"Product Name *"}),(0,l.jsx)(o.p,{id:"edit-name",value:ty.name,onChange:e=>{tw({...ty,name:e.target.value});let t=e.target.value.toLowerCase();tS(Q.map(e=>e.name).filter(e=>e.toLowerCase().includes(t)&&e.toLowerCase()!==t).slice(0,5))},placeholder:"Enter product name",list:"product-name-suggestions-edit"}),(0,l.jsx)("datalist",{id:"product-name-suggestions-edit",children:tC.map((e,t)=>(0,l.jsx)("option",{value:e},"".concat(e,"-").concat(t)))})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-price",children:"Price (₹) *"}),(0,l.jsx)(o.p,{id:"edit-price",type:"number",min:"0",step:"0.01",value:ty.price,onChange:e=>tw({...ty,price:e.target.value}),placeholder:"0.00"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-stock",children:"Stock Quantity *"}),(0,l.jsx)(o.p,{id:"edit-stock",type:"number",min:"0",value:ty.stock,onChange:e=>tw({...ty,stock:e.target.value}),placeholder:"0"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-sellingPrice",children:"Selling Price (₹)"}),(0,l.jsx)(o.p,{id:"edit-sellingPrice",type:"number",min:"0",step:"0.01",value:ty.sellingPrice,onChange:e=>tw({...ty,sellingPrice:e.target.value}),placeholder:"0.00"})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-hsnCode",children:"HSN Code"}),(0,l.jsxs)(p.l6,{value:ty.hsnCode||"none",onValueChange:e=>tP("none"===e?"":e),children:[(0,l.jsx)(p.bq,{id:"edit-hsnCode",children:(0,l.jsx)(p.yv,{placeholder:"Select HSN Code"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"none",children:"None"}),Z.map(e=>(0,l.jsx)(p.eb,{value:String(e.id),children:e.hsnCode},e.id))]})]}),ty.hsnCode&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Tax: ",Number(null!=(B=null==(a=Z.find(e=>String(e.id)===String(ty.hsnCode)))?void 0:a.tax)?B:0).toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"edit-batch",children:"Batch (Optional)"}),(0,l.jsxs)(p.l6,{value:ty.batchid||"",onValueChange:e=>{tw({...ty,batchid:"no-batch-selected"===e?"":e})},children:[(0,l.jsx)(p.bq,{id:"edit-batch",children:(0,l.jsx)(p.yv,{placeholder:"Select a batch"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"no-batch-selected",children:"No Batch"})," ",V.map((e,t)=>(0,l.jsx)(p.eb,{value:e.id,children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:e.place}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:e.batchNumber})]})},"".concat(e.id,"-").concat(t))),(0,l.jsx)(g.w,{className:"my-2"}),(0,l.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>ts(!0),children:[(0,l.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"New Batch"]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(h.J,{children:"Barcodes *"}),(0,l.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:tF,children:[(0,l.jsx)(S.A,{className:"h-3 w-3 mr-1"}),"Add Barcode"]})]}),(0,l.jsx)("div",{className:"space-y-2",children:ty.barcodes.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(o.p,{value:e,onChange:e=>tD(t,e.target.value),placeholder:"Enter barcode or click generate",className:"flex-1"}),(0,l.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>tD(t,tL()),children:"Generate"}),ty.barcodes.length>1&&(0,l.jsx)(d.$,{type:"button",variant:"outline",size:"sm",onClick:()=>tE(t),className:"text-red-600 hover:text-red-700",children:(0,l.jsx)(k.A,{className:"h-3 w-3"})})]},t))})]})]}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>{eU(!1),tA(),eZ(null)},children:"Cancel"}),(0,l.jsx)(d.$,{onClick:tO,children:"Update Product"})]})]})}),(0,l.jsx)(x.lG,{open:e2,onOpenChange:e1,children:(0,l.jsxs)(x.Cf,{className:"sm:max-w-[425px]",children:[(0,l.jsxs)(x.c7,{children:[(0,l.jsx)(x.L3,{children:"Update HSN Code for Selected Products"}),(0,l.jsxs)(x.rr,{children:["Set HSN code for ",eQ.length," selected product(s)"]})]}),(0,l.jsx)("div",{className:"grid gap-4 py-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(h.J,{htmlFor:"bulk-hsn",children:"HSN Code"}),(0,l.jsxs)(p.l6,{value:e4||"none",onValueChange:e=>e5("none"===e?"":e),children:[(0,l.jsx)(p.bq,{id:"bulk-hsn",children:(0,l.jsx)(p.yv,{placeholder:"Select HSN Code"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"none",children:"None"}),Z.map(e=>(0,l.jsx)(p.eb,{value:String(e.id),children:e.hsnCode},e.id))]})]})]})}),(0,l.jsxs)(x.Es,{children:[(0,l.jsx)(d.$,{variant:"outline",onClick:()=>{e1(!1),e5("")},children:"Cancel"}),(0,l.jsx)(d.$,{onClick:tJ,children:"Update HSN Code"})]})]})})]})})}},47507:(e,t,a)=>{"use strict";a.d(t,{bq:()=>m,eb:()=>g,gC:()=>p,l6:()=>o,yv:()=>h});var l=a(95155),s=a(12115),r=a(4729),n=a(24033),i=a(12108),c=a(5917),d=a(25016);let o=r.bL;r.YJ;let h=r.WT,m=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,l.jsxs)(r.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[s,(0,l.jsx)(r.In,{asChild:!0,children:(0,l.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.l9.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,l.jsx)(i.A,{className:"h-4 w-4"})})});u.displayName=r.PP.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,l.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=r.wn.displayName;let p=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...i}=e;return(0,l.jsx)(r.ZL,{children:(0,l.jsxs)(r.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,l.jsx)(u,{}),(0,l.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,l.jsx)(x,{})]})})});p.displayName=r.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=r.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,l.jsxs)(r.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(r.VF,{children:(0,l.jsx)(c.A,{className:"h-4 w-4"})})}),(0,l.jsx)(r.p4,{children:s})]})});g.displayName=r.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=r.wv.displayName},52319:(e,t,a)=>{Promise.resolve().then(a.bind(a,32457))},54679:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>m,Es:()=>x,L3:()=>p,c7:()=>u,lG:()=>c,rr:()=>g,zM:()=>d});var l=a(95155),s=a(12115),r=a(93409),n=a(65229),i=a(25016);let c=r.bL,d=r.l9,o=r.ZL;r.bm;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});h.displayName=r.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:a,children:s,...c}=e;return(0,l.jsxs)(o,{children:[(0,l.jsx)(h,{}),(0,l.jsxs)(r.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[s,(0,l.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(n.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};u.displayName="DialogHeader";let x=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="DialogFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});p.displayName=r.hE.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});g.displayName=r.VY.displayName},73609:(e,t,a)=>{"use strict";function l(e){if(e){if(Array.isArray(e.barcodes)&&e.barcodes.length>0){let t=e.barcodes.find(e=>"string"==typeof e&&""!==e.trim());if(t)return t}if("string"==typeof e.barcode&&""!==e.barcode.trim())return e.barcode}}a.d(t,{n:()=>l})},76577:(e,t,a)=>{"use strict";async function l(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((a,l)=>{try{var s;if(t){let t=window.open("","_blank","width=800,height=900");if(!t)return void l(Error("Failed to open print window"));t.document.open(),t.document.write(e),t.document.close(),t.focus(),t.print(),setTimeout(()=>{t.close(),a()},500);return}let r=!1,n=document.createElement("iframe");n.style.position="fixed",n.style.right="0",n.style.bottom="0",n.style.width="0",n.style.height="0",n.style.border="none",document.body.appendChild(n);let i=null==(s=n.contentWindow)?void 0:s.document;if(!i){document.body.removeChild(n),l(Error("Failed to access iframe document"));return}i.open(),i.write(e),i.close(),n.onload=()=>{if(!r){r=!0;try{var e,t;null==(e=n.contentWindow)||e.focus(),null==(t=n.contentWindow)||t.print(),setTimeout(()=>{n.parentNode&&document.body.removeChild(n),a()},1e3)}catch(e){n.parentNode&&document.body.removeChild(n),l(e)}}},setTimeout(()=>{if(!r){r=!0;try{n.contentWindow&&(n.contentWindow.focus(),n.contentWindow.print(),setTimeout(()=>{n.parentNode&&document.body.removeChild(n),a()},1e3))}catch(e){n.parentNode&&document.body.removeChild(n),l(e)}}},500)}catch(e){console.error("Print error:",e),l(e)}})}async function s(e){let{htmlContent:t,thermalContent:a,isThermalPrinter:s=!1,labelData:r,copies:n=1,useBackendPrint:i=!1,printerName:c,storeName:d,labelProfile:o,labelDimensions:h}=e;if(i&&r&&r.length>0)try{let e="http://127.0.0.1:8080".replace(/\/+$/g,""),t={labelData:r.map(e=>{let t=e.selling_price;return void 0===t&&void 0!==e.sellingPrice&&(t=e.sellingPrice),{id:e.id,name:e.name,barcode:e.barcode,selling_price:null!=t?t:0,batchNumber:e.batchNumber||""}}),copies:n};c&&(t.printerName=c),d&&(t.storeName=d),o&&(t.labelProfile=o),h&&(t.labelDimensions=h),console.log("\uD83D\uDCE4 Sending backend print request (selling_price only):",t);let a=await fetch("".concat(e,"/api/print-label"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),l=await a.json().catch(()=>({}));if(a.ok&&"success"===l.status)return void console.log("✅ Backend print succeeded:",l.message||"");console.warn("⚠️ Backend print returned non-success, falling back to browser print",l)}catch(e){console.error("❌ Error sending backend print request, falling back to browser print:",e)}if(t){console.log("\uD83D\uDDA8️ Using browser-based HTML printing");let e=!!window.__TAURI__;await l(t,e);return}if(a){console.log("\uD83D\uDDA8️ Using browser-based thermal content printing");let e='<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Print</title>\n  <style>\n    body {\n      font-family: monospace;\n      white-space: pre-wrap;\n      margin: 0;\n      padding: 10mm;\n    }\n  </style>\n</head>\n<body><pre>'.concat(String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),"</pre></body>\n</html>"),t=!!window.__TAURI__;await l(e,t);return}throw Error("No printable content provided.")}a.d(t,{G:()=>s}),a(68267)},83209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>i});var l=a(95155),s=a(12115),r=a(25016);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});c.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...s})});o.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},90235:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var l=a(95155),s=a(12115),r=a(32894),n=a(83101),i=a(25016);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(r.b,{ref:t,className:(0,i.cn)(c(),a),...s})});d.displayName=r.b.displayName}},e=>{e.O(0,[9206,6445,5239,5584,9648,9309,702,832,8441,1255,7358],()=>e(e.s=52319)),_N_E=e.O()}]);