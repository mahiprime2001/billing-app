(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1524:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},16485:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},32295:(e,t,s)=>{Promise.resolve().then(s.bind(s,69485))},52056:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},69485:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var l=s(95155),a=s(12115),r=s(20063),c=s(16176),i=s(83209),d=s(67812),n=s(91761),o=s(53409),x=s(26617),m=s(55136),h=s(52056),u=s(16485),j=s(1524),p=s(91169),f=s(80534);function N(){let e=(0,r.useRouter)(),[t,s]=(0,a.useState)(null),[N,y]=(0,a.useState)(!0),[w,g]=(0,a.useState)(null),[v,b]=(0,a.useState)({totalRevenue:0,totalBills:0,totalProducts:0,totalStores:0,totalUsers:0,lowStockProducts:0,recentBills:[],topProducts:[]});(0,a.useEffect)(()=>{s({name:"Admin",role:"super_admin"}),(async()=>{try{y(!0),g(null),await k()}catch(e){console.error("Error loading dashboard data:",e),g("Failed to load dashboard data. Please try again later.")}finally{y(!1)}})()},[e]);let k=async()=>{try{let[e,t,s,l]=await Promise.all([fetch("".concat("http://127.0.0.1:8000","/api/bills")),fetch("".concat("http://127.0.0.1:8000","/api/products")),fetch("".concat("http://127.0.0.1:8000","/api/stores")),fetch("".concat("http://127.0.0.1:8000","/api/users"))]);if(!e.ok){let t=await e.text();throw console.error("Failed to fetch bills: ".concat(e.status," ").concat(e.statusText," - ").concat(t)),Error("Failed to fetch bills data")}if(!t.ok){let e=await t.text();throw console.error("Failed to fetch products: ".concat(t.status," ").concat(t.statusText," - ").concat(e)),Error("Failed to fetch products data")}if(!s.ok){let e=await s.text();throw console.error("Failed to fetch stores: ".concat(s.status," ").concat(s.statusText," - ").concat(e)),Error("Failed to fetch stores data")}if(!l.ok){let e=await l.text();throw console.error("Failed to fetch users: ".concat(l.status," ").concat(l.statusText," - ").concat(e)),Error("Failed to fetch users data")}let[a,r,c,i]=await Promise.all([e.json(),t.json(),s.json(),l.json()]),d=a.reduce((e,t)=>e+t.total,0),n=a.length,o=r.length,x=c.filter(e=>"active"===e.status).length,m=i.filter(e=>e.isActive).length,h=r.filter(e=>e.stock<=e.minStock).length,u=[...a].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,5),j={};a.forEach(e=>{e.items.forEach(e=>{j[e.productId]?(j[e.productId].quantity+=e.quantity,j[e.productId].revenue+=e.total):j[e.productId]={name:e.productName,quantity:e.quantity,revenue:e.total}})});let p=Object.values(j).sort((e,t)=>t.quantity-e.quantity).slice(0,5);b({totalRevenue:d,totalBills:n,totalProducts:o,totalStores:x,totalUsers:m,lowStockProducts:h,recentBills:u,topProducts:p})}catch(e){throw console.error("Error loading dashboard data:",e),e}};return N?(0,l.jsx)(c.default,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):(0,l.jsx)(c.default,{children:(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-4xl font-bold text-gray-900",children:["Welcome back",(null==t?void 0:t.name)?", ".concat(t.name):"","!"]}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"Here's what's happening with your jewelry business today."})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Revenue"}),(0,l.jsx)(n.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:["₹",v.totalRevenue.toFixed(2)]}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["From ",v.totalBills," bills"]})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Bills"}),(0,l.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:v.totalBills}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bills generated"})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-medium",children:"Products"}),(0,l.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:v.totalProducts}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[v.lowStockProducts>0&&(0,l.jsxs)("span",{className:"text-yellow-600",children:[v.lowStockProducts," low stock"]}),0===v.lowStockProducts&&"All in stock"]})]})]}),"super_admin"===t.role&&(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-medium",children:"Active Stores"}),(0,l.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:v.totalStores}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Store locations"})]})]})]}),v.lowStockProducts>0&&(0,l.jsxs)(i.Zp,{className:"border-yellow-200 bg-yellow-50",children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)(i.ZB,{className:"text-yellow-800 flex items-center",children:[(0,l.jsx)(h.A,{className:"h-5 w-5 mr-2"}),"Stock Alert"]})}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("p",{className:"text-yellow-700",children:["You have ",v.lowStockProducts," products with low stock levels. Consider restocking these items soon."]})})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(o.A,{className:"h-5 w-5 mr-2"}),"Recent Bills"]}),(0,l.jsx)(i.BT,{children:"Latest billing activity"})]}),(0,l.jsx)(i.Wu,{children:v.recentBills.length>0?(0,l.jsx)("div",{className:"space-y-4",children:v.recentBills.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium",children:["#",e.id]}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:e.customerName}),(0,l.jsxs)("p",{className:"text-xs text-gray-400 flex items-center",children:[(0,l.jsx)(u.A,{className:"h-3 w-3 mr-1"}),new Date(e.date).toLocaleDateString()]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("p",{className:"font-bold",children:["₹",e.total.toFixed(2)]}),(0,l.jsxs)(d.E,{variant:"secondary",children:[e.items.length," items"]})]})]},e.id))}):(0,l.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No bills created yet"})})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsxs)(i.aR,{children:[(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(j.A,{className:"h-5 w-5 mr-2"}),"Top Selling Products"]}),(0,l.jsx)(i.BT,{children:"Best performing jewelry items"})]}),(0,l.jsx)(i.Wu,{children:v.topProducts.length>0?(0,l.jsx)("div",{className:"space-y-4",children:v.topProducts.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:e.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[e.quantity," units sold"]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("p",{className:"font-bold",children:["₹",e.revenue.toFixed(2)]}),(0,l.jsxs)(d.E,{variant:"outline",children:["#",t+1]})]})]},t))}):(0,l.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No sales data available"})})]})]}),"super_admin"===t.role&&(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(p.A,{className:"h-5 w-5 mr-2"}),"System Users"]})}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:v.totalUsers}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Active users in system"})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(m.A,{className:"h-5 w-5 mr-2"}),"Store Performance"]})}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:["₹",v.totalStores>0?(v.totalRevenue/v.totalStores).toFixed(2):"0.00"]}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Average revenue per store"})]})]}),(0,l.jsxs)(i.Zp,{children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)(i.ZB,{className:"flex items-center",children:[(0,l.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Analytics"]})}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:["₹",v.totalBills>0?(v.totalRevenue/v.totalBills).toFixed(2):"0.00"]}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Average bill value"})]})]})]})]})})}},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>n,Wu:()=>o,ZB:()=>d,Zp:()=>c,aR:()=>i});var l=s(95155),a=s(12115),r=s(25016);let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});c.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...a})});n.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},91761:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},e=>{e.O(0,[666,530,535,176,441,255,358],()=>e(e.s=32295)),_N_E=e.O()}]);