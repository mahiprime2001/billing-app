(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{9803:(e,t,n)=>{Promise.resolve().then(n.bind(n,40248)),Promise.resolve().then(n.bind(n,68727)),Promise.resolve().then(n.t.bind(n,95003,23)),Promise.resolve().then(n.t.bind(n,41290,23))},28171:(e,t,n)=>{"use strict";n.d(t,{oR:()=>c}),n(12115);let a=0,r=new Map,o=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),i({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},s=[],l={toasts:[]};function i(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?o(n):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),s.forEach(e=>{e(l)})}function c(e){let{...t}=e,n=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>i({type:"DISMISS_TOAST",toastId:n});return i({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:e=>{e||r()}}}),{id:n,dismiss:r,update:e=>i({type:"UPDATE_TOAST",toast:{...e,id:n}})}}},40248:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(95155),r=n(12115),o=n(20063);let s=e=>{let t,{timeoutInMinutes:n=120}=e;(0,o.useRouter)();let a=(0,r.useCallback)(()=>{window.location.href="/"},[]),s=(0,r.useCallback)(()=>{clearTimeout(t),t=setTimeout(a,60*n*1e3)},[a,n]);return(0,r.useEffect)(()=>{let e=["mousemove","keydown","click","scroll"],n=()=>s();return e.forEach(e=>window.addEventListener(e,n)),s(),()=>{clearTimeout(t),e.forEach(e=>window.removeEventListener(e,n))}},[s]),null};var l=n(62217);function i(e){let{children:t}=e,[o,s]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let e;return(async()=>{if(window.__TAURI__){let{listen:t}=await n.e(3380).then(n.bind(n,13380)),a=t("server-error",e=>{s(e.payload)});e=await a}})(),()=>{null==e||e()}},[]),o)?(0,a.jsxs)("div",{style:{color:"red",display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:["Error: ",o]}):(0,a.jsx)(a.Fragment,{children:t})}var c=n(2950),d=n(58029),u=n(66638);function f(){let e=(0,r.useRef)(null),[t,n]=(0,r.useState)(!1),[o,s]=(0,r.useState)(!1),[l,i]=(0,r.useState)(0),[f,h]=(0,r.useState)(null);async function m(){if(t&&e.current)try{await (0,d.kA)("A new version ".concat(null==f?void 0:f.version," is available!\n\nRelease notes:\n").concat(null==f?void 0:f.notes,"\n\nWould you like to install it now? (App will restart after update)"),{title:"Update Available!",kind:"info",okLabel:"Install Update",cancelLabel:"Later"})&&!o?await x():n(!1)}catch(e){console.error("Prompt failed:",e)}}async function x(){if(e.current)try{s(!0),i(0),await e.current.downloadAndInstall(e=>{switch(e.event){case"Started":console.log("Download started"),i(0);break;case"Progress":let t=e.data;if(t.contentLength){let e=Math.round(t.chunkLength/t.contentLength*100);i(e),console.log("Download progress: ".concat(e,"%"))}break;case"Finished":console.log("Download finished, installing..."),i(100)}}),await (0,d.iU)("Update installed successfully! The app will now restart.",{title:"Update Complete",kind:"info",okLabel:"Restart Now"}),await new Promise(e=>setTimeout(e,500)),await (0,u.b)()}catch(e){console.error("Update installation failed:",e),await (0,d.iU)("Update download failed. Please try again later.",{kind:"error",title:"Update Failed"}),s(!1),i(0)}}return((0,r.useEffect)(()=>{(async()=>{if("__TAURI__"in window)try{let t=await (0,c.z)();if(!t||!t.available)return void console.log("No updates available.");e.current=t,n(!0),h({version:t.version,notes:t.body||"No release notes available."}),m()}catch(e){console.error("Failed to check for updates:",e)}else console.log("Not running in Tauri environment, skipping update check")})()},[]),o)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Downloading Update..."}),(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-4",children:(0,a.jsx)("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:"".concat(l,"%")}})}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l,"% complete"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2",children:"Please don't close the application"})]})})}):t&&f?(0,a.jsx)("div",{className:"fixed bottom-4 right-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 rounded-lg shadow-2xl max-w-sm z-50 animate-slide-in",children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,a.jsx)("p",{className:"font-semibold text-lg",children:"Update Available!"})]}),(0,a.jsx)("button",{onClick:()=>n(!1),className:"text-white hover:text-gray-200 transition-colors","aria-label":"Close",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Version ",f.version]}),(0,a.jsx)("p",{className:"text-xs text-blue-100 mt-1 line-clamp-2",children:f.notes})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:x,disabled:o,className:"bg-white text-blue-600 px-4 py-2 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed flex-1 font-medium transition-colors text-sm",children:"Install Now"}),(0,a.jsx)("button",{onClick:()=>n(!1),className:"bg-transparent border border-white px-4 py-2 rounded-md hover:bg-blue-800 transition-colors text-sm font-medium",children:"Later"})]})]})}):null}var h=n(68267);function m(e){let{children:t}=e,[n,o]=(0,r.useState)("checking"),[c,d]=(0,r.useState)(0),u=(0,r.useRef)(!1),m=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=async()=>{let e=new AbortController,n=setTimeout(()=>e.abort(),5e3);try{let a=await fetch("".concat("http://127.0.0.1:8080","/api/sync/status"),{method:"GET",headers:{"Content-Type":"application/json"},signal:e.signal});if(clearTimeout(n),a.ok){let e=await a.json();console.log("✅ Backend heartbeat:",e),o("online"),d(0)}else console.error("Heartbeat failed: ".concat(a.status," ").concat(a.statusText)),o("offline"),d(e=>e+1),c>=3&&!u.current&&(await t(),d(0))}catch(e){clearTimeout(n),e instanceof Error?"AbortError"===e.name?console.error("⏱️ Heartbeat timeout - Backend not responding"):console.error("❌ Backend connection error:",e.message):console.error("❌ Unknown heartbeat error:",e),o("offline"),d(e=>e+1),c>=3&&!u.current&&(await t(),d(0))}},t=async()=>{if(u.current)return void console.log("⚠️ Backend already initialized, skipping...");if("__TAURI__"in window)try{console.log("\uD83D\uDD04 Attempting to start backend..."),u.current=!0;let t=await (0,h.lA)("ensure_backend_running");console.log("✅ Backend check:",t),setTimeout(()=>{e()},2e3)}catch(e){console.error("❌ Failed to ensure backend is running:",e),u.current=!1}};return u.current||(console.log("\uD83D\uDE80 Initializing backend for the first time..."),t(),e(),m.current=setInterval(e,5e3)),()=>{m.current&&(clearInterval(m.current),m.current=null)}},[c]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{}),(0,a.jsx)(s,{}),(0,a.jsxs)(i,{children:["offline"===n&&(0,a.jsx)(l.A,{}),t]})]})}},41290:()=>{},62217:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(95155),r=n(12115),o=n(28171);function s(){let[e,t]=(0,r.useState)(!0),[n,s]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=()=>{t(!0),n&&(0,o.oR)({title:"You are back online!",description:"All features are now available.",variant:"default"})},a=()=>{t(!1),n&&(0,o.oR)({title:"You are currently offline.",description:"Some features may not be available.",variant:"destructive"})};return window.addEventListener("online",e),window.addEventListener("offline",a),void 0!==navigator.onLine&&t(navigator.onLine),s(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[n]),e)?null:(0,a.jsx)("div",{className:"bg-yellow-500 text-white text-center p-2",children:"You are currently offline. Some features may not be available."})}},68727:(e,t,n)=>{"use strict";n.d(t,{VersionBadge:()=>o});var a=n(95155);let r={rE:"0.1.74"};function o(){return(0,a.jsx)("div",{className:"fixed bottom-2 right-2 z-[100] pointer-events-none select-none opacity-50 hover:opacity-100 transition-opacity",children:(0,a.jsxs)("span",{className:"text-[15px] font-mono text-muted-foreground",children:["v",r.rE]})})}}},e=>{e.O(0,[8761,2360,8441,1255,7358],()=>e(e.s=9803)),_N_E=e.O()}]);