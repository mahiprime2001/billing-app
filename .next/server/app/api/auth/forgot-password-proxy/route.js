(()=>{var e={};e.id=139,e.ids=[139],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},28303:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=28303,e.exports=t},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},41204:e=>{"use strict";e.exports=require("string_decoder")},42996:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,A:()=>a});let r=s(46101).createPool({host:"86.38.243.155",user:"u408450631_siri",password:"Siriart@2025",database:"u408450631_siri",waitForConnections:!0,connectionLimit:10,queueLimit:0});async function o(){return await r.getConnection()}let a=r},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:e=>{"use strict";e.exports=require("timers")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},91110:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>y,routeModule:()=>x,serverHooks:()=>w,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{OPTIONS:()=>d,POST:()=>l});var o=s(96559),a=s(48088),n=s(37719),i=s(32190),u=s(42996);async function c(e,t=[]){let s;try{s=await u.A.getConnection();let[r]=await s.execute(e,t);return r}finally{s&&s.release()}}async function p(e){try{let t=await c('SELECT id, name, email FROM Users WHERE email = ? AND status = "active"',[e]);if(t.length>0){let e=t[0],s={id:e.id,name:e.name,email:e.email,action:"password_reset_request"};await c("INSERT INTO sync_table (sync_time, change_type, change_data) VALUES (NOW(), ?, ?)",["password_reset",JSON.stringify(s)]),console.log(`Password reset request logged to sync_table for user: ${e.name}`)}}catch(e){console.error("Failed to log password reset request:",e)}}async function l(e){try{let{email:t}=await e.json();if(!t)return i.NextResponse.json({success:!1,message:"Email is required"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return i.NextResponse.json({success:!1,message:"Please enter a valid email address"},{status:400});await p(t);let s="https://siri.ifleon.com/forgot-password.php";console.log("Forwarding admin password reset request to PHP endpoint:",s);let r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":process.env.PHP_API_KEY||"","User-Agent":"NextJS-AdminApp/1.0","X-Source":"admin-panel"},body:JSON.stringify({email:t})});if(console.log("PHP response status:",r.status),!r.ok)throw console.error("PHP endpoint error:",r.status,r.statusText),Error(`PHP endpoint returned status: ${r.status}`);let o=await r.json();return console.log("PHP response data:",o),i.NextResponse.json({success:o.success||!0,message:o.message||"If an account with that email exists, we have sent a password reset link."})}catch(e){return console.error("Error calling PHP forgot password endpoint:",e),i.NextResponse.json({success:!1,message:"Unable to process your request at this time. Please try again later."},{status:500})}}async function d(e){return new i.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}let x=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/forgot-password-proxy/route",pathname:"/api/auth/forgot-password-proxy",filename:"route",bundlePath:"app/api/auth/forgot-password-proxy/route"},resolvedPagePath:"/Users/mahendrareddy/developer/billing_system/billing-app/app/api/auth/forgot-password-proxy/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:g,workUnitAsyncStorage:m,serverHooks:w}=x;function y(){return(0,n.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:m})}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,580,101],()=>s(91110));module.exports=r})();