      - name: Create or Update GitHub Release
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        shell: bash
        run: |
          tag="v${{ needs.prepare-environment.outputs.version }}"
          
          gh auth status
          
          if ! gh release view "$tag" --repo "$GITHUB_REPOSITORY" 2>/dev/null; then
            gh release create "$tag" \
              --title "Siri Billing App $tag" \
              --notes "Multi-platform automated release with Python backend support for version $tag" \
              --repo "$GITHUB_REPOSITORY"
          fi
          
          IFS=',' read -ra assets <<< "$ASSETS"
          for asset in "${assets[@]}"; do
            if [ -f "$asset" ]; then
              echo "Uploading $asset..."
              gh release upload "$tag" "$asset" --clobber --repo "$GITHUB_REPOSITORY"
            fi
          done
